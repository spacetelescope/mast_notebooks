

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Calculating the Hubble Constant with eBOSS &#8212; MAST Notebook Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-SK672ZMP7G"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/SDSS/eBOSS_HST_hubbles_law/hubbles_law';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Astroquery" href="../../multi_mission/astroquery.html" />
    <link rel="prev" title="Exploring High-Redshift Quasars with eBOSS and JWST" href="../eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/mastlogo.svg" class="logo__image only-light" alt="MAST Notebook Repository - Home"/>
    <script>document.write(`<img src="../../../_static/mastlogo.svg" class="logo__image only-dark" alt="MAST Notebook Repository - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to the MAST Notebook Repository!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">GALEX</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../GALEX/mis_mosaic/mis_mosaic.html">Surveying dust structure via GALEX MIS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HSC</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/queries.html">Intro HSC Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSCV3_API/hscv3_api.html">Hubble Source Catalog API Notebook</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSCV3_SMC_API/hscv3_smc_api.html">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSC_TAP/HSC_TAP.html">MAST Table Access Protocol Hubble Source Catalog Demo</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/SWEEPS.html">SWEEPS Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1/sweeps_hscv3p1.html">Hubble Source Catalog SWEEPS Proper Motion (CasJobs Version)</a></li>






















<li class="toctree-l2"><a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1_API/sweeps_hscv3p1_api.html">Hubble Source Catalog SWEEPS Proper Motion (API Version)</a></li>









</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/HCV.html">Hubble Catalog of Variables (HCV) Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/HCV_API/HCV_API_demo.html">Hubble Catalog of Variables Notebook (API version)</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HCV_CASJOBS/HCV_casjobs_demo.html">Hubble Catalog of Variables Notebook (CasJobs version)</a></li>



</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">IUE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html">Exploring UV Extinction Curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JWST</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">Accessing JWST Proposal Data in astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/duplication_checking/duplication_checking.html">JWST Duplication Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">JWST Engineering Data Retrieval</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/SI_keyword_exoplanet_search/SI_keyword_exoplanet_search.html">JWST SI Keyword Search for Exoplanet Spectra</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/MAST_metadata_search/MAST_metadata_search.html">Astroquery: Exploring Metadata from the James Webb Space Telescope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_lightcurves/plotting_lightcurves.html">Using Kepler Data to Plot a Light Curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_images_from_tpf/plotting_images_from_tpf.html">Plotting Images from Kepler Target Pixel Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_dvts/plotting_dvts.html">Read and Plot A Kepler Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_catalog_over_FFI/plotting_catalog_over_FFI.html">Plotting a Catalog over a Kepler Full Frame Image File</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/lightkurve.html">Lightkurve</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_lc_products/lightkurve_analyzing_lc_products.html">Using <em>Kepler</em> Light Curve Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_tpf_products/lightkurve_analyzing_tpf_products.html">Using <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_searching_for_data/lightkurve_searching_for_data.html">Searching for <em>Kepler</em>/<em>K2</em> and <em>TESS</em> Data Products Using Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_custom_aperture_photometry/lightkurve_custom_aperture_photometry.html">Creating Your Own Light Curves using Custom Aperture Photometry</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_combining_multiple_quarters/lightkurve_combining_multiple_quarters.html">Combining Multiple Quarters of <em>Kepler</em> Data with Lightkurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_interactively_inspecting_TPFs_and_LCs/lightkurve_interactively_inspecting_TPFs_and_LCs.html">Interactively Inspecting Target Pixel Files and Light Curves</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/inst_noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_1_data_gaps_and_quality_flags/instrumental_noise_1_data_gaps_and_quality_flags.html">Data Gaps and Quality Flags</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_2_spurious_signals_and_time_sampling_effects/instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">Spurious Signals and Time Sampling Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_3_seasonal_and_detector_effects/instrumental_noise_3_seasonal_and_detector_effects.html">Seasonal and Detector Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_4_electronic_noise/instrumental_noise_4_electronic_noise.html">Electronic Noise</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/signals.html">Identifying Periodic Signals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/identifying_transiting_planet_signals/identifying_transiting_planet_signals.html">Identifying Transiting Planet Signals in a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/measuring_a_rotation_period/measuring_a_rotation_period.html">Measuring and Removing a Rotation Period Signal from a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/visualizing_periodic_signals_using_a_river_plot/visualizing_periodic_signals_using_a_river_plot.html">Visualizing Periodic Signals Using a River Plot</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/verifying_the_location_of_a_signal/verifying_the_location_of_a_signal.html">Verifying the Location of a Signal in <em>Kepler</em> Pixel Data</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/periodograms.html">Periodograms &amp; Asteroseismology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/creating_periodograms/creating_periodograms.html">Creating Periodograms</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">How to Understand and Manipulate the Periodogram of an Oscillating Star</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">How to Estimate a Star’s Mass and Radius Using Asteroseismology</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">K2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../K2/TPF/TPF.html">Beginner: Read and Display A K2 Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a K2 Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/removing_instrumental_noise_using_pld/removing_instrumental_noise_using_pld.html">Removing Instrumental Noise from <em>K2</em> and <em>TESS</em> Light Curves Using Pixel Level Decorrelation (PLD)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MCCM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MCCM/FIMS-SPEAR/hyperspectral_healpix_maps/hyperspectral_healpix_maps.html">Working with FIMS-SPEAR Hyperspectral HEALPix Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SDSS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../sdss.html">Sloan Digital Sky Survey (SDSS)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../MaNGA_HST_tutorial/MaNGA_HST_tutorial.html">Mapping Galaxy Properties with MaNGA + HST</a></li>



<li class="toctree-l2"><a class="reference internal" href="../APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html">Characterizing Variable Stars with APOGEE + TESS</a></li>






<li class="toctree-l2"><a class="reference internal" href="../eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html">Exploring High-Redshift Quasars with eBOSS and JWST</a></li>




<li class="toctree-l2 current active"><a class="current reference internal" href="#">Calculating the Hubble Constant with eBOSS</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multi-Mission Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../multi_mission/astroquery.html">Astroquery</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_search/beginner_search.html">Beginner: Searching MAST using astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_zcut/beginner_zcut.html">Beginner: Zcut and Astroquery Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/large_downloads/large_downloads.html">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/historic_quasar_observations/historic_quasar_observations.html">Historical Quasar Observations</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/wildcard_searches/wildcard_searches.html">Wildcard Handling with Astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/missions_mast_search/missions_mast_search.html">Searching for Mission-Specific Data with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/galex_panstarrs_bulk_download/galex_panstarrs_bulk_download.html"><strong>Large downloads in astroquery.mast from AWS to local storage</strong></a></li>

</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../multi_mission/display_footprints/display_footprints.html">PySIAF Observation Footprint Viewer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PanSTARRS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">MAST Table Access Protocol PanSTARRS 1 DR2 Demo</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_image/PS1_image.html">Get Images from the PS1 Image Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TESS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">Retrieve TESS Data Validation Products with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">Read and Plot A TESS Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Read and Display a TESS Full Frame Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">Read and Plot A TESS Light Curve File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">Read and Display A TESS Target Pixel File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">Exoplanet Data and TESS Light Curves Using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">Download MAST TESS Light Curves Within an FFI Footprint Using TAP</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">Search The TESS Input Catalog Centered On HD 209458.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">A Tour of the Contents of the TESS 2-minute Cadence Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tesscut_astroquery/beginner_tesscut_astroquery.html">Cutout of the TESS FFIs using Astrocut and Astroquery</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/lc.html">Light Curves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">Intermediate:  Search and Download GI Program Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tasoc_lc/interm_tasoc_lc.html">Intermediate: Finding Flares and Variable Stars in TASOC Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/asteroid_rotation/asteroid_rotation.html">Finding the Rotation Curve of an Asteroid or Comet with TESScut and Lightkurve</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/FFIs.html">TESS FFIs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">Intermediate: Create TESS FFI Cutout using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/making_tess_cubes_and_cutouts/making_tess_cubes_and_cutouts.html">Generating Cubes and Cutouts from TESS FFIs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">Intermediate: Retrieve TESS Pixel Response Function Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/removing_scattered_light_using_regression/removing_scattered_light_using_regression.html">Removing Scattered Light from <em>TESS</em> Data Using the Lightkurve <code class="docutils literal notranslate"><span class="pre">RegressionCorrector</span></code></a></li>

</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://timeseries.science.stsci.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/spacetelescope/mast_notebooks&urlpath=lab/tree/mast_notebooks/notebooks/SDSS/eBOSS_HST_hubbles_law/hubbles_law.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/SDSS/eBOSS_HST_hubbles_law/hubbles_law.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/SDSS/eBOSS_HST_hubbles_law/hubbles_law.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Calculating the Hubble Constant with eBOSS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-eboss-data-from-mast">Accessing eBOSS Data from MAST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-eboss-data">Querying eBOSS Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-eboss-for-redshifted-galaxies">Sampling eBOSS for Redshifted Galaxies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-products-from-eboss">Downloading Products from eBOSS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-the-hubble-lemaitre-diagram">Making the Hubble-Lemaître Diagram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-eboss-data">Plotting eBOSS Data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-abell-2199-data">Importing Abell 2199 Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-calculated-h-sub-0-sub-to-other-models">Comparing Calculated H<sub>0</sub> to Other Models</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#utilizing-hst-data-from-mast">Utilizing HST Data from MAST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-an-image-of-abell-2199-using-hst">Creating an Image of Abell 2199 Using HST</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-hst-images">Plotting the HST Images</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#colorizing-the-hst-image-of-abell-2199">Colorizing the HST Image of Abell 2199</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#end-of-tutorial">End of Tutorial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a id="top"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="calculating-the-hubble-constant-with-eboss">
<h1>Calculating the Hubble Constant with eBOSS<a class="headerlink" href="#calculating-the-hubble-constant-with-eboss" title="Permalink to this heading">#</a></h1>
<hr class="docutils" />
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<p>By the end of this tutorial, you will:</p>
<ul class="simple">
<li><p>Understand how to use <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code> to download SDSS eBOSS and HST data from the MAST archive.</p></li>
<li><p>Plot a sample of galaxies from eBOSS with a line of best fit to determine Hubble’s constant.</p></li>
<li><p>Create a color image of Abell 2199 from HST data.</p></li>
</ul>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><span class="xref myst">Introduction</span></p></li>
<li><p><span class="xref myst">Imports</span></p></li>
<li><p><span class="xref myst">Accessing eBOSS Data from MAST</span></p>
<ul>
<li><p><span class="xref myst">Querying eBOSS Data</span></p></li>
<li><p><span class="xref myst">Sampling eBOSS for Redshifted Galaxies</span></p></li>
<li><p><span class="xref myst">Downloading Products from eBOSS</span></p></li>
<li><p><span class="xref myst">Making the Hubble-Lemaître Diagram</span></p></li>
<li><p><span class="xref myst">Plotting eBOSS Data</span></p>
<ul>
<li><p><span class="xref myst">Importing Abell 2199 Data</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Comparing Calculated H<sub>0</sub> to Other Models</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Utilizing HST Data from Mast</span></p>
<ul>
<li><p><span class="xref myst">Creating an Image of Abell 2199 Using HST</span></p></li>
<li><p><span class="xref myst">Plotting the HST Images</span></p></li>
<li><p><span class="xref myst">Colorizing the HST Image</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">End of Tutorial</span></p></li>
<li><p><span class="xref myst">Additional Resources</span></p></li>
<li><p><span class="xref myst">Citations</span></p></li>
<li><p><span class="xref myst">About this Notebook</span></p></li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The Hubble-Lemaître law is one of the most prominent topics of debate in modern cosmology. In 1927, Georges Lemaître published a paper in a Belgian journal proposing that the Universe was expanding, using data from Vesto Slipher at Lowell Observatory. Around the same time, Edwin Hubble was independently studying the relationship between galaxy distances and their radial velocities at Mount Wilson Observatory. Although Hubble was originally credited with the discovery, in 2018 the International Astronomical Union officially renamed “Hubble’s Law” to the “Hubble–Lemaître Law” to acknowledge Lemaître’s earlier contribution  <a class="reference external" href="https://pressbooks.bccampus.ca/astronomy1105/chapter/26-5-the-expanding-universe/">[1]</a>.</p>
<p>The Big Bang occurred approximately 14 billion years ago, leading to the expansion of the Universe. We can estimate the speed of this expansion by examining the redshifts of a sample of galaxies. These redshifts can be translated into radial velocities, and then using observed spectral flux, we can the determine the distances to these galaxies. By plotting radial velocities versus distances, we can apply a linear fit model to the data. This allows us to approximate the Hubble constant from the slope as described by Hubble’s Law <a class="reference external" href="https://www.teachastronomy.com/textbook/The-Expanding-Universe/Relating-Redshift-and-Distance/">[2]</a>:</p>
<div class="math notranslate nohighlight">
\[
v_{rad} = H_{0}d
\]</div>
<p>There are various models used to calculate H<sub>0</sub>, some based on observations of the Cosmic Microwave Background (CMB), and others on measurements of galaxies or supernovae. These models typically yield varying values of H<sub>0</sub> ranging from approximately 67 km/s/Mpc to 74 km/s/Mpc. This discrepancy is known as the <em>Hubble Tension</em> <a class="reference external" href="https://doi.org/10.3390/universe9020094">[3]</a>.</p>
<p>In this notebook, we’ll construct a Hubble-Lemaître Diagram using data from the Sloan Digital Sky Survey’s (SDSS) Extended Baryon Oscillation Spectroscopic Survey (eBOSS). eBOSS gathered over 4 million spectra from stars, quasars, and galaxies. We’ll focus on a subset of galaxies, using their redshifts and spectral data to plot radial velocity against distance. By applying a linear fit to this relationship, we can estimate Hubble’s constant from the slope of the resulting line.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<p>The main packages and their use-cases in this tutorial are as follows:</p>
<ul class="simple">
<li><p><em>numpy</em> to handle array functions</p></li>
<li><p><em>matplotlib.pyplot</em> for plotting data</p></li>
<li><p><em>astroquery.mast.Observations</em> to access data from MAST</p></li>
<li><p><em>astropy.io.fits</em> for accessing FITS files</p></li>
<li><p><em>astropy.table.vstack</em> for vertically stacking tables</p></li>
<li><p><em>scipy.optimize.curve_fit</em> for creating a linear fit</p></li>
<li><p><em>astropy.visualization.make_luptopn_rgb</em> for creating an RGB image</p></li>
<li><p><em>astropy.wcs.WCS</em> for world coordinate system transformations</p></li>
<li><p><em>reproject</em> for stacking FITS images</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.io.fits</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">vstack</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_lupton_rgb</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.wcs</span><span class="w"> </span><span class="kn">import</span> <span class="n">WCS</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">reproject</span>
</pre></div>
</div>
</div>
</div>
<p>If you’re not sure if you have the required versions of packages installed on your device, you can run the following cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;requirements.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Required packages for this notebook:</span><span class="se">\n</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Required packages for this notebook:
astropy &gt;= 5.3
astroquery &gt;= 0.4.9
matplotlib &gt;= 3.9.1
numpy &gt;= 1.26.4
scipy &gt;= 1.15.3
reproject &gt;= 0.14.0
</pre></div>
</div>
</div>
</div>
<p>To ensure these requirements are installed, you can run the following command in the terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="accessing-eboss-data-from-mast">
<h2>Accessing eBOSS Data from MAST<a class="headerlink" href="#accessing-eboss-data-from-mast" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://archive.stsci.edu/">Mikulski Archive for Space Telescopes (MAST)</a> hosts a large array of data from several telescope missions. In this tutorial, we will be specifically focusing on data from the Sloan Digital Sky Survey (SDSS) and the Hubble Space Telescope (HST).</p>
<p>The <a class="reference external" href="https://www.sdss4.org/surveys/eboss/">Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</a> was completed using the SDSS-2.5m telescope and BOSS spectrograph at the Apache Point Observatory in New Mexico. Using plug plates and a 1000 fiber-fed spectrograph, eBOSS was able to collect spectra from over 4 million objects including quasars, galaxies, and stars in the northern hemisphere.</p>
<section id="querying-eboss-data">
<h3>Querying eBOSS Data<a class="headerlink" href="#querying-eboss-data" title="Permalink to this heading">#</a></h3>
<p>You can query data from MAST using the <a class="reference external" href="https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html">website portal</a>. You can also query MAST data in Python using the package <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code>!</p>
<p>We can query all of the eBOSS data using <code class="docutils literal notranslate"><span class="pre">Observations.query_criteria</span></code> with <code class="docutils literal notranslate"><span class="pre">provenance_name</span> <span class="pre">=</span> <span class="pre">'eBOSS'</span></code> and <code class="docutils literal notranslate"><span class="pre">obs_collection</span> <span class="pre">=</span> <span class="pre">'SDSS'</span></code>. Since eBOSS has a large amount of data, we can display the first 10 results using the <code class="docutils literal notranslate"><span class="pre">pagesize</span></code> parameter as well as the <code class="docutils literal notranslate"><span class="pre">page</span></code> parameter.</p>
<p>We can also limit the number of observations by date. Using the <code class="docutils literal notranslate"><span class="pre">t_min=[58118,</span> <span class="pre">60675]</span></code> parameter (the modified Julian date of the exposure), we can filter data that has a modified Julian date from 58118 to 60676 (years 2018-2024).</p>
<p>This might take a few minutes depending on your internet connection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eboss_data</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span>
    <span class="n">obs_collection</span><span class="o">=</span><span class="s2">&quot;SDSS&quot;</span><span class="p">,</span>
    <span class="n">provenance_name</span><span class="o">=</span><span class="s2">&quot;eBOSS&quot;</span><span class="p">,</span>
    <span class="n">t_min</span><span class="o">=</span><span class="p">[</span><span class="mi">58118</span><span class="p">,</span> <span class="mi">60675</span><span class="p">],</span>
    <span class="n">pagesize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Show the astropy table</span>
<span class="n">eboss_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=5</i>
<table id="table140368780170384" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th></tr></thead>
<thead><tr><th>str7</th><th>str4</th><th>str5</th><th>str4</th><th>str4</th><th>str4</th><th>str7</th><th>str21</th><th>str6</th><th>str27</th><th>float64</th><th>float64</th><th>str8</th><th>str18</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str56</th><th>float64</th><th>str3</th><th>str1</th><th>int64</th><th>str56</th><th>str64</th><th>str64</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>str9</th></tr></thead>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 8061-58253-266</td><td>QSO</td><td>sdss_eboss_8061-58253-0266</td><td>247.6561799999999</td><td>53.52345</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58252.42982638889</td><td>58253.44824155093</td><td>2700.2</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 247.6561799999999 53.52345 0.0002777777777777778</td><td>mast:SDSS/eboss/8061/58253/0266/spec-image-8061-58253-0266.png</td><td>mast:SDSS/eboss/8061/58253/0266/full/spec-8061-58253-0266.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>244271644</td><td>725056406</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 10938-58514-216</td><td>QSO</td><td>sdss_eboss_10938-58514-0216</td><td>222.12283</td><td>32.679912</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58514.41091435185</td><td>58514.45541782407</td><td>3600.41</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 222.12283 32.679912 0.0002777777777777778</td><td>mast:SDSS/eboss/10938/58514/0216/spec-image-10938-58514-0216.png</td><td>mast:SDSS/eboss/10938/58514/0216/full/spec-10938-58514-0216.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>244271652</td><td>725056425</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 8061-58253-504</td><td>QSO</td><td>sdss_eboss_8061-58253-0504</td><td>245.7695699999999</td><td>54.336356</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58252.42982638889</td><td>58253.448242592596</td><td>2700.2</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 245.7695699999999 54.336356 0.0002777777777777778</td><td>mast:SDSS/eboss/8061/58253/0504/spec-image-8061-58253-0504.png</td><td>mast:SDSS/eboss/8061/58253/0504/full/spec-8061-58253-0504.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>244271655</td><td>725056433</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 10938-58514-697</td><td>GALAXY</td><td>sdss_eboss_10938-58514-0697</td><td>221.61738</td><td>34.345396</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58514.41091435185</td><td>58514.45541851852</td><td>3600.41</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 221.61738 34.345396 0.0002777777777777778</td><td>mast:SDSS/eboss/10938/58514/0697/spec-image-10938-58514-0697.png</td><td>mast:SDSS/eboss/10938/58514/0697/full/spec-10938-58514-0697.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>244271661</td><td>725056449</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 8061-58253-287</td><td>QSO</td><td>sdss_eboss_8061-58253-0287</td><td>247.53341</td><td>52.881373</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58252.42982638889</td><td>58253.44824155093</td><td>2700.2</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 247.53341 52.881373 0.0002777777777777778</td><td>mast:SDSS/eboss/8061/58253/0287/spec-image-8061-58253-0287.png</td><td>mast:SDSS/eboss/8061/58253/0287/full/spec-8061-58253-0287.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>244271671</td><td>725056472</td></tr>
</table></div></div></div>
</div>
<p>The table above provides some basic information for each object:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s_ra</span></code> and <code class="docutils literal notranslate"><span class="pre">s_dec</span></code>: Right ascension and declination.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">instrument_name</span></code>: <code class="docutils literal notranslate"><span class="pre">BOSS</span></code> indicates that the data were collected using the BOSS spectrograph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">obs_id</span></code>: Observation ID associated with the object. This is based on the plate number, the modified Julian date of observation, and the fiber ID, so the observation ID will look something like <code class="docutils literal notranslate"><span class="pre">sdss_eboss_{PLATE}-{MJD}-{FIBERID}</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_classification</span></code>: Indicates the type of object (<code class="docutils literal notranslate"><span class="pre">QSO</span></code>, <code class="docutils literal notranslate"><span class="pre">STAR</span></code>, or <code class="docutils literal notranslate"><span class="pre">GALAXY</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_min</span></code> and <code class="docutils literal notranslate"><span class="pre">t_max</span></code>: The modified Julian dates indicating the start and end times of the exposures.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wavelength_region</span></code>: Indicates the region of the electromagnetic spectrum observed. This should be <code class="docutils literal notranslate"><span class="pre">OPTICAL</span></code>, since eBOSS observed in the optical wavelength range.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">em_min</span></code> and <code class="docutils literal notranslate"><span class="pre">em_max</span></code>: The minimum and maximum wavelengths observed by the survey. For eBOSS, this range is 360.0–1040.0 nanometers (optical).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataproduct_type</span></code>: Since eBOSS was a spectroscopic survey, this should be <code class="docutils literal notranslate"><span class="pre">spectrum</span></code>.</p></li>
</ul>
</section>
<section id="sampling-eboss-for-redshifted-galaxies">
<h3>Sampling eBOSS for Redshifted Galaxies<a class="headerlink" href="#sampling-eboss-for-redshifted-galaxies" title="Permalink to this heading">#</a></h3>
<p>In this tutorial, we will be examining a sample of 311 galaxies, with 32 of those being from the galaxy cluster Abell 2199. This sample was curated for this exercise by randomly selecting 500 galaxies from the LOFAR subprogram of eBOSS across a uniform range of redshifts, and then selecting the most linear portion of the data when plotted on a radial velocity vs. distance plot.</p>
<p>For the purpose of this tutorial, we will only focus on querying by observation ID. The list of observation IDs of the 311 galaxies is located in the .txt file <code class="docutils literal notranslate"><span class="pre">all_galaxies.txt</span></code>. The galaxies from <em>Abell 2199</em> are located in <code class="docutils literal notranslate"><span class="pre">abell_2199.txt</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># importing the galaxy IDs</span>
<span class="n">obs_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;all_galaxies.txt&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># looping through the .txt file to collect query results</span>
<span class="c1"># (this might take a few minutes)</span>
<span class="n">results_tables</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">obs_id</span><span class="p">:</span>
    <span class="n">query_result</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span>
        <span class="n">obs_collection</span><span class="o">=</span><span class="s2">&quot;SDSS&quot;</span><span class="p">,</span> <span class="n">provenance_name</span><span class="o">=</span><span class="s2">&quot;eBOSS&quot;</span><span class="p">,</span> <span class="n">obs_id</span><span class="o">=</span><span class="n">i</span>
    <span class="p">)</span>
    <span class="n">results_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_result</span><span class="p">)</span>

<span class="c1"># combine query results using vstack</span>
<span class="n">combined_results</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">(</span><span class="n">results_tables</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show the first 10 results</span>
<span class="n">combined_results</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=10</i>
<table id="table140368745862800" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th></tr></thead>
<thead><tr><th>str7</th><th>str4</th><th>str5</th><th>str4</th><th>str4</th><th>str4</th><th>str7</th><th>str21</th><th>str6</th><th>str27</th><th>float64</th><th>float64</th><th>str8</th><th>str18</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str56</th><th>float64</th><th>str3</th><th>str1</th><th>int64</th><th>str56</th><th>str64</th><th>str64</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>str9</th></tr></thead>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7563-56810-546</td><td>GALAXY</td><td>sdss_eboss_7563-56810-0546</td><td>242.38543</td><td>55.191924</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56810.23339120371</td><td>56810.266540972225</td><td>2700.3</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 242.38543 55.191924 0.0002777777777777778</td><td>mast:SDSS/eboss/7563/56810/0546/spec-image-7563-56810-0546.png</td><td>mast:SDSS/eboss/7563/56810/0546/full/spec-7563-56810-0546.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>247778078</td><td>731713673</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7562-56799-119</td><td>GALAXY</td><td>sdss_eboss_7562-56799-0119</td><td>242.23545</td><td>54.39303</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56799.26600694445</td><td>56799.31052199074</td><td>3600.38</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 242.23545 54.39303 0.0002777777777777778</td><td>mast:SDSS/eboss/7562/56799/0119/spec-image-7562-56799-0119.png</td><td>mast:SDSS/eboss/7562/56799/0119/full/spec-7562-56799-0119.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>246836643</td><td>729532212</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7563-56810-66</td><td>GALAXY</td><td>sdss_eboss_7563-56810-0066</td><td>246.3541299999999</td><td>53.987946</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56810.23339120371</td><td>56810.266540509256</td><td>2700.3</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 246.3541299999999 53.987946 0.0002777777777777778</td><td>mast:SDSS/eboss/7563/56810/0066/spec-image-7563-56810-0066.png</td><td>mast:SDSS/eboss/7563/56810/0066/full/spec-7563-56810-0066.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>247778139</td><td>731713984</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7564-56804-589</td><td>GALAXY</td><td>sdss_eboss_7564-56804-0589</td><td>241.9422</td><td>54.987496</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56804.29349537037</td><td>56804.3494</td><td>4500.51</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 241.9422 54.987496 0.0002777777777777778</td><td>mast:SDSS/eboss/7564/56804/0589/spec-image-7564-56804-0589.png</td><td>mast:SDSS/eboss/7564/56804/0589/full/spec-7564-56804-0589.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>244576784</td><td>725746454</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7562-56799-322</td><td>GALAXY</td><td>sdss_eboss_7562-56799-0322</td><td>239.64237</td><td>53.270835</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56799.26600694445</td><td>56799.31052199074</td><td>3600.38</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 239.64237 53.270835 0.0002777777777777778</td><td>mast:SDSS/eboss/7562/56799/0322/spec-image-7562-56799-0322.png</td><td>mast:SDSS/eboss/7562/56799/0322/full/spec-7562-56799-0322.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>246835989</td><td>729530281</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7562-56799-946</td><td>GALAXY</td><td>sdss_eboss_7562-56799-0946</td><td>242.29276</td><td>55.442419</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56799.26600694445</td><td>56799.31052245371</td><td>3600.38</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 242.29276 55.442419 0.0002777777777777778</td><td>mast:SDSS/eboss/7562/56799/0946/spec-image-7562-56799-0946.png</td><td>mast:SDSS/eboss/7562/56799/0946/full/spec-7562-56799-0946.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>246835581</td><td>729529394</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7565-56809-575</td><td>GALAXY</td><td>sdss_eboss_7565-56809-0575</td><td>240.7521</td><td>55.295251</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56809.23818287037</td><td>56809.27134421296</td><td>2700.27</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 240.7521 55.295251 0.0002777777777777778</td><td>mast:SDSS/eboss/7565/56809/0575/spec-image-7565-56809-0575.png</td><td>mast:SDSS/eboss/7565/56809/0575/full/spec-7565-56809-0575.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>246919581</td><td>729701420</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7564-56804-655</td><td>GALAXY</td><td>sdss_eboss_7564-56804-0655</td><td>242.15617</td><td>54.257776</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56804.29349537037</td><td>56804.3494</td><td>4500.51</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 242.15617 54.257776 0.0002777777777777778</td><td>mast:SDSS/eboss/7564/56804/0655/spec-image-7564-56804-0655.png</td><td>mast:SDSS/eboss/7564/56804/0655/full/spec-7564-56804-0655.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>244577089</td><td>725747202</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7563-56810-647</td><td>GALAXY</td><td>sdss_eboss_7563-56810-0647</td><td>242.90702</td><td>54.704448</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56810.23339120371</td><td>56810.266540972225</td><td>2700.3</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 242.90702 54.704448 0.0002777777777777778</td><td>mast:SDSS/eboss/7563/56810/0647/spec-image-7563-56810-0647.png</td><td>mast:SDSS/eboss/7563/56810/0647/full/spec-7563-56810-0647.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>247778318</td><td>731714416</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7563-56810-740</td><td>GALAXY</td><td>sdss_eboss_7563-56810-0740</td><td>243.28003</td><td>54.632292</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56810.23339120371</td><td>56810.266540972225</td><td>2700.3</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 243.28003 54.632292 0.0002777777777777778</td><td>mast:SDSS/eboss/7563/56810/0740/spec-image-7563-56810-0740.png</td><td>mast:SDSS/eboss/7563/56810/0740/full/spec-7563-56810-0740.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>247780260</td><td>731720216</td></tr>
</table></div></div></div>
</div>
</section>
<section id="downloading-products-from-eboss">
<h3>Downloading Products from eBOSS<a class="headerlink" href="#downloading-products-from-eboss" title="Permalink to this heading">#</a></h3>
<p>For each object, there are three available files: The preview .png image, the “full spectrum” file, and the “lite spectrum” file. The full spectrum is listed as <code class="docutils literal notranslate"><span class="pre">Minimum</span> <span class="pre">Recommended</span> <span class="pre">Products</span></code> for the <code class="docutils literal notranslate"><span class="pre">productGroupDescription</span></code> parameter.</p>
<p>For more information about eBOSS data products, you can visit the <a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products">MAST Archive Manual</a> as well as in the search results table.</p>
<p>This will take a few minutes to load.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtaining the product list of all galaxies</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">combined_results</span><span class="p">)</span>

<span class="c1"># Display the available products</span>
<span class="n">products</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=2170</i>
<table id="table140368740638544" class="table-striped table-bordered table-condensed">
<thead><tr><th>obsID</th><th>obs_collection</th><th>dataproduct_type</th><th>obs_id</th><th>description</th><th>type</th><th>dataURI</th><th>productType</th><th>productGroupDescription</th><th>productSubGroupDescription</th><th>productDocumentationURL</th><th>project</th><th>prvversion</th><th>proposal_id</th><th>productFilename</th><th>size</th><th>parent_obsid</th><th>dataRights</th><th>calib_level</th><th>filters</th></tr></thead>
<thead><tr><th>str9</th><th>str4</th><th>str12</th><th>str30</th><th>str235</th><th>str1</th><th>str69</th><th>str7</th><th>str28</th><th>str14</th><th>str61</th><th>str5</th><th>str7</th><th>str3</th><th>str31</th><th>int64</th><th>str9</th><th>str6</th><th>int64</th><th>str4</th></tr></thead>
<tr><td>244093798</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0357</td><td>Preview-Full</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0357/spec-image-10729-58248-0357.png</td><td>PREVIEW</td><td>--</td><td>--</td><td>--</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-image-10729-58248-0357.png</td><td>33843</td><td>244093798</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244093798</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0357</td><td>SDSS eBOSS lite spectrum file containing the combined spectrum and associated metadata but not the individual exposures.</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0357/lite/spec-lite-10729-58248-0357.fits</td><td>SCIENCE</td><td>--</td><td>SPECTRA</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-lite-10729-58248-0357.fits</td><td>216000</td><td>244093798</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244093798</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0357</td><td>SDSS eBOSS full spectrum file containing the combined spectrum, associated metadata, and the individual exposures.</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0357/full/spec-10729-58248-0357.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>SPECTRA</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-10729-58248-0357.fits</td><td>864000</td><td>244093798</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244093916</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0657</td><td>Preview-Full</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0657/spec-image-10729-58248-0657.png</td><td>PREVIEW</td><td>--</td><td>--</td><td>--</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-image-10729-58248-0657.png</td><td>39087</td><td>244093916</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244093916</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0657</td><td>SDSS eBOSS lite spectrum file containing the combined spectrum and associated metadata but not the individual exposures.</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0657/lite/spec-lite-10729-58248-0657.fits</td><td>SCIENCE</td><td>--</td><td>SPECTRA</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-lite-10729-58248-0657.fits</td><td>216000</td><td>244093916</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244093916</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0657</td><td>SDSS eBOSS full spectrum file containing the combined spectrum, associated metadata, and the individual exposures.</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0657/full/spec-10729-58248-0657.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>SPECTRA</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-10729-58248-0657.fits</td><td>864000</td><td>244093916</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244094913</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0359</td><td>Preview-Full</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0359/spec-image-10729-58248-0359.png</td><td>PREVIEW</td><td>--</td><td>--</td><td>--</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-image-10729-58248-0359.png</td><td>34149</td><td>244094913</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244094913</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0359</td><td>SDSS eBOSS lite spectrum file containing the combined spectrum and associated metadata but not the individual exposures.</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0359/lite/spec-lite-10729-58248-0359.fits</td><td>SCIENCE</td><td>--</td><td>SPECTRA</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-lite-10729-58248-0359.fits</td><td>216000</td><td>244094913</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244094913</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_10729-58248-0359</td><td>SDSS eBOSS full spectrum file containing the combined spectrum, associated metadata, and the individual exposures.</td><td>S</td><td>mast:SDSS/eboss/10729/58248/0359/full/spec-10729-58248-0359.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>SPECTRA</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-10729-58248-0359.fits</td><td>864000</td><td>244094913</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248379571</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248380187</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248380410</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248380534</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248380590</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248380647</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248380843</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248381352</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248381483</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252830431</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spall</td><td>SDSS eBOSS summary catalog. This provides collated summary tables on the observations and data processing from eBOSS, including targeting information, spectroscopic classifications, and redshifts for every observation.</td><td>D</td><td>mast:SDSS/eboss/spAll-v5_13_2.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spAll-v5_13_2.fits</td><td>15895373760</td><td>248382373</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
</table></div></div></div>
</div>
<p>To utilize the data, we must download the FITS files. Any data products dowloaded from MAST will appear in a folder called <code class="docutils literal notranslate"><span class="pre">mastDownload</span></code>.</p>
<p>We’ll be focusing on using the full spectrum datafile only, which is labeled “Minimum Recommended Products” as the product Group Description. To ensure we’re only downloading this file for each target, we’ll use the parameter <code class="docutils literal notranslate"><span class="pre">mrp_only</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<p>This download should take around 45 seconds or so.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Downloading the full spectra products</span>
<span class="n">manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span>
    <span class="n">products</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll send these FITS files to an array so that we can access the redshift and flux values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sending the FITS files to an array</span>
<span class="n">galaxy_array</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">manifest</span><span class="p">[</span><span class="s2">&quot;Local Path&quot;</span><span class="p">]:</span>
    <span class="n">galaxy_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># View available file extensions</span>
<span class="n">galaxy_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: ./mastDownload/SDSS/sdss_eboss_10729-58248-0357/spec-10729-58248-0357.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     134   ()      
  1  COADD         1 BinTableHDU     26   4567R x 8C   [E, E, E, J, J, E, E, E]   
  2  SPALL         1 BinTableHDU    488   1R x 236C   [27A, 14A, 4A, E, E, J, J, E, J, E, E, E, K, K, K, K, K, K, K, K, K, B, B, J, I, 5E, 5E, J, J, J, J, 7A, 7A, 16A, D, D, 6A, 21A, E, E, E, J, E, 24A, 10J, J, 10E, E, E, E, E, E, E, J, E, E, E, J, 5E, E, E, 10E, 10E, 10E, 5E, 5E, 5E, 5E, 5E, J, J, E, E, E, E, E, E, 16A, 9A, 12A, E, E, E, E, E, E, E, E, J, E, E, J, J, 6A, 21A, E, 35E, K, 19A, 19A, 19A, B, B, B, I, 3A, B, I, I, I, I, J, E, J, J, E, E, E, E, E, E, E, E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5J, 5J, 5J, 5E, 5J, 75E, 75E, 5E, 5E, 5E, 5J, 5E, D, D, D, D, D, D, D, D, D, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 40E, 40E, 5J, 5J, 5E, 5E, 5D, J, J, J, J, J, J, J, E]   
  3  SPZLINE       1 BinTableHDU     48   32R x 19C   [J, J, J, 13A, D, E, E, E, E, E, E, E, E, E, E, J, J, E, E]   
  4  B1-00268372-00268371-00268370    1 BinTableHDU    189   2481R x 8C   [E, E, E, J, E, E, E, E]   
  5  B1-00268373-00268371-00268370    1 BinTableHDU    189   2481R x 8C   [E, E, E, J, E, E, E, E]   
  6  B1-00268374-00268371-00268370    1 BinTableHDU    189   2481R x 8C   [E, E, E, J, E, E, E, E]   
  7  R1-00268372-00268371-00268370    1 BinTableHDU    189   3105R x 8C   [E, E, E, J, E, E, E, E]   
  8  R1-00268373-00268371-00268370    1 BinTableHDU    189   3105R x 8C   [E, E, E, J, E, E, E, E]   
  9  R1-00268374-00268371-00268370    1 BinTableHDU    189   3105R x 8C   [E, E, E, J, E, E, E, E]   
</pre></div>
</div>
</div>
</div>
<p>For this tutorial, we will focus on using the spectroscopic flux in the r-band provided by spALL. These are accessed through the second file extension.</p>
<p>The various file extensions are broken down on the <a class="reference external" href="https://data.sdss.org/datamodel/files/BOSS_SPECTRO_REDUX/RUN2D/spectra/PLATE4/spec.html">SDSS website</a>:</p>
<ul class="simple">
<li><p>HDU 0: The primary header information.</p></li>
<li><p>HDU 1: The coadded observed spectrum.</p></li>
<li><p>HDU 2: Metadata from spALL.</p></li>
<li><p>HDU 3: Emission line fitting metadata from spZline.</p></li>
<li><p>HDU 4+: Individual red and blue spectra that make up the coadded spectrum.</p></li>
</ul>
<p>The second file extension is broken down even further, available also on the <a class="reference external" href="https://data.sdss.org/datamodel/files/BOSS_SPECTRO_REDUX/RUN2D/PLATE4/RUN1D/spZbest.html">SDSS website</a>. We’ll be focusing on using <code class="docutils literal notranslate"><span class="pre">SPECTROFLUX</span></code>. Since this provides us a five-element array for each band (u, g, r, i , z), we’ll use the third element for the r-band flux.</p>
</section>
<section id="making-the-hubble-lemaitre-diagram">
<h3>Making the Hubble-Lemaître Diagram<a class="headerlink" href="#making-the-hubble-lemaitre-diagram" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting up arrays to send all z-values, z-error, and flux to arrays</span>
<span class="n">z_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">z_err</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">r_flux</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Looping through all the data and adding z-values, z-error, and flux to arrays</span>
<span class="k">for</span> <span class="n">galaxy</span> <span class="ow">in</span> <span class="n">galaxy_array</span><span class="p">:</span>
    <span class="n">galaxy_z</span> <span class="o">=</span> <span class="n">galaxy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span>
    <span class="n">zerr</span> <span class="o">=</span> <span class="n">galaxy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Z_ERR&quot;</span><span class="p">]</span>
    <span class="n">spectroflux</span> <span class="o">=</span> <span class="n">galaxy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SPECTROFLUX&quot;</span><span class="p">][:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">z_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">galaxy_z</span><span class="p">)</span>
    <span class="n">z_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zerr</span><span class="p">)</span>
    <span class="n">r_flux</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spectroflux</span><span class="p">)</span>

<span class="c1"># Converting lists to arrays</span>
<span class="n">z_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z_val</span><span class="p">)</span>
<span class="n">z_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z_err</span><span class="p">)</span>
<span class="n">r_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_flux</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In order to determine the relative distance to each galaxy, we can use the inverse square law as we know flux is proportional to <span class="math notranslate nohighlight">\(\frac{1}{d^2}\)</span>. Thus, distance is proportional to <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{flux}}\)</span> <a class="reference external" href="https://skyserver.sdss.org/dr12/en/proj/advanced/hubble/distances.aspx">[4]</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Finding the relative distance by taking 1/sqrt of the radiant flux</span>
<span class="n">relative_distance</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_flux</span><span class="p">)</span>

<span class="c1"># Converting the relative distance to kiloparsecs</span>
<span class="n">new_relative_distance</span> <span class="o">=</span> <span class="n">relative_distance</span> <span class="o">/</span> <span class="mf">1e3</span>  <span class="c1"># kpc</span>

<span class="c1"># Stacking arrays to remove points with nan</span>
<span class="n">plot_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">z_val</span><span class="p">,</span> <span class="n">new_relative_distance</span><span class="p">,</span> <span class="n">z_err</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Due to the behavior of <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{flux}}\)</span>, we will create a mask to remove any ‘nan’ values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selecting all distances that are not &#39;nan&#39;</span>
<span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">plot_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Applying mask</span>
<span class="n">new_plot_array</span> <span class="o">=</span> <span class="n">plot_array</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Since Hubble’s constant is in units km/s/Mpc, we want to convert redshift to velocity. To do this, we can use the relativistic radial velocity equation <a class="reference external" href="https://ned.ipac.caltech.edu/level5/Hogg/Hogg3.html">[5]</a>: <br></p>
<div class="math notranslate nohighlight">
\[
v = c \frac{(1+z)^2-1}{(1+z)^2+1}
\]</div>
<p>Using error propagation, the error in redshift becomes: <br></p>
<div class="math notranslate nohighlight">
\[
v_{err} = z_{err}|\frac{4c(1+z)}{((1+z)^2+1)^2}|
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define speed of light constant (c) in km/s</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">2.998e5</span>  <span class="c1"># km/s</span>

<span class="c1"># Calculating velocity from redshift</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">velocity_err</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_plot_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">new_plot_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">v_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(((</span><span class="mi">4</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">j</span>
    <span class="n">velocity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">velocity_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v_err</span><span class="p">)</span>

<span class="c1"># Creating new array of distance, velocity, and error in velocity</span>
<span class="n">distance_velocity_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span>
    <span class="p">(</span><span class="n">new_plot_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">velocity</span><span class="p">,</span> <span class="n">velocity_err</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting-eboss-data">
<h3>Plotting eBOSS Data<a class="headerlink" href="#plotting-eboss-data" title="Permalink to this heading">#</a></h3>
<p>We can examine the data by creating a scatter plot of the velocity versus the relative distance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting eBOSS data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">distance_velocity_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">distance_velocity_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">s</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Velocity vs. Relative Distance of eBOSS Data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Relative Distance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Radial Velocity (km/s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/45cef68c2268ce7f09c742184624c084e5252c75e04d613908317c968828df03.png" src="../../../_images/45cef68c2268ce7f09c742184624c084e5252c75e04d613908317c968828df03.png" />
</div>
</div>
<section id="importing-abell-2199-data">
<h4>Importing Abell 2199 Data<a class="headerlink" href="#importing-abell-2199-data" title="Permalink to this heading">#</a></h4>
<p>In order to obtain the actualized distances for the sample, we can use the relative distance of the first galaxy from Abell 2199 and set it equal to 1. We’ll follow the same procedures as before by importing the <code class="docutils literal notranslate"><span class="pre">abell_2199.txt</span></code> file and querying eBOSS for those 32 select galaxies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading the Abell 2199 dataset</span>
<span class="n">obs_id2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;abell_2199.txt&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># Querying eBOSS for the 32 Abell 2199 galaxies, sending the data to an array</span>
<span class="n">results_tables2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">obs_id2</span><span class="p">:</span>
    <span class="n">query_result2</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span>
        <span class="n">provenance_name</span><span class="o">=</span><span class="s2">&quot;eBOSS&quot;</span><span class="p">,</span> <span class="n">obs_id</span><span class="o">=</span><span class="n">i</span>
    <span class="p">)</span>
    <span class="n">results_tables2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_result2</span><span class="p">)</span>

<span class="c1"># Stacking the data into one table</span>
<span class="n">combined_results2</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">(</span><span class="n">results_tables2</span><span class="p">)</span>

<span class="c1"># Ensuring the length of the stacked table is 32</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length of Abell 2199 dataset = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">combined_results2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Length of Abell 2199 dataset = 32
</pre></div>
</div>
</div>
</div>
<p>We’ll gather and download the products again, and then send the FITS data to an array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gathering and downloading full spectra files</span>
<span class="n">products2</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">combined_results2</span><span class="p">)</span>
<span class="n">manifest2</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span>
    <span class="n">products2</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Writing data to an array</span>
<span class="n">abell_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">manifest2</span><span class="p">[</span><span class="s2">&quot;Local Path&quot;</span><span class="p">]:</span>
    <span class="n">abell_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

<span class="c1"># Checking the length of the array matches the dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length of Abell 2199 array = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">abell_array</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_10729-58248-0357/spec-10729-58248-0357.fits with expected size 864000. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_10729-58248-0359/spec-10729-58248-0359.fits with expected size 864000. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_10729-58248-0657/spec-10729-58248-0657.fits with expected size 864000. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0747/spec-5190-56077-0747.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0749/spec-5190-56077-0749.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0753/spec-5190-56077-0753.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0756/spec-5190-56077-0756.fits with expected size 875520. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0757/spec-5190-56077-0757.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0758/spec-5190-56077-0758.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0759/spec-5190-56077-0759.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0761/spec-5190-56077-0761.fits with expected size 875520. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0762/spec-5190-56077-0762.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0790/spec-5190-56077-0790.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0793/spec-5190-56077-0793.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0795/spec-5190-56077-0795.fits with expected size 875520. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0797/spec-5190-56077-0797.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0798/spec-5190-56077-0798.fits with expected size 875520. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_5190-56077-0799/spec-5190-56077-0799.fits with expected size 875520. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0084/spec-6045-56072-0084.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0121/spec-6045-56072-0121.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0124/spec-6045-56072-0124.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0125/spec-6045-56072-0125.fits with expected size 1082880. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0126/spec-6045-56072-0126.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0130/spec-6045-56072-0130.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0161/spec-6045-56072-0161.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0162/spec-6045-56072-0162.fits with expected size 1082880. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0163/spec-6045-56072-0163.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0164/spec-6045-56072-0164.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0165/spec-6045-56072-0165.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0167/spec-6045-56072-0167.fits with expected size 1082880. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0169/spec-6045-56072-0169.fits with expected size 1082880. [astroquery.query]
INFO: Found cached file ./mastDownload/SDSS/sdss_eboss_6045-56072-0206/spec-6045-56072-0206.fits with expected size 1082880. [astroquery.query]
Length of Abell 2199 array = 32
</pre></div>
</div>
</div>
</div>
<p>Now we can extract the redshift, error in redshift, and r-band flux values. Following the same processes as before, we can use the flux to find the relative distances.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sending redshift, error in redshift, and r-band magnitudes to arrays</span>
<span class="n">z_val_abell</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">z_err_abell</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">r_flux_abell</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">galaxy</span> <span class="ow">in</span> <span class="n">abell_array</span><span class="p">:</span>
    <span class="n">galaxy_z</span> <span class="o">=</span> <span class="n">galaxy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span>
    <span class="n">zerr</span> <span class="o">=</span> <span class="n">galaxy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Z_ERR&quot;</span><span class="p">]</span>
    <span class="n">spectroflux</span> <span class="o">=</span> <span class="n">galaxy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;SPECTROFLUX&quot;</span><span class="p">][:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">z_val_abell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">galaxy_z</span><span class="p">)</span>
    <span class="n">z_err_abell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zerr</span><span class="p">)</span>
    <span class="n">r_flux_abell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spectroflux</span><span class="p">)</span>

<span class="c1"># Converting lists into arrays</span>
<span class="n">z_val_abell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z_val_abell</span><span class="p">)</span>
<span class="n">z_err_abell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z_err_abell</span><span class="p">)</span>
<span class="n">r_flux_abell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_flux_abell</span><span class="p">)</span>

<span class="c1"># Calculate relative distance</span>
<span class="n">relative_distance_abell</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_flux_abell</span><span class="p">)</span>
<span class="n">new_relative_distance_abell</span> <span class="o">=</span> <span class="n">relative_distance_abell</span> <span class="o">/</span> <span class="mf">1e3</span>  <span class="c1"># kpc</span>

<span class="c1"># Filter out zeros</span>
<span class="n">plot_array_abell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span>
    <span class="p">(</span><span class="n">z_val_abell</span><span class="p">,</span> <span class="n">new_relative_distance_abell</span><span class="p">,</span> <span class="n">z_err_abell</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">mask2</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">plot_array_abell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">new_array_abell</span> <span class="o">=</span> <span class="n">plot_array_abell</span><span class="p">[</span><span class="n">mask2</span><span class="p">]</span>

<span class="c1"># Calculate velocity</span>
<span class="n">velocity_abell</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">velocity_err_abell</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_array_abell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">new_array_abell</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">v_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(((</span><span class="mi">4</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">j</span>
    <span class="n">velocity_abell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">velocity_err_abell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v_err</span><span class="p">)</span>

<span class="c1"># Creating new array of distance, velocity, and error in velocity</span>
<span class="n">distance_velocity_array_abell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span>
    <span class="p">(</span><span class="n">new_array_abell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">velocity_abell</span><span class="p">,</span> <span class="n">velocity_err_abell</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have filtered out both datasets, we can normalize the relative distances. To do this, we’ll set up a ratio such that the closest galaxy in the Abell 2199 cluster equals 1:</p>
<div class="math notranslate nohighlight">
\[
\frac{d_{1}}{d_{relative}} = \frac{1}{d_{norm}}
\]</div>
<p>where <span class="math notranslate nohighlight">\(d_{1}\)</span> is the relative distance of the closest Abell 2199 galaxy, <span class="math notranslate nohighlight">\(d_{relative}\)</span> is the array of relative distances of the eBOSS galaxies, and <span class="math notranslate nohighlight">\(d_{norm}\)</span> is the array of normalized distances. To solve for the array of <span class="math notranslate nohighlight">\(d_{norm}\)</span>, we’ll divide the array of relative distances by <span class="math notranslate nohighlight">\(d_{1}\)</span>. <a class="reference external" href="https://skyserver.sdss.org/dr12/en/proj/advanced/hubble/distances.aspx">[4]</a></p>
<p>Since we know the distance to Abell 2199 is 128 Mpc, we’ll multiply the normalized distances by 128 Mpc to obtain the actualized distances. <a class="reference external" href="http://ned.ipac.caltech.edu/cgi-bin/nph-objsearch?objname=Abell+2199&amp;extend=no&amp;hconst=73&amp;omegam=0.27&amp;omegav=0.73&amp;corr_z=1&amp;out_csys=Equatorial&amp;out_equinox=J2000.0&amp;obj_sort=RA+or+Longitude&amp;of=pre_text&amp;zv_breaker=30000.0&amp;list_limit=5&amp;img_stamp=YES">[6]</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sorting the Abell 2199 data to find closest galaxy</span>
<span class="n">sorted_abell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">distance_velocity_array_abell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sorted_abell_array</span> <span class="o">=</span> <span class="n">distance_velocity_array_abell</span><span class="p">[</span><span class="n">sorted_abell</span><span class="p">]</span>

<span class="c1"># Taking the first Abell 2199 galaxy and find the average, setting that to 1</span>
<span class="n">d1_abell</span> <span class="o">=</span> <span class="n">sorted_abell_array</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Normalize distances to d1_abell</span>
<span class="n">norm_dist</span> <span class="o">=</span> <span class="n">distance_velocity_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">d1_abell</span>
<span class="n">norm_dist_abell</span> <span class="o">=</span> <span class="n">distance_velocity_array_abell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">d1_abell</span>

<span class="c1"># Distance to Abell 2199</span>
<span class="n">distance</span> <span class="o">=</span> <span class="mi">128</span>  <span class="c1"># Mpc</span>
</pre></div>
</div>
</div>
</div>
<p>Now we have normalized distances! We can multiply these by the distance to Abell 2199 and generate a plot with distances and radial velocities. We can use <code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit</span></code> to perform a linear fit, and in return, we can obtain the value of the slope, i.e., Hubble’s constant!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining linear fit function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">m</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Doing linear fit using scipy.optimize.curve_fit</span>
<span class="n">popt</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
    <span class="n">fit_func</span><span class="p">,</span>
    <span class="n">norm_dist</span> <span class="o">*</span> <span class="n">distance</span><span class="p">,</span>
    <span class="n">distance_velocity_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">sigma</span><span class="o">=</span><span class="n">distance_velocity_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># slope (Hubble&#39;s constant!)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">popt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># intercept</span>

<span class="c1"># Setting up an array of x-values to plot the line of best fit</span>
<span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">200000</span><span class="p">)</span>

<span class="c1"># Plotting the data as well as the line of best fit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
    <span class="n">norm_dist</span> <span class="o">*</span> <span class="n">distance</span><span class="p">,</span>
    <span class="n">distance_velocity_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">yerr</span><span class="o">=</span><span class="n">distance_velocity_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">ms</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;eBOSS data&quot;</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">norm_dist_abell</span> <span class="o">*</span> <span class="n">distance</span><span class="p">,</span>
    <span class="n">distance_velocity_array_abell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Abell 2199&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x_array</span><span class="p">,</span>
    <span class="n">fit_func</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;linear fit&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Radial Velocity (km/s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Actualized Distance (Mpc)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Radial Velocity vs. Actualized Distance of eBOSS Galaxy Sample </span><span class="se">\n</span><span class="s2"> eBOSS - LOFAR </span><span class="se">\n</span><span class="s2"> $H_</span><span class="si">{</span><span class="mi">0</span><span class="si">}</span><span class="s2">$ = </span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> km/s/Mpc </span><span class="se">\n</span><span class="s2"> r - band magnitude&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0a1b6a295c65fa4e45cb1b74d3195054c13893e5a0bde01f2666989aae908691.png" src="../../../_images/0a1b6a295c65fa4e45cb1b74d3195054c13893e5a0bde01f2666989aae908691.png" />
</div>
</div>
</section>
</section>
<section id="comparing-calculated-h-sub-0-sub-to-other-models">
<h3>Comparing Calculated H<sub>0</sub> to Other Models<a class="headerlink" href="#comparing-calculated-h-sub-0-sub-to-other-models" title="Permalink to this heading">#</a></h3>
<p>Using data from eBOSS, we were able to calculate an H<sub>0</sub> value of <span class="math notranslate nohighlight">\(\approx\)</span> 73.66 km/s/Mpc!</p>
<p>The European Space Agency calculated an H<sub>0</sub> value of 67.40 ± 1.40 km/s/Mpc using Planck data. A recent calculation using Cepheid variables and SNe Ia from the SH0ES collaboration provided an H<sub>0</sub> value of 73.04 ± 1.04 km/s/Mpc <a class="reference external" href="https://doi.org/10.3390/universe9020094">[3]</a>. Astronomers continue to use both local distance indicators (e.g., Tip of the Red Giant Branch stars) and early-Universe probes like the CMB to constrain H<sub>0</sub>, but the Hubble Tension remains unresolved <a class="reference external" href="https://www.scientificamerican.com/article/the-hubble-tension-is-becoming-a-hubble-crisis/">[7]</a>.</p>
<p>Due to relativistic effects, H<sub>0</sub> values calculated from CMB observations (which probe the early Universe) tend to be lower than those calculated from nearby objects like Cepheid variables or Type Ia supernovae. Since our H<sub>0</sub> value is based on galaxy observations from eBOSS, it’s reasonable that it falls on the higher end of the range, though this could also be influenced by uncertainties introduced by several assumptions:</p>
<ul class="simple">
<li><p>We assume galaxies are point sources, using a single static distance for each.</p></li>
<li><p>We calculate distances using the inverse square law, but intrinsic galaxy brightness can vary significantly.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="utilizing-hst-data-from-mast">
<h2>Utilizing HST Data from MAST<a class="headerlink" href="#utilizing-hst-data-from-mast" title="Permalink to this heading">#</a></h2>
<p>The Hubble Space Telescope (HST) is a 2.4 meter serviceable telescope launched in 1990. It’s equipped with three cameras (ACS, WFC3/UVIS, and WFC3/IR). Using observations from HST, we can construct an image of Abell 2199!</p>
<p>While we won’t be covering this in the tutorial, we could use the constructed image from HST to determine the relative distance to Abell 2199 rather than using the one from NED. For example, we could use the apparent brightness of the cluster’s brightest galaxy, or analyze the relative physical sizes of its member galaxies <a class="reference external" href="https://skyserver.sdss.org/dr12/en/proj/advanced/hubble/distances.aspx">[4]</a>.</p>
<p>For more information about HST, check out this <a class="reference external" href="https://archive.stsci.edu/missions-and-data/hst">overview from MAST</a>!</p>
<section id="creating-an-image-of-abell-2199-using-hst">
<h3>Creating an Image of Abell 2199 Using HST<a class="headerlink" href="#creating-an-image-of-abell-2199-using-hst" title="Permalink to this heading">#</a></h3>
<p>To create an image of Abell 2199 using HST, we’ll query MAST using <code class="docutils literal notranslate"><span class="pre">objectname</span> <span class="pre">=</span> <span class="pre">'Abell</span> <span class="pre">2199'</span></code> and specify HST using <code class="docutils literal notranslate"><span class="pre">obs_collection</span> <span class="pre">=</span> <span class="pre">'HST'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query HST using objectname</span>
<span class="n">obs_hst</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span>
    <span class="n">objectname</span><span class="o">=</span><span class="s2">&quot;Abell 2199&quot;</span><span class="p">,</span>
    <span class="c1"># specifying Hubble data</span>
    <span class="n">obs_collection</span><span class="o">=</span><span class="s2">&quot;HST&quot;</span><span class="p">,</span>
    <span class="c1"># We want science observations and not calibration files</span>
    <span class="n">intentType</span><span class="o">=</span><span class="s2">&quot;science&quot;</span><span class="p">,</span>
    <span class="c1"># Calibrated reduced observations to display final image</span>
    <span class="n">provenance_name</span><span class="o">=</span><span class="s2">&quot;CAL*&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Display results</span>
<span class="n">obs_hst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=77</i>
<table id="table140367982395664" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th><th>objID1</th><th>distance</th></tr></thead>
<thead><tr><th>str7</th><th>str3</th><th>str8</th><th>str13</th><th>str3</th><th>str6</th><th>str8</th><th>str21</th><th>str69</th><th>str9</th><th>float64</th><th>float64</th><th>str8</th><th>str21</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str110</th><th>float64</th><th>str5</th><th>str12</th><th>int64</th><th>str1098</th><th>str34</th><th>str35</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>str9</th><th>str9</th><th>float64</th></tr></thead>
<tr><td>science</td><td>HST</td><td>CALNIC</td><td>NICMOS/NIC3</td><td>HST</td><td>F160W</td><td>Infrared</td><td>NGC6166-WF4</td><td>GALAXY;ELLIPTICAL;BCM</td><td>n4t204070</td><td>247.1793481664</td><td>39.55485355641</td><td>image</td><td>Geisler, Douglas</td><td>3</td><td>50990.66488426</td><td>50990.79190972</td><td>3583.872072</td><td>1408.3999999999999</td><td>1809.4</td><td>The Metallicity Distribution of the Globular Cluster Systems of Giant Elliptical Galaxies</td><td>51356.53231477</td><td>7265</td><td>GO</td><td>--</td><td>POLYGON -112.81429500000002 39.545485 -112.80873299999996 39.559266 -112.80873332280447 39.559266077458844 -112.80851899999999 39.559797 -112.82164528889807 39.56294585492904 -112.82701700000001 39.564234 -112.83257600000002 39.550452 -112.83257587496034 39.550451970020688 -112.83278999999999 39.549921 -112.83210196969837 39.54975607514 -112.83210199999996 39.549756 -112.81429500000002 39.545485 -112.81429500000002 39.545485</td><td>mast:HST/product/n4t204070_mos.jpg</td><td>mast:HST/product/n4t204070_mos.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24861478</td><td>109228114</td><td>109228114</td><td>73.05880201851693</td></tr>
<tr><td>science</td><td>HST</td><td>CALNIC</td><td>NICMOS/NIC2</td><td>HST</td><td>F160W</td><td>Infrared</td><td>ABELL2199-SKYS</td><td>CALIBRATION;SKY BACKGROUND</td><td>n4hd21030</td><td>247.160006665</td><td>39.47067612935</td><td>image</td><td>Tonry, John L.</td><td>3</td><td>50799.99439224537</td><td>50800.001336608795</td><td>383.990005</td><td>1408.3999999999999</td><td>1809.4</td><td>The SBF Hubble Diagram</td><td>51165.55783555</td><td>7453</td><td>GO</td><td>--</td><td>POLYGON -112.83682999999996 39.469599 -112.83380699999998 39.47445 -112.840036 39.476763 -112.84305900000004 39.471911 -112.83682999999996 39.469599 -112.83682999999996 39.469599 POLYGON -112.83994899999999 39.464592 -112.836926 39.469444 -112.84315500000002 39.471756 -112.84617700000001 39.466904 -112.83994899999999 39.464592 -112.83994899999999 39.464592</td><td>mast:HST/product/n4hd21030_mos.jpg</td><td>mast:HST/product/n4hd21030_mos.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24854837</td><td>109244905</td><td>109244905</td><td>233.75097836993348</td></tr>
<tr><td>science</td><td>HST</td><td>CALWFPC</td><td>WFPC/PC</td><td>HST</td><td>F555W</td><td>Optical</td><td>NGC6166</td><td>GALAXY;ELLIPTICAL;RADIO GALAXY;</td><td>w10a0k03t</td><td>247.1602080555556</td><td>39.55083305555556</td><td>image</td><td>Faber, Sandra M.</td><td>2</td><td>48912.790486770835</td><td>48912.81016269676</td><td>1700.0</td><td>490.4</td><td>605.4</td><td>CORES OF EARLY-TYPE GALAXIES</td><td>49277.97034713</td><td>3912</td><td>GO</td><td>--</td><td>POLYGON 247.16026223 39.55848068 247.16854576 39.55107914 247.158936 39.54468522 247.15065221 39.55208608 247.16026223 39.55848068</td><td>mast:HST/product/w10a0k03t_c0f.jpg</td><td>mast:HST/product/w10a0k03t_c0f.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24734062</td><td>121579829</td><td>121579829</td><td>41.44383128973108</td></tr>
<tr><td>science</td><td>HST</td><td>CALNIC</td><td>NICMOS/NIC3</td><td>HST</td><td>F160W</td><td>Infrared</td><td>ABELL2199-SKYS</td><td>CALIBRATION;SKY BACKGROUND</td><td>n4hd21040</td><td>247.1339505311</td><td>39.48167425652</td><td>image</td><td>Tonry, John L.</td><td>3</td><td>50799.99439305555</td><td>50800.02956019</td><td>383.990005</td><td>1408.3999999999999</td><td>1809.4</td><td>The SBF Hubble Diagram</td><td>51165.55482632</td><td>7453</td><td>GO</td><td>--</td><td>POLYGON -112.863315 39.469529 -112.85511399999996 39.482499 -112.85515305545294 39.48251371201912 -112.85199599999999 39.487506 -112.868742 39.493813 -112.87694099999999 39.480841 -112.87690210780677 39.480826359142355 -112.88005699999997 39.475834 -112.863315 39.469529 -112.863315 39.469529</td><td>mast:HST/product/n4hd21040_mos.jpg</td><td>mast:HST/product/n4hd21040_mos.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24854838</td><td>125025147</td><td>125025147</td><td>171.7010033904009</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/CCD</td><td>HST</td><td>MIRVIS</td><td>Optical</td><td>ANY</td><td>UNIDENTIFIED;PARALLEL FIELD</td><td>o4k1uq010</td><td>247.2330667592</td><td>39.4324369098</td><td>image</td><td>Baum, Stefi A.</td><td>3</td><td>50990.44631774306</td><td>50990.450299421296</td><td>300.0</td><td>nan</td><td>nan</td><td>POMS Test Proposal: STIS non-scripted parallel proposal</td><td>50990.74260405</td><td>7908</td><td>GO/PAR</td><td>--</td><td>POLYGON 247.22159539995113 39.42784078011958 247.22707603758766 39.441280962158395 247.24453811574787 39.437033032856746 247.23905747811133 39.42359285081793 247.22159539995113 39.42784078011958</td><td>--</td><td>mast:HST/product/o4k1uq010_sx2.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24916064</td><td>361298289</td><td>361298289</td><td>425.4196862145258</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/CCD</td><td>HST</td><td>MIRVIS</td><td>Optical</td><td>ANY</td><td>UNIDENTIFIED;PARALLEL FIELD</td><td>o4k1w3010</td><td>247.2671136734</td><td>39.44580006266</td><td>image</td><td>Baum, Stefi A.</td><td>3</td><td>50990.66669961806</td><td>50990.67190813657</td><td>400.0</td><td>nan</td><td>nan</td><td>POMS Test Proposal: STIS non-scripted parallel proposal</td><td>50990.74288183</td><td>7908</td><td>GO/PAR</td><td>--</td><td>POLYGON 247.25563785375158 39.44120729811321 247.26112615216493 39.45464587159116 247.27858949034362 39.45039282058389 247.27310119193027 39.436954247105945 247.25563785375158 39.44120729811321</td><td>--</td><td>mast:HST/product/o4k1w3010_sx2.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24916087</td><td>361298736</td><td>361298736</td><td>448.96962551989975</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/CCD</td><td>HST</td><td>MIRVIS</td><td>Optical</td><td>ANY</td><td>UNIDENTIFIED;PARALLEL FIELD</td><td>o4k1w1010</td><td>247.2411980164</td><td>39.45178911856</td><td>image</td><td>Baum, Stefi A.</td><td>3</td><td>50990.646676655095</td><td>50990.65188480324</td><td>400.0</td><td>nan</td><td>nan</td><td>POMS Test Proposal: STIS non-scripted parallel proposal</td><td>50990.74760404</td><td>7908</td><td>GO/PAR</td><td>--</td><td>POLYGON 247.2297229224898 39.44719380296406 247.23520668238115 39.460633596012656 247.25267310760765 39.456384427532456 247.24718934771633 39.44294463448386 247.2297229224898 39.44719380296406</td><td>--</td><td>mast:HST/product/o4k1w1010_sx2.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24916085</td><td>361298749</td><td>361298749</td><td>383.40239361919663</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/CCD</td><td>HST</td><td>MIRVIS</td><td>Optical</td><td>HI-LATITUDE-FIELD</td><td>STAR</td><td>o5hjmmvbq</td><td>247.1342541244</td><td>39.46526553535</td><td>image</td><td>Baum, Stefi A.</td><td>2</td><td>51383.33821987268</td><td>51383.3399559838</td><td>150.0</td><td>nan</td><td>nan</td><td>POMS Test Proposal: STIS non-scripted parallel proposal continuation V</td><td>51383.69723367</td><td>8406</td><td>ENG/STIS/PAR</td><td>--</td><td>POLYGON 247.1230456105921 39.46029046473415 247.12777066916982 39.473901168582714 247.14546263587928 39.470240599258126 247.14073757730156 39.45662989540956 247.1230456105921 39.46029046473415</td><td>--</td><td>mast:HST/product/o5hjmmvbq_flt.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24458735</td><td>361414815</td><td>361414815</td><td>243.90550319973354</td></tr>
<tr><td>science</td><td>HST</td><td>CALACS</td><td>ACS/WFC</td><td>HST</td><td>F475W</td><td>OPTICAL</td><td>NGC-6166</td><td>GALAXY;ELLIPTICAL</td><td>jbhr01010</td><td>247.1599125</td><td>39.54200555556</td><td>image</td><td>Harris, William Edgar</td><td>3</td><td>55773.28388880787</td><td>55773.415844641204</td><td>5370.0</td><td>390.0</td><td>550.0</td><td>Supermassive Star Clusters in Supergiant Galaxies: Tracing the Enrichment of the Earliest Stellar Systems</td><td>56139.54138886</td><td>12238</td><td>GO</td><td>--</td><td>POLYGON -112.86275602999987 39.518147039999995 -112.86271187025956 39.518206797457765 -112.86268716999994 39.518197600000128 -112.82622465999985 39.567498360000144 -112.82627228862017 39.567516100878137 -112.82625031999989 39.567545780000117 -112.85968168000004 39.579991389999996 -112.8597258711428 39.57993164789022 -112.85975055000009 39.579940830000083 -112.89619584000009 39.53062963 -112.89614819747909 39.530611909670405 -112.89617012999996 39.530582209999942 -112.86275602999987 39.518147039999995 -112.86275602999987 39.518147039999995 POLYGON -112.82970656000008 39.506421130000007 -112.82966139750027 39.506480366747262 -112.82963766999983 39.506471690000005 -112.79275050999998 39.554814740000154 -112.7927988487199 39.554832423044175 -112.79277614000011 39.554862160000091 -112.82519745000006 39.566715840000029 -112.82524264329537 39.566656620917342 -112.82526633999981 39.566665279999995 -112.86213722000011 39.51831200000003 -112.86208885359757 39.518294332653461 -112.86211152999992 39.518264570000127 -112.82970656000008 39.506421130000007 -112.82970656000008 39.506421130000007</td><td>mast:HST/product/jbhr01010_drz.jpg</td><td>mast:HST/product/jbhr01010_drz.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24834402</td><td>741033393</td><td>741033393</td><td>0.0</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>science</td><td>HST</td><td>CALWF3</td><td>WFC3/UVIS</td><td>HST</td><td>F336W</td><td>OPTICAL</td><td>PS15AOT-SN2009EU-HOST</td><td>GALAXY;ELLIPTICAL</td><td>iey929010</td><td>247.1654514304</td><td>39.55075434279</td><td>image</td><td>Kelsey, Lisa</td><td>3</td><td>59933.10898993056</td><td>59933.12674452546</td><td>360.0</td><td>305.8</td><td>367.3</td><td>Local Environments of Low-redshift Type Ia Supernova Siblings</td><td>59933.48858801</td><td>17194</td><td>SNAP</td><td>--</td><td>POLYGON -112.81925200000011 39.522145629999855 -112.80732268999986 39.54258658000002 -112.80737951545382 39.542610020566 -112.80711494851404 39.543063207567947 -112.80689240000011 39.542972830000032 -112.79484269999986 39.563667969999919 -112.7948988548921 39.563690775328347 -112.79454513999994 39.564298070000078 -112.84659405999993 39.58541789 -112.85863210000019 39.564717380000012 -112.85857593339213 39.564694609384638 -112.85892909000003 39.564087120000067 -112.85884136466962 39.564051555105166 -112.87051424999994 39.544025700000113 -112.87045739161762 39.544002285837124 -112.8708110300001 39.543395389999866 -112.81925200000011 39.522145629999855 -112.81925200000011 39.522145629999855</td><td>mast:HST/product/iey929010_drz.jpg</td><td>mast:HST/product/iey929010_drz.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>106457966</td><td>767238113</td><td>767238113</td><td>0.0</td></tr>
<tr><td>science</td><td>HST</td><td>CALACS</td><td>ACS/WFC</td><td>HST</td><td>F814W</td><td>OPTICAL</td><td>NGC6166</td><td>GALAXY;ELLIPTICAL;LINER</td><td>j6jt05020</td><td>247.1443138604</td><td>39.56568924527</td><td>image</td><td>Ford, Holland</td><td>3</td><td>52764.767804282405</td><td>52764.77748040509</td><td>700.0</td><td>708.0</td><td>959.0</td><td>Massive Black Holes in Early Type Galaxies</td><td>53131.42950234</td><td>9293</td><td>GTO/ACS</td><td>--</td><td>POLYGON -112.81907106000008 39.563255929999912 -112.81404633000007 39.591601029999993 -112.88610806999993 39.603104409999894 -112.89110415000002 39.574756219999934 -112.81907106000008 39.563255929999912 -112.81907106000008 39.563255929999912 POLYGON -112.82436564000002 39.534789040000064 -112.81978306000008 39.562217240000045 -112.8907723199999 39.574315340000112 -112.89532763000001 39.546884369999972 -112.82436564000002 39.534789040000064 -112.82436564000002 39.534789040000064</td><td>mast:HST/product/j6jt05021_drz.jpg</td><td>mast:HST/product/j6jt05021_drz.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>26091432</td><td>785134894</td><td>785134894</td><td>0.0</td></tr>
<tr><td>science</td><td>HST</td><td>CALWFPC2</td><td>WFPC2/PC</td><td>HST</td><td>F673N</td><td>OPTICAL</td><td>3C338.0</td><td>GALAXY;RADIO GALAXY;</td><td>u2s07801t</td><td>247.1593798559</td><td>39.54271951924</td><td>image</td><td>Sparks, William B.</td><td>3</td><td>50048.450891898145</td><td>50048.45436412037</td><td>300.0</td><td>670.86</td><td>675.58</td><td>Snapshots of 3CR Radio Galaxies</td><td>50415.09186345</td><td>5957</td><td>SNAP</td><td>--</td><td>POLYGON 247.1588745068656 39.54384182979161 247.15046986829364 39.551449716293796 247.16032049263436 39.55793939381302 247.16872670919946 39.5503338532899 247.1588745068656 39.54384182979161</td><td>mast:HST/product/u2s07801t_drw.jpg</td><td>mast:HST/product/u2s07801t_drw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24561898</td><td>788766846</td><td>788766846</td><td>39.4469579247626</td></tr>
<tr><td>science</td><td>HST</td><td>CALWFPC2</td><td>WFPC2/PC</td><td>HST</td><td>F673N</td><td>OPTICAL</td><td>3C338.0</td><td>GALAXY;RADIO GALAXY;</td><td>u2s07802t</td><td>247.1593798559</td><td>39.54271951924</td><td>image</td><td>Sparks, William B.</td><td>3</td><td>50048.456447453704</td><td>50048.45991967592</td><td>300.0</td><td>670.86</td><td>675.58</td><td>Snapshots of 3CR Radio Galaxies</td><td>50415.09549769</td><td>5957</td><td>SNAP</td><td>--</td><td>POLYGON 247.1588745068656 39.54384182979161 247.15046986829364 39.551449716293796 247.16032049263436 39.55793939381302 247.16872670919946 39.5503338532899 247.1588745068656 39.54384182979161</td><td>mast:HST/product/u2s07802t_drw.jpg</td><td>mast:HST/product/u2s07802t_drw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24561899</td><td>788771094</td><td>788771094</td><td>39.4469579247626</td></tr>
<tr><td>science</td><td>HST</td><td>CALWFPC2</td><td>WFPC2/PC</td><td>HST</td><td>F606W</td><td>OPTICAL</td><td>ANY</td><td>UNIDENTIFIED;PARALLEL FIELD</td><td>u4k2m601r</td><td>247.2639535316</td><td>39.51530930574</td><td>image</td><td>Casertano, Stefano</td><td>3</td><td>50990.44738506944</td><td>50990.453172106485</td><td>500.0</td><td>510.89</td><td>661.13</td><td>POMS Test Proposal: WFII parallel archive proposal</td><td>50990.63297444</td><td>7909</td><td>GO/PAR</td><td>--</td><td>POLYGON 247.26529584017683 39.51484093361801 247.27765482259042 39.51184985808498 247.27379760950498 39.502314521624314 247.26144081752278 39.50530203906747 247.26529584017683 39.51484093361801</td><td>mast:HST/product/u4k2m601r_drw.jpg</td><td>mast:HST/product/u4k2m601r_drw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24602332</td><td>789739298</td><td>789739298</td><td>349.30898244486366</td></tr>
<tr><td>science</td><td>HST</td><td>CALWFPC2</td><td>WFPC2/PC</td><td>HST</td><td>F606W</td><td>OPTICAL</td><td>HIGH</td><td>EXT-MEDIUM</td><td>u4k2lz02r</td><td>247.2980470745</td><td>39.52866341629</td><td>image</td><td>Casertano, Stefano</td><td>3</td><td>50990.67377395833</td><td>50990.67956099537</td><td>500.0</td><td>510.89</td><td>661.13</td><td>POMS Test Proposal: WFII parallel archive proposal</td><td>50990.74797447</td><td>7909</td><td>GO/PAR</td><td>--</td><td>POLYGON 247.2993894074153 39.52819464989219 247.31174929014978 39.525199948201404 247.30788663478177 39.51566574427916 247.2955289412657 39.51865688704364 247.2993894074153 39.52819464989219</td><td>mast:HST/product/u4k2lz02r_drw.jpg</td><td>mast:HST/product/u4k2lz02r_drw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24602316</td><td>789745750</td><td>789745750</td><td>428.30333475443496</td></tr>
<tr><td>science</td><td>HST</td><td>CALWFPC2</td><td>WFPC2/PC</td><td>HST</td><td>F606W</td><td>OPTICAL</td><td>ANY</td><td>UNIDENTIFIED;PARALLEL FIELD</td><td>u4k2m602r</td><td>247.2632660938</td><td>39.51547482218</td><td>image</td><td>Casertano, Stefano</td><td>3</td><td>50990.45849618055</td><td>50990.466598032406</td><td>700.0</td><td>510.89</td><td>661.13</td><td>POMS Test Proposal: WFII parallel archive proposal</td><td>50990.63315963</td><td>7909</td><td>GO/PAR</td><td>--</td><td>POLYGON 247.2646084101698 39.51500645775736 247.27696745093658 39.512015453275325 247.27311032077844 39.502480094631046 247.26075347050354 39.505467541033354 247.2646084101698 39.51500645775736</td><td>mast:HST/product/u4k2m602r_drw.jpg</td><td>mast:HST/product/u4k2m602r_drw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24602333</td><td>789745772</td><td>789745772</td><td>347.3089749576426</td></tr>
<tr><td>science</td><td>HST</td><td>CALWFPC2</td><td>WFPC2/PC</td><td>HST</td><td>F300W</td><td>UV</td><td>HIGH</td><td>EXT-MEDIUM</td><td>u4k2ly04r</td><td>247.2714155412</td><td>39.53482491055</td><td>image</td><td>Casertano, Stefano</td><td>3</td><td>50990.59599618056</td><td>50990.61219988426</td><td>1400.0</td><td>254.97</td><td>328.99</td><td>POMS Test Proposal: WFII parallel archive proposal</td><td>50990.74858789</td><td>7909</td><td>GO/PAR</td><td>--</td><td>POLYGON 247.27276176864666 39.53435065873066 247.28511525876343 39.53136396134659 247.28125839985375 39.521834221792595 247.2689065892541 39.52481973537812 247.27276176864666 39.53435065873066</td><td>mast:HST/product/u4k2ly04r_drw.jpg</td><td>mast:HST/product/u4k2ly04r_drw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24602313</td><td>789756114</td><td>789756114</td><td>351.64648648762767</td></tr>
<tr><td>science</td><td>HST</td><td>CALWFPC2</td><td>WFPC2/PC</td><td>HST</td><td>F555W</td><td>OPTICAL</td><td>NGC6166-CENTER</td><td>GALAXY;ELLIPTICAL;BCM</td><td>u4t20301r</td><td>247.1604779253</td><td>39.54909217001</td><td>image</td><td>Geisler, Douglas</td><td>3</td><td>51383.33765628472</td><td>51383.35270258102</td><td>1300.0</td><td>472.26000000000005</td><td>595.1</td><td>The Metallicity Distribution of the Globular Cluster Systems of Giant Elliptical Galaxies</td><td>51749.69840271</td><td>7265</td><td>GO</td><td>--</td><td>POLYGON 247.16184361753605 39.54867518305677 247.17436379619448 39.546100335007374 247.17104405360607 39.53644599006302 247.15852636186068 39.53901759053526 247.16184361753605 39.54867518305677</td><td>mast:HST/product/u4t20301r_drw.jpg</td><td>mast:HST/product/u4t20301r_drw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24604264</td><td>789805403</td><td>789805403</td><td>40.95574336166708</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/CCD</td><td>HST</td><td>G750L</td><td>OPTICAL</td><td>ANY</td><td>UNIDENTIFIED;PARALLEL FIELD</td><td>o4k1v9piq</td><td>247.2405111522</td><td>39.45195450143</td><td>spectrum</td><td>Baum, Stefi A.</td><td>2</td><td>50990.598378125</td><td>50990.612544791664</td><td>1224.0</td><td>524.0</td><td>1027.0</td><td>POMS Test Proposal: STIS non-scripted parallel proposal</td><td>50990.74354161</td><td>7908</td><td>GO/PAR</td><td>--</td><td>POLYGON 247.22903608175014 39.447359110323134 247.23451970633545 39.46079893945676 247.2519862199474 39.45654988591336 247.2465025953621 39.44311005677974 247.22903608175014 39.447359110323134</td><td>--</td><td>mast:HST/product/o4k1v9piq_flt.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24442445</td><td>794180714</td><td>794180714</td><td>381.6948436989644</td></tr>
</table></div></div></div>
</div>
<p>Similar to eBOSS, we’ll retrieve and download the products for Abell 2199, specifically the fully calibrated combined images using <code class="docutils literal notranslate"><span class="pre">productGroupDescription</span> <span class="pre">=</span> <span class="pre">'Minimum</span> <span class="pre">Recommended</span> <span class="pre">Products'</span></code> and <code class="docutils literal notranslate"><span class="pre">productSubGroupDescription</span> <span class="pre">=</span> <span class="pre">'DRZ'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get products from query</span>
<span class="n">products_hst</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs_hst</span><span class="p">)</span>

<span class="c1"># Select specific products</span>
<span class="n">products_hst</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span>
    <span class="n">products_hst</span><span class="p">,</span>
    <span class="c1"># Specify science files</span>
    <span class="n">productType</span><span class="o">=</span><span class="s2">&quot;SCIENCE&quot;</span><span class="p">,</span>
    <span class="c1"># Recommended products,</span>
    <span class="n">productGroupDescription</span><span class="o">=</span><span class="s2">&quot;Minimum Recommended Products&quot;</span><span class="p">,</span>
    <span class="c1"># DRZ files -&gt; calibrated combined images</span>
    <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="s2">&quot;DRZ&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Display product list</span>
<span class="n">products_hst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=11</i>
<table id="table140368742143440" class="table-striped table-bordered table-condensed">
<thead><tr><th>obsID</th><th>obs_collection</th><th>dataproduct_type</th><th>obs_id</th><th>description</th><th>type</th><th>dataURI</th><th>productType</th><th>productGroupDescription</th><th>productSubGroupDescription</th><th>productDocumentationURL</th><th>project</th><th>prvversion</th><th>proposal_id</th><th>productFilename</th><th>size</th><th>parent_obsid</th><th>dataRights</th><th>calib_level</th><th>filters</th></tr></thead>
<thead><tr><th>str9</th><th>str3</th><th>str8</th><th>str37</th><th>str67</th><th>str1</th><th>str97</th><th>str9</th><th>str28</th><th>str11</th><th>str1</th><th>str8</th><th>str20</th><th>str5</th><th>str52</th><th>int64</th><th>str9</th><th>str6</th><th>int64</th><th>str9</th></tr></thead>
<tr><td>24801640</td><td>HST</td><td>image</td><td>ibhr01020</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/ibhr01020_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALWF3</td><td>3.7.2 (Apr-15-2024)</td><td>12238</td><td>ibhr01020_drz.fits</td><td>217932480</td><td>24801640</td><td>PUBLIC</td><td>3</td><td>F475W</td></tr>
<tr><td>24801653</td><td>HST</td><td>image</td><td>ibhr13030</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/ibhr13030_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALWF3</td><td>3.7.2 (Apr-15-2024)</td><td>12238</td><td>ibhr13030_drz.fits</td><td>217638720</td><td>24801653</td><td>PUBLIC</td><td>3</td><td>F814W</td></tr>
<tr><td>24801654</td><td>HST</td><td>image</td><td>ibhr13040</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/ibhr13040_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALWF3</td><td>3.7.2 (Apr-15-2024)</td><td>12238</td><td>ibhr13040_drz.fits</td><td>217638720</td><td>24801654</td><td>PUBLIC</td><td>3</td><td>F814W</td></tr>
<tr><td>24834402</td><td>HST</td><td>image</td><td>jbhr01010</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/jbhr01010_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALACS</td><td>DrizzlePac 3.9.1</td><td>12238</td><td>jbhr01010_drz.fits</td><td>215023680</td><td>24834402</td><td>PUBLIC</td><td>3</td><td>F475W</td></tr>
<tr><td>24834415</td><td>HST</td><td>image</td><td>jbhr13010</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/jbhr13010_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALACS</td><td>DrizzlePac 3.9.1</td><td>12238</td><td>jbhr13010_drz.fits</td><td>214859520</td><td>24834415</td><td>PUBLIC</td><td>3</td><td>F814W</td></tr>
<tr><td>24834416</td><td>HST</td><td>image</td><td>jbhr13020</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/jbhr13020_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALACS</td><td>DrizzlePac 3.9.1</td><td>12238</td><td>jbhr13020_drz.fits</td><td>214859520</td><td>24834416</td><td>PUBLIC</td><td>3</td><td>F814W</td></tr>
<tr><td>24834423</td><td>HST</td><td>image</td><td>jbhv02010</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/jbhv02010_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALACS</td><td>DrizzlePac 3.9.1</td><td>12220</td><td>jbhv02010_drz.fits</td><td>23569920</td><td>24834423</td><td>PUBLIC</td><td>3</td><td>F140LP</td></tr>
<tr><td>26091389</td><td>HST</td><td>image</td><td>j6jt05010</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/j6jt05011_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALACS</td><td>DrizzlePac 3.9.1</td><td>9293</td><td>j6jt05011_drz.fits</td><td>214456320</td><td>26091389</td><td>PUBLIC</td><td>3</td><td>FR656N</td></tr>
<tr><td>26091432</td><td>HST</td><td>image</td><td>j6jt05020</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/j6jt05021_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALACS</td><td>DrizzlePac 3.9.1</td><td>9293</td><td>j6jt05021_drz.fits</td><td>214352640</td><td>26091432</td><td>PUBLIC</td><td>3</td><td>F814W</td></tr>
<tr><td>106457965</td><td>HST</td><td>image</td><td>iey929020</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/iey929020_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALWF3</td><td>3.7.2 (Apr-15-2024)</td><td>17194</td><td>iey929020_drz.fits</td><td>220492800</td><td>106457965</td><td>PUBLIC</td><td>3</td><td>F625W</td></tr>
<tr><td>106457966</td><td>HST</td><td>image</td><td>iey929010</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/iey929010_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALWF3</td><td>3.7.2 (Apr-15-2024)</td><td>17194</td><td>iey929010_drz.fits</td><td>220492800</td><td>106457966</td><td>PUBLIC</td><td>3</td><td>F336W</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download products into same directory</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">products_hst</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibhr01020_drz.fits to ./ibhr01020_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibhr13030_drz.fits to ./ibhr13030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibhr13040_drz.fits to ./ibhr13040_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/iey929010_drz.fits to ./iey929010_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/iey929020_drz.fits to ./iey929020_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/j6jt05011_drz.fits to ./j6jt05011_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/j6jt05021_drz.fits to ./j6jt05021_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/jbhr01010_drz.fits to ./jbhr01010_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/jbhr13010_drz.fits to ./jbhr13010_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/jbhr13020_drz.fits to ./jbhr13020_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/jbhv02010_drz.fits to ./jbhv02010_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=11</i>
<table id="table140368017723536" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str20</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>./ibhr01020_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./ibhr13030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./ibhr13040_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./iey929010_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./iey929020_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./j6jt05011_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./j6jt05021_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./jbhr01010_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./jbhr13010_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./jbhr13020_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./jbhv02010_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p>Each FITS file has a corresponding filter in the table above under the <code class="docutils literal notranslate"><span class="pre">filter</span></code> column. To create a color image, we’ll choose three images that overlap coordinates and have different filters.</p>
<p>The following images were picked based on if they overlapped in the AstroView of the <a class="reference external" href="https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html">MAST Portal</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Opening three different filters</span>
<span class="n">img1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;j6jt05011_drz.fits&quot;</span><span class="p">)</span>
<span class="n">img1_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">img1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

<span class="n">img2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;j6jt05021_drz.fits&quot;</span><span class="p">)</span>
<span class="n">img2_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">img2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

<span class="n">img3</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;iey929020_drz.fits&quot;</span><span class="p">)</span>
<span class="n">img3_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">img3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plotting-the-hst-images">
<h4>Plotting the HST Images<a class="headerlink" href="#plotting-the-hst-images" title="Permalink to this heading">#</a></h4>
<p>We’ll now set up a subplot of the three images we chose. The first two images were taken as a pair of images (hence the small whitespace in the center). You can see the overlap in all three images where there’s a fairly consistent cluster of five galaxy sources. While the shapes of these galaxies aren’t very clear in these images, they’ll become more distinct when we create the color image!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># First image</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">img1_wcs</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">img1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;INSTRUME&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">img1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILTER1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Declination&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Right Ascension&quot;</span><span class="p">)</span>

<span class="c1"># Second image</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">img2_wcs</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">img2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;INSTRUME&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">img2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILTER1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Declination&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Right Ascension&quot;</span><span class="p">)</span>

<span class="c1"># Third image</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">img3_wcs</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">img3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;INSTRUME&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">img3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILTER&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Declination&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Right Ascension&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/2c4b994a251287565ea2a85accc5bac5e3b3ae426f1eace5f68928dbbdbf0bd7.png" src="../../../_images/2c4b994a251287565ea2a85accc5bac5e3b3ae426f1eace5f68928dbbdbf0bd7.png" />
</div>
</div>
</section>
<section id="colorizing-the-hst-image-of-abell-2199">
<h4>Colorizing the HST Image of Abell 2199<a class="headerlink" href="#colorizing-the-hst-image-of-abell-2199" title="Permalink to this heading">#</a></h4>
<p>In order to create a color image of Abell 2199, we can assign red, green, and blue to each image, then combine the three images. We must choose the image with the largest pixel dimensions, and then project the other images onto it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checking the shape of each image to determine which ones will be mapped onto the other</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of image 1: </span><span class="si">{</span><span class="n">img1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of image 2: </span><span class="si">{</span><span class="n">img2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of image 3: </span><span class="si">{</span><span class="n">img3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of image 1: (4239, 4213)
Shape of image 2: (4238, 4212)
Shape of image 3: (4446, 4130)
</pre></div>
</div>
</div>
</div>
<p>The third image appears to have the largest dimensions, so we’ll project the first and second images onto the third using <code class="docutils literal notranslate"><span class="pre">reproject</span></code>. We’ll assign the first image to red, the second to blue, and the third to green.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># image 1 -&gt; red</span>
<span class="n">r</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">reproject</span><span class="o">.</span><span class="n">reproject_interp</span><span class="p">(</span><span class="n">img1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

<span class="c1"># image 2 -&gt; green</span>
<span class="n">g</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">reproject</span><span class="o">.</span><span class="n">reproject_interp</span><span class="p">(</span><span class="n">img2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

<span class="c1"># image 3 -&gt; blue</span>
<span class="n">b</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">reproject</span><span class="o">.</span><span class="n">reproject_interp</span><span class="p">(</span><span class="n">img3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Using a ratio of red, blue, and green, we can now make a colorized image using <code class="docutils literal notranslate"><span class="pre">make_lupton_rgb</span></code>!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_hst</span> <span class="o">=</span> <span class="n">make_lupton_rgb</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="mf">3.8</span><span class="p">,</span> <span class="n">g</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="mf">0.65</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/astropy/visualization/basic_rgb.py:153: RuntimeWarning: invalid value encountered in cast
  return image_rgb.astype(output_dtype)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting the colorized image</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Ensuring the coordinates are set to the WCS of the third image</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">img3_wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_hst</span><span class="p">)</span>

<span class="c1"># Zoom in</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1400</span><span class="p">,</span> <span class="mi">2100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">2200</span><span class="p">,</span> <span class="mi">2900</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Right Ascension&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Declination&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Colorized Image of Abell 2199&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2138/2518464466.py:15: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  ax.legend()
/tmp/ipykernel_2138/2518464466.py:16: UserWarning: Tight layout not applied. The left and right margins cannot be made large enough to accommodate all Axes decorations.
  plt.tight_layout()
</pre></div>
</div>
<img alt="../../../_images/f1925ace2a0e81aacbee0dbc1e89f3265a166ea0feb4c99ddba84709d2ce791c.png" src="../../../_images/f1925ace2a0e81aacbee0dbc1e89f3265a166ea0feb4c99ddba84709d2ce791c.png" />
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="end-of-tutorial">
<h2>End of Tutorial<a class="headerlink" href="#end-of-tutorial" title="Permalink to this heading">#</a></h2>
<p>Congratulations, you’ve reached the end of this notebook! You’ve learned how to use <code class="docutils literal notranslate"><span class="pre">astroquery.MAST</span></code> to calculate Hubble’s constant from eBOSS data and make a colorized image from HST data!</p>
</section>
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h2>
<p>Additional resources are linked below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://archive.stsci.edu/missions-and-data/sdss">SDSS Legacy Archive at MAST</a></p></li>
<li><p><a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/The+SDSS+Legacy+Archive+at+MAST">SDSS Legacy Archive at MAST User Manual</a></p></li>
<li><p><a class="reference external" href="https://skyserver.sdss.org/dr1/en/proj/advanced/hubble/">Original SDSS Hubble Diagram Tutorial!</a></p></li>
<li><p><a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/eBOSS">eBOSS User Manual</a></p></li>
<li><p><a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html">astroquery.mast User Manual</a></p></li>
<li><p><a class="reference external" href="https://mast.stsci.edu/api/v0/index.html">MAST API</a></p></li>
</ul>
</section>
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Permalink to this heading">#</a></h2>
<p>If you use data from MAST for published research, please see the following links for information on which citations to include in your paper:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://sdss.org/collaboration/citing-sdss/">Citing SDSS</a></p></li>
<li><p><a class="reference external" href="https://archive.stsci.edu/publishing/mission-acknowledgements">Citing MAST</a></p></li>
<li><p><a class="reference external" href="https://www.astropy.org/acknowledging.html">Citing astropy</a></p></li>
</ul>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h2>
<p><strong>Author(s):</strong> Natalie Haugen (nhaugen&#64;terpmail.umd.edu) and Julie Imig (jimig&#64;stsci.edu)<br>
<strong>Keyword(s):</strong> Tutorial, eBOSS, HST, SDSS, galaxies <br>
<strong>First published:</strong> July 2025 <br>
<strong>Last updated:</strong> July 2025 <br></p>
<hr class="docutils" />
<p><span class="xref myst">Top of Page</span>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/style-guides/master/guides/images/stsci-logo.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/style-guides/master/guides/images/stsci-logo.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/SDSS/eBOSS_HST_hubbles_law"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exploring High-Redshift Quasars with eBOSS and JWST</p>
      </div>
    </a>
    <a class="right-next"
       href="../../multi_mission/astroquery.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Astroquery</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-eboss-data-from-mast">Accessing eBOSS Data from MAST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-eboss-data">Querying eBOSS Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-eboss-for-redshifted-galaxies">Sampling eBOSS for Redshifted Galaxies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-products-from-eboss">Downloading Products from eBOSS</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-the-hubble-lemaitre-diagram">Making the Hubble-Lemaître Diagram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-eboss-data">Plotting eBOSS Data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-abell-2199-data">Importing Abell 2199 Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-calculated-h-sub-0-sub-to-other-models">Comparing Calculated H<sub>0</sub> to Other Models</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#utilizing-hst-data-from-mast">Utilizing HST Data from MAST</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-an-image-of-abell-2199-using-hst">Creating an Image of Abell 2199 Using HST</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-hst-images">Plotting the HST Images</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#colorizing-the-hst-image-of-abell-2199">Colorizing the HST Image of Abell 2199</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#end-of-tutorial">End of Tutorial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>