

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Exploring High-Redshift Quasars with eBOSS and JWST &#8212; MAST Notebook Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-SK672ZMP7G"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/SDSS/eBOSS_JWST_tutorial/eBOSS_JWST_tutorial';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Calculating the Hubble Constant with eBOSS" href="../eBOSS_HST_hubbles_law/hubbles_law.html" />
    <link rel="prev" title="Characterizing Variable Stars with APOGEE + TESS" href="../APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/mastlogo.svg" class="logo__image only-light" alt="MAST Notebook Repository - Home"/>
    <script>document.write(`<img src="../../../_static/mastlogo.svg" class="logo__image only-dark" alt="MAST Notebook Repository - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to the MAST Notebook Repository!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">GALEX</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../GALEX/mis_mosaic/mis_mosaic.html">Surveying dust structure via GALEX MIS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HSC</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/queries.html">Intro HSC Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSCV3_API/hscv3_api.html">Hubble Source Catalog API Notebook</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSCV3_SMC_API/hscv3_smc_api.html">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSC_TAP/HSC_TAP.html">MAST Table Access Protocol Hubble Source Catalog Demo</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/SWEEPS.html">SWEEPS Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1/sweeps_hscv3p1.html">Hubble Source Catalog SWEEPS Proper Motion (CasJobs Version)</a></li>






















<li class="toctree-l2"><a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1_API/sweeps_hscv3p1_api.html">Hubble Source Catalog SWEEPS Proper Motion (API Version)</a></li>









</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/HCV.html">Hubble Catalog of Variables (HCV) Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/HCV_API/HCV_API_demo.html">Hubble Catalog of Variables Notebook (API version)</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HCV_CASJOBS/HCV_casjobs_demo.html">Hubble Catalog of Variables Notebook (CasJobs version)</a></li>



</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">IUE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html">Exploring UV Extinction Curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JWST</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">Accessing JWST Proposal Data in astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/duplication_checking/duplication_checking.html">JWST Duplication Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">JWST Engineering Data Retrieval</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/SI_keyword_exoplanet_search/SI_keyword_exoplanet_search.html">JWST SI Keyword Search for Exoplanet Spectra</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/MAST_metadata_search/MAST_metadata_search.html">Astroquery: Exploring Metadata from the James Webb Space Telescope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_lightcurves/plotting_lightcurves.html">Using Kepler Data to Plot a Light Curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_images_from_tpf/plotting_images_from_tpf.html">Plotting Images from Kepler Target Pixel Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_dvts/plotting_dvts.html">Read and Plot A Kepler Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_catalog_over_FFI/plotting_catalog_over_FFI.html">Plotting a Catalog over a Kepler Full Frame Image File</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/lightkurve.html">Lightkurve</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_lc_products/lightkurve_analyzing_lc_products.html">Using <em>Kepler</em> Light Curve Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_tpf_products/lightkurve_analyzing_tpf_products.html">Using <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_searching_for_data/lightkurve_searching_for_data.html">Searching for <em>Kepler</em>/<em>K2</em> and <em>TESS</em> Data Products Using Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_custom_aperture_photometry/lightkurve_custom_aperture_photometry.html">Creating Your Own Light Curves using Custom Aperture Photometry</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_combining_multiple_quarters/lightkurve_combining_multiple_quarters.html">Combining Multiple Quarters of <em>Kepler</em> Data with Lightkurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_interactively_inspecting_TPFs_and_LCs/lightkurve_interactively_inspecting_TPFs_and_LCs.html">Interactively Inspecting Target Pixel Files and Light Curves</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/inst_noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_1_data_gaps_and_quality_flags/instrumental_noise_1_data_gaps_and_quality_flags.html">Data Gaps and Quality Flags</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_2_spurious_signals_and_time_sampling_effects/instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">Spurious Signals and Time Sampling Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_3_seasonal_and_detector_effects/instrumental_noise_3_seasonal_and_detector_effects.html">Seasonal and Detector Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_4_electronic_noise/instrumental_noise_4_electronic_noise.html">Electronic Noise</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/signals.html">Identifying Periodic Signals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/identifying_transiting_planet_signals/identifying_transiting_planet_signals.html">Identifying Transiting Planet Signals in a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/measuring_a_rotation_period/measuring_a_rotation_period.html">Measuring and Removing a Rotation Period Signal from a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/visualizing_periodic_signals_using_a_river_plot/visualizing_periodic_signals_using_a_river_plot.html">Visualizing Periodic Signals Using a River Plot</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/verifying_the_location_of_a_signal/verifying_the_location_of_a_signal.html">Verifying the Location of a Signal in <em>Kepler</em> Pixel Data</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/periodograms.html">Periodograms &amp; Asteroseismology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/creating_periodograms/creating_periodograms.html">Creating Periodograms</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">How to Understand and Manipulate the Periodogram of an Oscillating Star</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">How to Estimate a Star’s Mass and Radius Using Asteroseismology</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">K2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../K2/TPF/TPF.html">Beginner: Read and Display A K2 Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a K2 Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/removing_instrumental_noise_using_pld/removing_instrumental_noise_using_pld.html">Removing Instrumental Noise from <em>K2</em> and <em>TESS</em> Light Curves Using Pixel Level Decorrelation (PLD)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MCCM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MCCM/FIMS-SPEAR/hyperspectral_healpix_maps/hyperspectral_healpix_maps.html">Working with FIMS-SPEAR Hyperspectral HEALPix Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SDSS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../sdss.html">Sloan Digital Sky Survey (SDSS)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../MaNGA_HST_tutorial/MaNGA_HST_tutorial.html">Mapping Galaxy Properties with MaNGA + HST</a></li>



<li class="toctree-l2"><a class="reference internal" href="../APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html">Characterizing Variable Stars with APOGEE + TESS</a></li>






<li class="toctree-l2 current active"><a class="current reference internal" href="#">Exploring High-Redshift Quasars with eBOSS and JWST</a></li>




<li class="toctree-l2"><a class="reference internal" href="../eBOSS_HST_hubbles_law/hubbles_law.html">Calculating the Hubble Constant with eBOSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SDSS_LEGACY_IMAGING_cmd/cmd_diagram.html">Creating a Color-Magnitude Diagram for Messier 13</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multi-Mission Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../multi_mission/astroquery.html">Astroquery</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_search/beginner_search.html">Beginner: Searching MAST using astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_zcut/beginner_zcut.html">Beginner: Zcut and Astroquery Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/large_downloads/large_downloads.html">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/historic_quasar_observations/historic_quasar_observations.html">Historical Quasar Observations</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/wildcard_searches/wildcard_searches.html">Wildcard Handling with Astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/missions_mast_search/missions_mast_search.html">Searching for Mission-Specific Data with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/galex_panstarrs_bulk_download/galex_panstarrs_bulk_download.html"><strong>Large downloads in astroquery.mast from AWS to local storage</strong></a></li>

</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../multi_mission/display_footprints/display_footprints.html">PySIAF Observation Footprint Viewer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PanSTARRS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">MAST Table Access Protocol PanSTARRS 1 DR2 Demo</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_image/PS1_image.html">Get Images from the PS1 Image Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TESS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">Retrieve TESS Data Validation Products with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">Read and Plot A TESS Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Read and Display a TESS Full Frame Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">Read and Plot A TESS Light Curve File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">Read and Display A TESS Target Pixel File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">Exoplanet Data and TESS Light Curves Using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">Download MAST TESS Light Curves Within an FFI Footprint Using TAP</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">Search The TESS Input Catalog Centered On HD 209458.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">A Tour of the Contents of the TESS 2-minute Cadence Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tesscut_astroquery/beginner_tesscut_astroquery.html">Cutout of the TESS FFIs using Astrocut and Astroquery</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/lc.html">Light Curves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">Intermediate:  Search and Download GI Program Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tasoc_lc/interm_tasoc_lc.html">Intermediate: Finding Flares and Variable Stars in TASOC Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/asteroid_rotation/asteroid_rotation.html">Finding the Rotation Curve of an Asteroid or Comet with TESScut and Lightkurve</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/FFIs.html">TESS FFIs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">Intermediate: Create TESS FFI Cutout using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/making_tess_cubes_and_cutouts/making_tess_cubes_and_cutouts.html">Generating Cubes and Cutouts from TESS FFIs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">Intermediate: Retrieve TESS Pixel Response Function Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/removing_scattered_light_using_regression/removing_scattered_light_using_regression.html">Removing Scattered Light from <em>TESS</em> Data Using the Lightkurve <code class="docutils literal notranslate"><span class="pre">RegressionCorrector</span></code></a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualizations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Visualizations/mast_sky/mast_sky.html">MAST’S View of the Sky</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://timeseries.science.stsci.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/spacetelescope/mast_notebooks&urlpath=lab/tree/mast_notebooks/notebooks/SDSS/eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/SDSS/eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/SDSS/eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exploring High-Redshift Quasars with eBOSS and JWST</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Exploring High-Redshift Quasars with eBOSS and JWST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-eboss-data-at-mast">Accessing eBOSS data at MAST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-all-eboss-data">Querying all eBOSS data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-specific-target">Searching for a specific target</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-eboss-data-products">Downloading eBOSS data products</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-an-eboss-spectrum">Plotting an eBOSS Spectrum</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identifying-emission-lines-in-a-qso-spectrum">Identifying Emission Lines in a QSO Spectrum</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-qso-spectra-at-different-redshift">Exploring QSO spectra at different redshift</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-high-redshift-jwst-spectra">Searching for High-Redshift JWST spectra</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-eboss-and-jwst-data">Combining eBOSS and JWST Data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a id="top"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="exploring-high-redshift-quasars-with-eboss-and-jwst">
<h1>Exploring High-Redshift Quasars with eBOSS and JWST<a class="headerlink" href="#exploring-high-redshift-quasars-with-eboss-and-jwst" title="Permalink to this heading">#</a></h1>
<hr class="docutils" />
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<p>By the end of this tutorial, you will:</p>
<ul class="simple">
<li><p>Understand how to search the MAST Archive and download SDSS eBOSS data using <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></p></li>
<li><p>Learn how to identify emisison lines in quasar spectra at different redshifts</p></li>
<li><p>Download and plot quasar spectra from both eBOSS and JWST</p></li>
</ul>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><span class="xref myst">Introduction</span></p></li>
<li><p><span class="xref myst">Imports</span></p></li>
<li><p><span class="xref myst">Accessing eBOSS data at MAST</span></p>
<ul>
<li><p><span class="xref myst">Querying all eBOSS data</span></p></li>
<li><p><span class="xref myst">Searching for a specific target</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Plotting an eBOSS Spectrum</span></p>
<ul>
<li><p><span class="xref myst">Identifying Emission Lines in a QSO Spectrum</span></p></li>
<li><p><span class="xref myst">Exploring QSO spectra at different redshift</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Searching for High-Redshift JWST spectra</span></p>
<ul>
<li><p><span class="xref myst">Combining eBOSS and JWST Data</span></p></li>
</ul>
</li>
<li><p><span class="xref myst">Additional Resources</span></p>
<ul>
<li><p><span class="xref myst">How to Cite</span></p></li>
<li><p><span class="xref myst">About This Notebook</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://www.sdss4.org/surveys/eboss/">Extended Baryonic Oscillaton Spectroscopic Survey (eBOSS)</a> survey provides optical-wavelength 1-D spectra for almost 4,000,000 targets in the northern hemisphere, including stars, galaxies, and quasars. eBOSS collected data between 2008 - 2020 as part of the <a class="reference external" href="https://www.sdss4.org">Sloan Digital Sky Survey (SDSS-IV) project</a>. eBOSS data is now available at the <a class="reference external" href="https://archive.stsci.edu">Mikulski Archive for Space Telescopes (MAST)</a> through the <a class="reference external" href="https://archive.stsci.edu/missions-and-data/sdss">SDSS Legacy Archive at MAST</a>.</p>
<p>In this notebook tutorial, we will demonstrate how to access eBOSS data at MAST using Python. One eBOSS target, a quasar named “eBOSS 5733-56575-0260”, will be used to demonstrate the basics of how to download and plot eBOSS data. We will then combine this eBOSS spectrum with infrared spectra from JWST, also accessible from MAST, to study quasars at different redshifts.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<p>The main packages we’re using for this notebook and their use-cases are:</p>
<ul class="simple">
<li><p><em>astroquery.mast.Observations</em> for searching the MAST archive</p></li>
<li><p><em>astropy.io fits</em> for accessing FITS files</p></li>
<li><p><em>matplotlib</em> for plotting and displaying data</p></li>
<li><p><em>numpy</em> to handle array functions and basic math</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.io.fits</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fits</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogNorm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patheffects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">path_effects</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConnectionPatch</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>This cell updates some of the settings in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to use larger font sizes in the figures:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Update Plotting Parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> 
          <span class="s1">&#39;text.usetex&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="accessing-eboss-data-at-mast">
<h1>Accessing eBOSS data at MAST<a class="headerlink" href="#accessing-eboss-data-at-mast" title="Permalink to this heading">#</a></h1>
<p>The <a class="reference external" href="https://archive.stsci.edu/missions-and-data/sdss">SDSS Legacy Archive at MAST</a> hosts all of the science-ready data products from the <a class="reference external" href="https://www.sdss4.org/surveys/eboss/">SDSS-IV eBOSS Survey</a>, which includes optical-wavelength spectra for almost 4,000,000 targets in northern hemisphere, including stars, galaxies and quasi-stellar objects (QSOs). This notebook will demonstrate how to search and download eBOSS data using MAST!</p>
<section id="querying-all-eboss-data">
<h2>Querying all eBOSS data<a class="headerlink" href="#querying-all-eboss-data" title="Permalink to this heading">#</a></h2>
<p>Searching for eBOSS data is straightforward with <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code>. In this example, we use <code class="docutils literal notranslate"><span class="pre">Observations.query_criteria</span></code> and search for <code class="docutils literal notranslate"><span class="pre">provenance_name</span> <span class="pre">=</span> <span class="pre">'eBOSS'</span></code> (this is not case sensitive; <code class="docutils literal notranslate"><span class="pre">eboss</span></code> or <code class="docutils literal notranslate"><span class="pre">EBOSS</span></code> will also work). This will return a table describing all of the eBOSS data hosted by the MAST archive.</p>
<p>Other useful search parameters for eBOSS data might include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">obs_collection</span> <span class="pre">=</span> <span class="pre">'SDSS'</span></code>: searches for all SDSS data</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">target_name</span></code> to search for stars using their eBOSS identifiers, usually in the form <code class="docutils literal notranslate"><span class="pre">eBOSS</span> <span class="pre">{PLATE}-{MJD}-{FIBER}</span></code>, for example <code class="docutils literal notranslate"><span class="pre">eBOSS</span> <span class="pre">12547-58928-1</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">target_classification</span></code> provides basic information on what this target was indentified as (“QSO”, “STAR”, or “GALAXY”) in the eBOSS pipeline.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">obs_id</span></code> can help search for specific targets or fields. Note that wild cards (<code class="docutils literal notranslate"><span class="pre">*</span></code>) are allowed in the search fields, for example, <code class="docutils literal notranslate"><span class="pre">obs_id='sdss_eboss_12547-*'</span></code> will search for everything observed on the plate numbered 12547</p></li>
</ul>
<p>Here we also use the <code class="docutils literal notranslate"><span class="pre">pagesize=10</span></code> and <code class="docutils literal notranslate"><span class="pre">page=1</span></code> parameters to limit the number of results - otherwise, there are nearly 4,000,000 eBOSS observations in MAST! This query might take a few minutes to run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search for eBOSS data</span>
<span class="n">eboss_obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;eBOSS&#39;</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Display First Ten Entries in Table</span>
<span class="n">eboss_obs_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=10</i>
<table id="table140370345320656" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th></tr></thead>
<thead><tr><th>str7</th><th>str4</th><th>str5</th><th>str4</th><th>str4</th><th>str4</th><th>str7</th><th>str21</th><th>str6</th><th>str27</th><th>float64</th><th>float64</th><th>str8</th><th>str18</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str56</th><th>float64</th><th>str3</th><th>str1</th><th>int64</th><th>str56</th><th>str64</th><th>str64</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>str9</th></tr></thead>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 10759-58526-472</td><td>GALAXY</td><td>sdss_eboss_10759-58526-0472</td><td>210.23761</td><td>38.219295</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58523.37033564815</td><td>58526.410765162036</td><td>3600.41</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 210.23761 38.219295 0.0002777777777777778</td><td>mast:SDSS/eboss/10759/58526/0472/spec-image-10759-58526-0472.png</td><td>mast:SDSS/eboss/10759/58526/0472/full/spec-10759-58526-0472.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453725</td><td>723276475</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7106-56663-629</td><td>GALAXY</td><td>sdss_eboss_7106-56663-0629</td><td>177.22699</td><td>63.412626</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56661.5083912037</td><td>56663.529365393515</td><td>3600.36</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 177.22699 63.412626 0.0002777777777777778</td><td>mast:SDSS/eboss/7106/56663/0629/spec-image-7106-56663-0629.png</td><td>mast:SDSS/eboss/7106/56663/0629/full/spec-7106-56663-0629.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453726</td><td>723276476</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 8504-57518-500</td><td>QSO</td><td>sdss_eboss_8504-57518-0500</td><td>212.51298</td><td>41.311639</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>57518.236550925925</td><td>57518.26967662037</td><td>2700.24</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 212.51298 41.311639 0.0002777777777777778</td><td>mast:SDSS/eboss/8504/57518/0500/spec-image-8504-57518-0500.png</td><td>mast:SDSS/eboss/8504/57518/0500/full/spec-8504-57518-0500.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453727</td><td>723276477</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 10759-58526-515</td><td>GALAXY</td><td>sdss_eboss_10759-58526-0515</td><td>210.0848599999999</td><td>38.865988</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58523.37033564815</td><td>58526.410766203706</td><td>3600.41</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 210.0848599999999 38.865988 0.0002777777777777778</td><td>mast:SDSS/eboss/10759/58526/0515/spec-image-10759-58526-0515.png</td><td>mast:SDSS/eboss/10759/58526/0515/full/spec-10759-58526-0515.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453728</td><td>723276480</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7106-56663-592</td><td>QSO</td><td>sdss_eboss_7106-56663-0592</td><td>176.8872200000001</td><td>63.241869</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56661.5083912037</td><td>56663.529365393515</td><td>3600.36</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 176.8872200000001 63.241869 0.0002777777777777778</td><td>mast:SDSS/eboss/7106/56663/0592/spec-image-7106-56663-0592.png</td><td>mast:SDSS/eboss/7106/56663/0592/full/spec-7106-56663-0592.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453729</td><td>723276482</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 8504-57518-454</td><td>QSO</td><td>sdss_eboss_8504-57518-0454</td><td>212.96258</td><td>40.694892</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>57518.236550925925</td><td>57518.26967662037</td><td>2700.24</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 212.96258 40.694892 0.0002777777777777778</td><td>mast:SDSS/eboss/8504/57518/0454/spec-image-8504-57518-0454.png</td><td>mast:SDSS/eboss/8504/57518/0454/full/spec-8504-57518-0454.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453730</td><td>723276483</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 10759-58526-219</td><td>GALAXY</td><td>sdss_eboss_10759-58526-0219</td><td>211.51566</td><td>38.005862</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58523.37033564815</td><td>58526.410765162036</td><td>3600.41</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 211.51566 38.005862 0.0002777777777777778</td><td>mast:SDSS/eboss/10759/58526/0219/spec-image-10759-58526-0219.png</td><td>mast:SDSS/eboss/10759/58526/0219/full/spec-10759-58526-0219.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453731</td><td>723276486</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 7106-56663-42</td><td>GALAXY</td><td>sdss_eboss_7106-56663-0042</td><td>180.54139</td><td>61.697007</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56661.5083912037</td><td>56663.529364699076</td><td>3600.36</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 180.54139 61.697007 0.0002777777777777778</td><td>mast:SDSS/eboss/7106/56663/0042/spec-image-7106-56663-0042.png</td><td>mast:SDSS/eboss/7106/56663/0042/full/spec-7106-56663-0042.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453732</td><td>723276487</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 8504-57518-736</td><td>GALAXY</td><td>sdss_eboss_8504-57518-0736</td><td>214.14494</td><td>41.77965</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>57518.236550925925</td><td>57518.269677662036</td><td>2700.24</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 214.14494 41.77965 0.0002777777777777778</td><td>mast:SDSS/eboss/8504/57518/0736/spec-image-8504-57518-0736.png</td><td>mast:SDSS/eboss/8504/57518/0736/full/spec-8504-57518-0736.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453733</td><td>723276488</td></tr>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 10759-58526-171</td><td>GALAXY</td><td>sdss_eboss_10759-58526-0171</td><td>211.60794</td><td>37.92513</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>58523.37033564815</td><td>58526.410765162036</td><td>3600.41</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 211.60794 37.92513 0.0002777777777777778</td><td>mast:SDSS/eboss/10759/58526/0171/spec-image-10759-58526-0171.png</td><td>mast:SDSS/eboss/10759/58526/0171/full/spec-10759-58526-0171.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>243453734</td><td>723276489</td></tr>
</table></div></div></div>
</div>
</section>
<section id="searching-for-a-specific-target">
<h2>Searching for a specific target<a class="headerlink" href="#searching-for-a-specific-target" title="Permalink to this heading">#</a></h2>
<p>Let’s narrow down the search to look at one particular target: a high-redshift quasar (QSO) named “eBOSS 5733-56575-0260”. Quasars are a type of active galactic nuclei: supermassive black holes which are actively accreting material, producing bright spectra characterized by strong emission lines. Because quasars are so bright, they can be observed at large distances, which make them useful for studying the large-scale structure of the Universe and the most distant galaxies.</p>
<p>We can search for this quasar in particular using the <code class="docutils literal notranslate"><span class="pre">obs_id</span></code> keyword:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search for all QSOs</span>
<span class="n">eboss_obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;eBOSS&#39;</span><span class="p">,</span> <span class="c1"># Query eBOSS data</span>
                                             <span class="n">target_classification</span><span class="o">=</span><span class="s1">&#39;QSO&#39;</span><span class="p">,</span> <span class="c1"># Search for quasars</span>
                                             <span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;sdss_eboss_5733-56575-0260&#39;</span> <span class="c1"># Search for a specific target using obs_id</span>
                                             <span class="p">)</span>

<span class="c1"># Display results</span>
<span class="n">eboss_obs_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=1</i>
<table id="table140370345316432" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th></tr></thead>
<thead><tr><th>str7</th><th>str4</th><th>str5</th><th>str4</th><th>str4</th><th>str4</th><th>str7</th><th>str20</th><th>str3</th><th>str26</th><th>float64</th><th>float64</th><th>str8</th><th>str18</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str56</th><th>float64</th><th>str3</th><th>str1</th><th>int64</th><th>str48</th><th>str62</th><th>str62</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>str9</th></tr></thead>
<tr><td>science</td><td>SDSS</td><td>eBOSS</td><td>BOSS</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>eBOSS 5733-56575-260</td><td>QSO</td><td>sdss_eboss_5733-56575-0260</td><td>138.79167</td><td>47.949732</td><td>spectrum</td><td>SDSS Collaboration</td><td>3</td><td>56572.46884259259</td><td>56575.492721296294</td><td>5400.68</td><td>360.0</td><td>1040.0</td><td>Extended Baryon Oscillation Spectroscopic Survey (eBOSS)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 138.79167 47.949732 0.0002777777777777778</td><td>mast:SDSS/eboss/5733/56575/0260/spec-image-5733-56575-0260.png</td><td>mast:SDSS/eboss/5733/56575/0260/full/spec-5733-56575-0260.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>244396372</td><td>725334231</td></tr>
</table></div></div></div>
</div>
<p>From this results table, we can see some basic metadata related to this observation:</p>
<ul class="simple">
<li><p>It’s coordinates are in the <code class="docutils literal notranslate"><span class="pre">s_ra</span></code> and <code class="docutils literal notranslate"><span class="pre">s_dec</span></code> columns</p></li>
<li><p>This spectrum was observed using the BOSS instrument (<code class="docutils literal notranslate"><span class="pre">instrument_name</span></code>)</p></li>
<li><p>This target is classified as a QSO (<code class="docutils literal notranslate"><span class="pre">target_classification</span></code>)</p></li>
<li><p>From the <code class="docutils literal notranslate"><span class="pre">t_min</span></code> column, we can see that this star was first observed on the date of MJD 56572 (Correpsonding to 2013-10-07) and last observed on MJD 56575 (2013-10-10)</p></li>
<li><p>eBOSS provides optical-wavelength (<code class="docutils literal notranslate"><span class="pre">wavelength_region</span></code>) spectra (<code class="docutils literal notranslate"><span class="pre">dataproduct_type</span></code>) with wavelength range of 360.0 - 1040.0 nanometers (<code class="docutils literal notranslate"><span class="pre">em_min</span></code>, <code class="docutils literal notranslate"><span class="pre">em_max</span></code>)</p></li>
</ul>
</section>
<section id="downloading-eboss-data-products">
<h2>Downloading eBOSS data products<a class="headerlink" href="#downloading-eboss-data-products" title="Permalink to this heading">#</a></h2>
<p>List all of the data products availble for this observation using <code class="docutils literal notranslate"><span class="pre">Observations.get_product_list()</span></code>.</p>
<p>There are 3 total files available for this quasar, which includes the “full spectrum” file, the “lite spectrum” file, and a preview image. Only the full spectrum is tagged as “Minimum Recommended Products”. More information on the eBOSS data products available at MAST can be found on the <a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/eBOSS+Data+Products">eBOSS Data Products</a> in the Archive Manual, and more information on all of these products can be seen in the search results table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List all products available for this observation</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">eboss_obs_list</span><span class="p">)</span>

<span class="c1"># Show table</span>
<span class="n">products</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=5</i>
<table id="table140370345313232" class="table-striped table-bordered table-condensed">
<thead><tr><th>obsID</th><th>obs_collection</th><th>dataproduct_type</th><th>obs_id</th><th>description</th><th>type</th><th>dataURI</th><th>productType</th><th>productGroupDescription</th><th>productSubGroupDescription</th><th>productDocumentationURL</th><th>project</th><th>prvversion</th><th>proposal_id</th><th>productFilename</th><th>size</th><th>parent_obsid</th><th>dataRights</th><th>calib_level</th><th>filters</th></tr></thead>
<thead><tr><th>str9</th><th>str4</th><th>str12</th><th>str29</th><th>str235</th><th>str1</th><th>str67</th><th>str7</th><th>str28</th><th>str14</th><th>str48</th><th>str5</th><th>str7</th><th>str3</th><th>str30</th><th>int64</th><th>str9</th><th>str6</th><th>int64</th><th>str4</th></tr></thead>
<tr><td>244396372</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_5733-56575-0260</td><td>Preview-Full</td><td>S</td><td>mast:SDSS/eboss/5733/56575/0260/spec-image-5733-56575-0260.png</td><td>PREVIEW</td><td>--</td><td>--</td><td>--</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-image-5733-56575-0260.png</td><td>39826</td><td>244396372</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244396372</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_5733-56575-0260</td><td>SDSS eBOSS lite spectrum file containing the combined spectrum and associated metadata but not the individual exposures.</td><td>S</td><td>mast:SDSS/eboss/5733/56575/0260/lite/spec-lite-5733-56575-0260.fits</td><td>SCIENCE</td><td>--</td><td>SPECTRA</td><td>https://archive.stsci.edu/missions-and-data/sdss</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-lite-5733-56575-0260.fits</td><td>218880</td><td>244396372</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>244396372</td><td>SDSS</td><td>spectrum</td><td>sdss_eboss_5733-56575-0260</td><td>SDSS eBOSS full spectrum file containing the combined spectrum, associated metadata, and the individual exposures.</td><td>S</td><td>mast:SDSS/eboss/5733/56575/0260/full/spec-5733-56575-0260.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>SPECTRA</td><td>https://archive.stsci.edu/missions-and-data/sdss</td><td>eBOSS</td><td>DR17</td><td>N/A</td><td>spec-5733-56575-0260.fits</td><td>1514880</td><td>244396372</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>252284571</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spzall_5733-56575</td><td>SDSS eBOSS summary catalog, for each plate-MJD, containing the best fits for spectral redshift and classification measurements, rank-ordered by chi-squared. If the best fit looks bad from the spAll file, check the second best fit here.</td><td>D</td><td>mast:SDSS/eboss/5733/56575/spZall-5733-56575.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://archive.stsci.edu/missions-and-data/sdss</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spZall-5733-56575.fits</td><td>128540160</td><td>244396372</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>252284572</td><td>SDSS</td><td>measurements</td><td>sdss_eboss_spplate_5733-56575</td><td>SDSS eBOSS summary catalog, for each plate-MJD, containing the combined spectra and targeting information for all observations on a single plate.</td><td>D</td><td>mast:SDSS/eboss/5733/56575/spPlate-5733-56575.fits</td><td>SCIENCE</td><td>--</td><td>eBOSS Catalogs</td><td>https://archive.stsci.edu/missions-and-data/sdss</td><td>eBOSS</td><td>v5_13_2</td><td>N/A</td><td>spPlate-5733-56575.fits</td><td>112003200</td><td>244396372</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
</table></div></div></div>
</div>
<p>Now we will download the spectrum for this quasar using <code class="docutils literal notranslate"><span class="pre">Observations.download_products()</span></code>. The download will print a status message when completed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/5733/56575/0260/full/spec-5733-56575-0260.fits to ./mastDownload/SDSS/sdss_eboss_5733-56575-0260/spec-5733-56575-0260.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="plotting-an-eboss-spectrum">
<h1>Plotting an eBOSS Spectrum<a class="headerlink" href="#plotting-an-eboss-spectrum" title="Permalink to this heading">#</a></h1>
<p>Now let’s take a look at the file and plot the spectrum.</p>
<p>Based on the descriptions in the <a class="reference external" href="https://data.sdss.org/datamodel/files/BOSS_SPECTRO_REDUX/RUN2D/spectra/PLATE4/spec.html">eBOSS Spectrum Data Model</a>, this file has several extensions, corresponding to the metadata, the co-added spectrum, some catalog information, and the individual visit exposures:</p>
<ul class="simple">
<li><p>HDU0: “PRIMARY”: The Primary Header and file metadata</p></li>
<li><p>HDU1: “COADD”: The array containing the coadded observed spectrum</p></li>
<li><p>HDU2: “SPALL”: Summary metadata about this target, including targeting information, spectroscopic classifications, and redshifts for this target</p></li>
<li><p>HDU3: “SPZLINE”: Line fitting metadata about the target: contains measurements of emission lines and redshift output from the SDSS Spectro-1D analysis pipeline.</p></li>
<li><p>HDU4+ : The rest of the file extensions contain the individual frames from each exposure that went into the coadded spectrum: “B” for the blue chip and “R” for the red chip of each exposure.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open file</span>
<span class="n">eboss_spectrum</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Display file information</span>
<span class="n">eboss_spectrum</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: ./mastDownload/SDSS/sdss_eboss_5733-56575-0260/spec-5733-56575-0260.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     129   ()      
  1  COADD         1 BinTableHDU     26   4628R x 8C   [E, E, E, J, J, E, E, E]   
  2  SPALL         1 BinTableHDU    488   1R x 236C   [27A, 14A, 4A, E, E, J, J, E, J, E, E, E, K, K, K, K, K, K, K, K, K, B, B, J, I, 5E, 5E, J, J, J, J, 7A, 7A, 16A, D, D, 6A, 21A, E, E, E, J, E, 24A, 10J, J, 10E, E, E, E, E, E, E, J, E, E, E, J, 5E, E, E, 10E, 10E, 10E, 5E, 5E, 5E, 5E, 5E, J, J, E, E, E, E, E, E, 16A, 9A, 12A, E, E, E, E, E, E, E, E, J, E, E, J, J, 6A, 21A, E, 35E, K, 19A, 19A, 19A, B, B, B, I, 3A, B, I, I, I, I, J, E, J, J, E, E, E, E, E, E, E, E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5J, 5J, 5J, 5E, 5J, 75E, 75E, 5E, 5E, 5E, 5J, 5E, D, D, D, D, D, D, D, D, D, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 5E, 40E, 40E, 5J, 5J, 5E, 5E, 5D, J, J, J, J, J, J, J, E]   
  3  SPZLINE       1 BinTableHDU     48   32R x 19C   [J, J, J, 13A, D, E, E, E, E, E, E, E, E, E, E, J, J, E, E]   
  4  B1-00167523-00167522-00167521    1 BinTableHDU    181   2516R x 8C   [E, E, E, J, E, E, E, E]   
  5  B1-00167524-00167522-00167521    1 BinTableHDU    181   2516R x 8C   [E, E, E, J, E, E, E, E]   
  6  B1-00167695-00167694-00167693    1 BinTableHDU    181   2516R x 8C   [E, E, E, J, E, E, E, E]   
  7  B1-00167696-00167694-00167693    1 BinTableHDU    181   2516R x 8C   [E, E, E, J, E, E, E, E]   
  8  B1-00167697-00167694-00167693    1 BinTableHDU    181   2516R x 8C   [E, E, E, J, E, E, E, E]   
  9  B1-00167762-00167761-00167760    1 BinTableHDU    181   2515R x 8C   [E, E, E, J, E, E, E, E]   
 10  R1-00167523-00167522-00167521    1 BinTableHDU    181   3129R x 8C   [E, E, E, J, E, E, E, E]   
 11  R1-00167524-00167522-00167521    1 BinTableHDU    181   3130R x 8C   [E, E, E, J, E, E, E, E]   
 12  R1-00167695-00167694-00167693    1 BinTableHDU    181   3126R x 8C   [E, E, E, J, E, E, E, E]   
 13  R1-00167696-00167694-00167693    1 BinTableHDU    181   3128R x 8C   [E, E, E, J, E, E, E, E]   
 14  R1-00167697-00167694-00167693    1 BinTableHDU    181   3128R x 8C   [E, E, E, J, E, E, E, E]   
 15  R1-00167762-00167761-00167760    1 BinTableHDU    181   3123R x 8C   [E, E, E, J, E, E, E, E]   
</pre></div>
</div>
</div>
</div>
<p>We can plot the spectrum using this information! The wavelength and flux data are all found in the first extension (HDU1: “COADD”).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Define wavelengths</span>
<span class="c1"># eBOSS wavelengths are in log space - convert to linear</span>
<span class="n">wls</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;loglam&#39;</span><span class="p">]</span>

<span class="c1"># Get the observed and model flux from extension 1</span>
<span class="n">observed_flux</span> <span class="o">=</span> <span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span>
<span class="n">model_flux</span> <span class="o">=</span> <span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>

<span class="c1"># Plot the observed spectrum</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">observed_flux</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed Spectrum&#39;</span><span class="p">)</span>
<span class="c1"># Plot the model spectrum</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">model_flux</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model Spectrum&#39;</span><span class="p">)</span>

<span class="c1"># Set title and labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">eboss_obs_list</span><span class="p">[</span><span class="s1">&#39;target_name&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">redshift</span> <span class="o">=</span> <span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># redshift from SPALL table</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;z = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">redshift</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="c1"># Add grid lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span> <span class="c1"># Add plot legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># Display plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/2d1cc98727a32f4847060c6a851ef45f22bf27370f324138c10f08c54b9bef4b.png" src="../../../_images/2d1cc98727a32f4847060c6a851ef45f22bf27370f324138c10f08c54b9bef4b.png" />
</div>
</div>
<p>The eBOSS spectrum for this QSO looks great! The large spikes around 5200, 6700, and 8200 angstroms are strong emission lines from the accretion disk around the supermassive black hole in the center of this QSO. We can identify which emission lines they are by using the quasar’s redshift, which we will do next.</p>
<section id="identifying-emission-lines-in-a-qso-spectrum">
<h2>Identifying Emission Lines in a QSO Spectrum<a class="headerlink" href="#identifying-emission-lines-in-a-qso-spectrum" title="Permalink to this heading">#</a></h2>
<p>Let’s spruce up this plot by adding labels on the emission lines, and plotting a second panel which shows the brightness (flux) as color instead of a line.</p>
<p>To help with identifying the emision lines, let’s write a helper function to define and plot the emission lines we want to label, called <code class="docutils literal notranslate"><span class="pre">plot_emission_lines()</span></code>. Becasue this quasar is so far away, the emission lines will be redshifted, meaning the observed wavelength might be far away from the rest wavelength!</p>
<p>The equation for calculating the observed wavelength of an emission line at redshift <span class="math notranslate nohighlight">\(z\)</span> is:</p>
<p>\begin{equation}
1+z = \frac{\lambda_{observed}}{\lambda_{emitted}}
\end{equation}</p>
<p>where <span class="math notranslate nohighlight">\(\lambda_{emitted}\)</span> is the rest-frame wavelength of the emission line, and  <span class="math notranslate nohighlight">\(z\)</span> is the redshift. We will use this equation to convert between rest wavelength and observed wavelength in our helper function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a dictionary of emission lines we want to label</span>
<span class="c1"># These line definitions are from the eBOSS pipeline: https://data.sdss.org/datamodel/files/SPECTRO_REDUX/RUN2D/PLATE4/spZline.html</span>
<span class="n">emission_line_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;emline&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Lyman-$\alpha$&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rest_wavelength&#39;</span><span class="p">:</span> <span class="mf">1215.67</span><span class="p">,</span>
        <span class="s1">&#39;label_color&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span>
        <span class="s1">&#39;label_index&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
        <span class="s1">&#39;label_angle&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;emline&#39;</span><span class="p">:</span> <span class="s1">&#39;C IV&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rest_wavelength&#39;</span><span class="p">:</span> <span class="mf">1549.487</span><span class="p">,</span>
        <span class="s1">&#39;label_color&#39;</span><span class="p">:</span> <span class="s1">&#39;mediumblue&#39;</span><span class="p">,</span>
        <span class="s1">&#39;label_index&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
        <span class="s1">&#39;label_angle&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;emline&#39;</span><span class="p">:</span> <span class="s1">&#39;[C III]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rest_wavelength&#39;</span><span class="p">:</span> <span class="mf">1908.734</span><span class="p">,</span>
        <span class="s1">&#39;label_color&#39;</span><span class="p">:</span> <span class="s1">&#39;deepskyblue&#39;</span><span class="p">,</span>
        <span class="s1">&#39;label_index&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
        <span class="s1">&#39;label_angle&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;emline&#39;</span><span class="p">:</span> <span class="s1">&#39;Mg II&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rest_wavelength&#39;</span><span class="p">:</span> <span class="mf">2800.31518862</span><span class="p">,</span>
        <span class="s1">&#39;label_color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
        <span class="s1">&#39;label_index&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s1">&#39;label_angle&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;emline&#39;</span><span class="p">:</span> <span class="s1">&#39;[O III]&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rest_wavelength&#39;</span><span class="p">:</span> <span class="mf">5008.23966962</span><span class="p">,</span>
        <span class="s1">&#39;label_color&#39;</span><span class="p">:</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">,</span>
        <span class="s1">&#39;label_index&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;label_angle&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;emline&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;H-$\alpha$&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rest_wavelength&#39;</span><span class="p">:</span> <span class="mf">6564.61397371</span><span class="p">,</span>
        <span class="s1">&#39;label_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
        <span class="s1">&#39;label_index&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;label_angle&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_emission_lines</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">redshift</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to plot emission line references on a figure.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ============</span>
<span class="sd">    ax: </span>
<span class="sd">        The axes object to draw on</span>
<span class="sd">    redshift:</span>
<span class="sd">        the redshift (z) of the QSO which determines how much to shift the lines</span>
<span class="sd">        from the rest wavelength to the observed wavelength.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="c1"># Plot and Label the emission lines</span>
    <span class="k">for</span> <span class="n">emline</span> <span class="ow">in</span> <span class="n">emission_line_list</span><span class="p">:</span>
        <span class="c1"># Calculate observed wavelength from quasar redshift</span>
        <span class="n">observed_wavelength</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">redshift</span><span class="p">)</span><span class="o">*</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;rest_wavelength&#39;</span><span class="p">]</span>
        <span class="c1"># If the observed wavelength is within the limits of the plot, plot it!</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">observed_wavelength</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wls</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">observed_wavelength</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">wls</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">observed_wavelength</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">observed_wavelength</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">observed_wavelength</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="n">emline</span><span class="p">[</span><span class="s1">&#39;emline&#39;</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis_transform</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>In the next cell, we plot the spectrum again adding these new features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up spectrum plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Open spectrum file</span>
<span class="n">eboss_spectrum</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># Define QSO name</span>
<span class="n">eboss_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;PLATEID&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FIBERID&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># Retrieve redshift from SPALL table</span>
<span class="n">redshift</span> <span class="o">=</span> <span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 

<span class="c1"># Define wavelengths</span>
<span class="n">wls</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;loglam&#39;</span><span class="p">]</span>
<span class="c1"># Get the observed and model flux from extension 1</span>
<span class="n">observed_flux</span> <span class="o">=</span> <span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span>
<span class="n">model_flux</span> <span class="o">=</span> <span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>


<span class="c1"># Plot the observed spectrum</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">observed_flux</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed Spectrum&#39;</span><span class="p">)</span>
<span class="c1"># Plot the model spectrum</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">model_flux</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model Spectrum&#39;</span><span class="p">)</span>
<span class="c1"># Normalize the flux for the colobar</span>
<span class="n">normalized_flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">model_flux</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">model_flux</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">normalized_flux</span><span class="p">,</span> <span class="n">normalized_flux</span><span class="p">],</span>
               <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>

<span class="c1"># Plot emission lines</span>
<span class="n">plot_emission_lines</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">redshift</span><span class="p">)</span>

<span class="c1"># Set title and labels</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;eBOSS spectrum - </span><span class="si">{</span><span class="n">eboss_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Add redshift to plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;z = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">redshift</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flux&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="c1"># Add grid lines</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span> <span class="c1"># Add plot legend</span>
<span class="c1"># Set axes limits</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wls</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">wls</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wls</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">wls</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">observed_flux</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># remove space between plots</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># Display Plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ead1b648b092122e95b099261baace48518bf60548666ed2f55fa4e2157fd88c.png" src="../../../_images/ead1b648b092122e95b099261baace48518bf60548666ed2f55fa4e2157fd88c.png" />
</div>
</div>
<p>The top panel of our figure shows the spectrum as a line plot, where the bottom panel shows it as a color plot. The higher the flux is in the top panel, the brighter yellow color it is in the bottom panel: two different ways of looking at the same spectrum. With this plot, we can see that the three brightest emission lines in this QSO are Lyman-<span class="math notranslate nohighlight">\(\alpha\)</span>, C IV and [C III]!</p>
</section>
<section id="exploring-qso-spectra-at-different-redshift">
<h2>Exploring QSO spectra at different redshift<a class="headerlink" href="#exploring-qso-spectra-at-different-redshift" title="Permalink to this heading">#</a></h2>
<p>Now that we’ve demonstrated how to search, download, and plot a quasar spectrum from eBOSS, let’s repeat this process and look at several QSOs across cosmic time. Our goal is to explore how different characteristics of quasar spectra evolve over time, from the closest to us (low redshift) to farthest away (high redshift).</p>
<p>Here is a list of eBOSS QSOs from a sampling of different redshifts curated for this exercise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eboss_qso_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0063&#39;</span><span class="p">,</span> <span class="c1"># redshift z = 0.25</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0268&#39;</span><span class="p">,</span> <span class="c1"># redshift z = 0.49</span>
    <span class="s1">&#39;sdss_eboss_3846-55327-0212&#39;</span><span class="p">,</span> <span class="c1"># z = 0.71</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0707&#39;</span><span class="p">,</span> <span class="c1"># z = 1.0</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0771&#39;</span><span class="p">,</span> <span class="c1"># z = 1.23</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0178&#39;</span><span class="p">,</span> <span class="c1"># z = 1.49</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0349&#39;</span><span class="p">,</span> <span class="c1"># z =  1.75</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0029&#39;</span><span class="p">,</span> <span class="c1"># z = 2.04</span>
    <span class="s1">&#39;sdss_eboss_3586-55181-0080&#39;</span><span class="p">,</span> <span class="c1"># z = 2.25</span>
    <span class="s1">&#39;sdss_eboss_3586-55181-0162&#39;</span><span class="p">,</span> <span class="c1"># z = 2.48</span>
    <span class="s1">&#39;sdss_eboss_3586-55181-0516&#39;</span><span class="p">,</span> <span class="c1"># z = 2.75</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0478&#39;</span><span class="p">,</span> <span class="c1"># z = 2.97</span>
    <span class="s1">&#39;sdss_eboss_3788-55246-0056&#39;</span><span class="p">,</span> <span class="c1"># z = 3.26</span>
    <span class="s1">&#39;sdss_eboss_3846-55327-0080&#39;</span><span class="p">,</span> <span class="c1"># z =  3.49</span>
    <span class="s1">&#39;sdss_eboss_12547-58928-0484&#39;</span><span class="p">,</span> <span class="c1"># z = 3.73</span>
    <span class="s1">&#39;sdss_eboss_10737-58254-0984&#39;</span><span class="p">,</span> <span class="c1"># z = 3.99</span>
    <span class="s1">&#39;sdss_eboss_7238-56660-0542&#39;</span><span class="p">,</span> <span class="c1"># z = 4.27</span>
    <span class="s1">&#39;sdss_eboss_8789-57358-0092&#39;</span><span class="p">,</span> <span class="c1"># z = 4.5 </span>
    <span class="s1">&#39;sdss_eboss_3588-55184-0548&#39;</span><span class="p">,</span> <span class="c1"># z = 4.71</span>
    <span class="s1">&#39;sdss_eboss_8528-57896-0104&#39;</span><span class="p">,</span> <span class="c1"># z = 5.00</span>
    <span class="s1">&#39;sdss_eboss_10256-58193-0330&#39;</span><span class="p">,</span> <span class="c1"># z = 5.26</span>
    <span class="s1">&#39;sdss_eboss_6782-56602-0526&#39;</span><span class="p">,</span> <span class="c1"># z = 5.48</span>
    <span class="s1">&#39;sdss_eboss_11315-58402-0842&#39;</span><span class="p">,</span> <span class="c1"># z = 5.76</span>
    <span class="s1">&#39;sdss_eboss_6667-56412-0676&#39;</span><span class="p">,</span> <span class="c1"># z = 6</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>For each of these quasars, we will download the spectra using <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code> and plot them as a color plot like we did before. Only this time, we are going to plot them all on the same figure to see how quasar spectra change over redshift!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_eboss_qso_spectrum</span><span class="p">(</span><span class="n">eboss_obs_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given an eBOSS observation ID, query MAST and download the spectrum using astroquery.mast</span>

<span class="sd">    Parameters:</span>
<span class="sd">    =============</span>
<span class="sd">    eboss_obs_id: str</span>
<span class="sd">        Name of the target / observation ID to search on.</span>

<span class="sd">    Returns:</span>
<span class="sd">    =============</span>
<span class="sd">    dictionary of...    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Query MAST for eBOSS observation</span>
    <span class="n">obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;eBOSS&#39;</span><span class="p">,</span> <span class="c1"># Query eBOSS data</span>
                                           <span class="n">obs_id</span><span class="o">=</span><span class="n">eboss_obs_id</span><span class="p">)</span> <span class="c1"># Search for a specific target</span>
    
    <span class="c1"># Retrieve products</span>
    <span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs_list</span><span class="p">)</span>
    <span class="c1"># Download spectrum file</span>
    <span class="n">manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">eboss_spectrum</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># redshift from SPALL table</span>
    <span class="n">wls</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;loglam&#39;</span><span class="p">]</span>
    <span class="n">model_flux</span> <span class="o">=</span> <span class="n">eboss_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
    <span class="n">normalized_flux</span> <span class="o">=</span> <span class="n">model_flux</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">model_flux</span><span class="p">)</span>
    
    <span class="c1"># Define a dictionary with the spectrum and other information we want to save</span>
    <span class="n">qso_spec</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span>  <span class="sa">f</span><span class="s2">&quot;eBOSS </span><span class="si">{</span><span class="n">eboss_obs_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spectrum_filename&quot;</span><span class="p">:</span> <span class="n">manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">],</span>
        <span class="s2">&quot;redshift&quot;</span><span class="p">:</span> <span class="n">z</span><span class="p">,</span>
        <span class="s2">&quot;wls&quot;</span><span class="p">:</span> <span class="n">wls</span><span class="p">,</span>
        <span class="s2">&quot;flux&quot;</span><span class="p">:</span> <span class="n">normalized_flux</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">qso_spec</span>    


<span class="n">all_qsos</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_eboss_qso_spectrum</span><span class="p">(</span><span class="n">obs_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">obs_id</span> <span class="ow">in</span> <span class="n">eboss_qso_list</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0063/full/spec-12547-58928-0063.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0063/spec-12547-58928-0063.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0268/full/spec-12547-58928-0268.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0268/spec-12547-58928-0268.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/3846/55327/0212/full/spec-3846-55327-0212.fits to ./mastDownload/SDSS/sdss_eboss_3846-55327-0212/spec-3846-55327-0212.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0707/full/spec-12547-58928-0707.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0707/spec-12547-58928-0707.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0771/full/spec-12547-58928-0771.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0771/spec-12547-58928-0771.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0178/full/spec-12547-58928-0178.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0178/spec-12547-58928-0178.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0349/full/spec-12547-58928-0349.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0349/spec-12547-58928-0349.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0029/full/spec-12547-58928-0029.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0029/spec-12547-58928-0029.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/3586/55181/0080/full/spec-3586-55181-0080.fits to ./mastDownload/SDSS/sdss_eboss_3586-55181-0080/spec-3586-55181-0080.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/3586/55181/0162/full/spec-3586-55181-0162.fits to ./mastDownload/SDSS/sdss_eboss_3586-55181-0162/spec-3586-55181-0162.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/3586/55181/0516/full/spec-3586-55181-0516.fits to ./mastDownload/SDSS/sdss_eboss_3586-55181-0516/spec-3586-55181-0516.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0478/full/spec-12547-58928-0478.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0478/spec-12547-58928-0478.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/3788/55246/0056/full/spec-3788-55246-0056.fits to ./mastDownload/SDSS/sdss_eboss_3788-55246-0056/spec-3788-55246-0056.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/3846/55327/0080/full/spec-3846-55327-0080.fits to ./mastDownload/SDSS/sdss_eboss_3846-55327-0080/spec-3846-55327-0080.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/12547/58928/0484/full/spec-12547-58928-0484.fits to ./mastDownload/SDSS/sdss_eboss_12547-58928-0484/spec-12547-58928-0484.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/10737/58254/0984/full/spec-10737-58254-0984.fits to ./mastDownload/SDSS/sdss_eboss_10737-58254-0984/spec-10737-58254-0984.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/7238/56660/0542/full/spec-7238-56660-0542.fits to ./mastDownload/SDSS/sdss_eboss_7238-56660-0542/spec-7238-56660-0542.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/8789/57358/0092/full/spec-8789-57358-0092.fits to ./mastDownload/SDSS/sdss_eboss_8789-57358-0092/spec-8789-57358-0092.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/3588/55184/0548/full/spec-3588-55184-0548.fits to ./mastDownload/SDSS/sdss_eboss_3588-55184-0548/spec-3588-55184-0548.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/8528/57896/0104/full/spec-8528-57896-0104.fits to ./mastDownload/SDSS/sdss_eboss_8528-57896-0104/spec-8528-57896-0104.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/10256/58193/0330/full/spec-10256-58193-0330.fits to ./mastDownload/SDSS/sdss_eboss_10256-58193-0330/spec-10256-58193-0330.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/6782/56602/0526/full/spec-6782-56602-0526.fits to ./mastDownload/SDSS/sdss_eboss_6782-56602-0526/spec-6782-56602-0526.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/11315/58402/0842/full/spec-11315-58402-0842.fits to ./mastDownload/SDSS/sdss_eboss_11315-58402-0842/spec-11315-58402-0842.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:SDSS/eboss/6667/56412/0676/full/spec-6667-56412-0676.fits to ./mastDownload/SDSS/sdss_eboss_6667-56412-0676/spec-6667-56412-0676.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="k">for</span> <span class="n">qso</span> <span class="ow">in</span> <span class="n">all_qsos</span><span class="p">:</span>
    <span class="c1"># Round to nearest 0.25 in redshift just to align things on a grid</span>
    <span class="n">nearest_redshift</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;redshift&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">nearest_redshift</span><span class="o">-</span><span class="mf">0.065</span><span class="p">,</span> <span class="n">nearest_redshift</span><span class="o">+</span><span class="mf">0.065</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">],</span> <span class="n">qso</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>

<span class="c1"># Label emission lines</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">emline</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">emission_line_list</span><span class="p">):</span>
    <span class="c1"># Outline the emission lines</span>
    <span class="n">all_redshifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;redshift&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">qso</span> <span class="ow">in</span> <span class="n">all_qsos</span><span class="p">])</span>
    <span class="n">wavelength_obs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">all_redshifts</span><span class="p">)</span><span class="o">*</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;rest_wavelength&#39;</span><span class="p">]</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wavelength_obs</span><span class="p">,</span> <span class="n">all_redshifts</span><span class="p">,</span>
                         <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span>
                         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">points</span><span class="o">.</span><span class="n">set_path_effects</span><span class="p">([</span><span class="n">path_effects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)])</span>
    
    <span class="c1"># Add connecting lines</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wavelength_obs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">9800</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3590</span><span class="p">)):</span>
            <span class="n">cp</span> <span class="o">=</span> <span class="n">ConnectionPatch</span><span class="p">((</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">all_redshifts</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="p">(</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">all_redshifts</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> 
                                 <span class="n">coordsA</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">coordsB</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">axesA</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">axesB</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                 <span class="n">color</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span>
                                 <span class="n">shrinkA</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">cp</span><span class="o">.</span><span class="n">set_path_effects</span><span class="p">([</span><span class="n">path_effects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>

    <span class="c1"># Add text for line labels</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_index&#39;</span><span class="p">]],</span> <span class="n">all_redshifts</span><span class="p">[</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_index&#39;</span><span class="p">]]</span><span class="o">+</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">emline</span><span class="p">[</span><span class="s1">&#39;emline&#39;</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_angle&#39;</span><span class="p">])</span>
    <span class="c1"># Add white border for readability</span>
    <span class="n">text</span><span class="o">.</span><span class="n">set_path_effects</span><span class="p">([</span><span class="n">path_effects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)])</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">3596</span><span class="p">,</span> <span class="mi">10310</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Redshift (z)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;eBOSS spectra of QSOs&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fae659c53bfd4023ef6321d70eef5bdaadd94528af7a91226db6f073adfb9f19.png" src="../../../_images/fae659c53bfd4023ef6321d70eef5bdaadd94528af7a91226db6f073adfb9f19.png" />
</div>
</div>
<p>This plot shows 24 different eBOSS spectra in one figure, going from low-reshift (z=0.25) to high-redshift (z=6)! The emission lines are visible in every spectrum, and this figure shows how distance shifts the emissions lines into longer and longer wavelengths! Studying quasars has a broad range of use in astronomical research: because quasars are so luminous, they can be observed at very high redshift and can give scientists insight into distant reaches of the Universe.</p>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="searching-for-high-redshift-jwst-spectra">
<h1>Searching for High-Redshift JWST spectra<a class="headerlink" href="#searching-for-high-redshift-jwst-spectra" title="Permalink to this heading">#</a></h1>
<p>The quasar plot we made with eBOSS spectra is great, but let’s push our quasar sample into even higher redshift quasars by using JWST. JWST is an infrared telescope which observes in longer wavelengths than eBOSS (although there is some overlap between them), making it perfect for observing extremely high redshift galaxies.</p>
<p>Here is a list of three high-redshift QSOs that have been observed with the NIRSPEC instrument, as part of <a class="reference external" href="https://www.stsci.edu/jwst-program-info/program/?program=1222">JWST Program GO 1222</a>:</p>
<ul class="simple">
<li><p>VDES J0020–3653 (z = 6.860)</p></li>
<li><p>DELS J0411–0907 (z = 6.825)</p></li>
<li><p>UHS J0439+1634 (z = 6.519)</p></li>
</ul>
<p>Let’s add these galaxies to our eBOSS plot, to extend our sample to even higher redshift!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search for JWST data</span>
<span class="n">jwst_obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_collection</span><span class="o">=</span><span class="s1">&#39;JWST&#39;</span><span class="p">,</span> <span class="c1"># Search for JWST data</span>
                                            <span class="n">proposal_id</span><span class="o">=</span><span class="s1">&#39;1222&#39;</span><span class="p">,</span> <span class="c1"># Search based on program ID</span>
                                            <span class="n">dataproduct_type</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="c1"># Limit search to spectra</span>
                                            <span class="p">)</span>

<span class="c1"># Print lenght of results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jwst_obs_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> results!&quot;</span><span class="p">)</span>

<span class="c1"># Display first 5 results</span>
<span class="n">jwst_obs_list</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 238 results!
</pre></div>
</div>
<div class="output text_html"><div><i>Table masked=True length=5</i>
<table id="table140370339512272" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th></tr></thead>
<thead><tr><th>str7</th><th>str4</th><th>str7</th><th>str12</th><th>str4</th><th>str12</th><th>str8</th><th>str26</th><th>str39</th><th>str58</th><th>float64</th><th>float64</th><th>str8</th><th>str17</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str80</th><th>float64</th><th>str4</th><th>str3</th><th>int64</th><th>str111</th><th>str84</th><th>str85</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>str9</th></tr></thead>
<tr><td>science</td><td>JWST</td><td>CALJWST</td><td>NIRSPEC/SLIT</td><td>JWST</td><td>F170LP;G235H</td><td>INFRARED</td><td>UHSJ0439+1634</td><td>Galaxy; High-redshift galaxies; Quasars</td><td>jw01222-o011_s000000001_nirspec_f170lp-g235h-s200a1</td><td>69.94621666666667</td><td>16.571033333333332</td><td>spectrum</td><td>Willott, Chris J.</td><td>3</td><td>59968.23952844908</td><td>59968.31842642361</td><td>2844.834</td><td>1660.0</td><td>5000.0</td><td>Cosmic reionization, metal enrichment and host galaxies from quasar spectroscopy</td><td>60333.76431704</td><td>1222</td><td>GTO</td><td>--</td><td>POLYGON 69.945797828 16.571689339 69.946628685 16.571689339 69.946628685 16.570355748 69.945797828 16.570355748</td><td>mast:JWST/product/jw01222-o011_s000000001_nirspec_f170lp-g235h-s200a1_cal.jpg</td><td>mast:JWST/product/jw01222-o011_s000000001_nirspec_f170lp-g235h-s200a1_s2d.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232625998</td><td>741717564</td></tr>
<tr><td>science</td><td>JWST</td><td>CALJWST</td><td>NIRSPEC/SLIT</td><td>JWST</td><td>F070LP;G140H</td><td>INFRARED</td><td>UHSJ0439+1634</td><td>Galaxy; High-redshift galaxies; Quasars</td><td>jw01222-o011_s000000012_nirspec_f070lp-g140h-s200a2</td><td>69.94621666666667</td><td>16.571033333333332</td><td>spectrum</td><td>Willott, Chris J.</td><td>3</td><td>59968.23952844908</td><td>59968.27992793982</td><td>2844.834</td><td>700.0</td><td>5000.0</td><td>Cosmic reionization, metal enrichment and host galaxies from quasar spectroscopy</td><td>60333.76431704</td><td>1222</td><td>GTO</td><td>--</td><td>POLYGON 69.941442355 16.575358927 69.942289416 16.575358927 69.942289416 16.574003292 69.941442355 16.574003292</td><td>mast:JWST/product/jw01222-o011_s000000012_nirspec_f070lp-g140h-s200a2_cal.jpg</td><td>mast:JWST/product/jw01222-o011_s000000012_nirspec_f070lp-g140h-s200a2_s2d.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232629349</td><td>741717578</td></tr>
<tr><td>science</td><td>JWST</td><td>CALJWST</td><td>NIRSPEC/SLIT</td><td>JWST</td><td>F170LP;G235H</td><td>INFRARED</td><td>UHSJ0439+1634</td><td>Galaxy; High-redshift galaxies; Quasars</td><td>jw01222-o011_s000000015_nirspec_f170lp-g235h-s200b1</td><td>69.94621666666667</td><td>16.571033333333332</td><td>spectrum</td><td>Willott, Chris J.</td><td>3</td><td>59968.23952844908</td><td>59968.31842642361</td><td>2844.834</td><td>1660.0</td><td>5000.0</td><td>Cosmic reionization, metal enrichment and host galaxies from quasar spectroscopy</td><td>60333.76431704</td><td>1222</td><td>GTO</td><td>--</td><td>POLYGON 69.987084496 16.552858901 69.98791359 16.552858901 69.98791359 16.551496306 69.987084496 16.551496306</td><td>mast:JWST/product/jw01222-o011_s000000015_nirspec_f170lp-g235h-s200b1_cal.jpg</td><td>mast:JWST/product/jw01222-o011_s000000015_nirspec_f170lp-g235h-s200b1_s2d.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232629350</td><td>741717587</td></tr>
<tr><td>science</td><td>JWST</td><td>CALJWST</td><td>NIRSPEC/SLIT</td><td>JWST</td><td>F070LP;G140H</td><td>INFRARED</td><td>UHSJ0439+1634</td><td>Galaxy; High-redshift galaxies; Quasars</td><td>jw01222-o011_s000000001_nirspec_f070lp-g140h-s200a1</td><td>69.94621666666667</td><td>16.571033333333332</td><td>spectrum</td><td>Willott, Chris J.</td><td>3</td><td>59968.23952844908</td><td>59968.27992793982</td><td>2844.834</td><td>700.0</td><td>5000.0</td><td>Cosmic reionization, metal enrichment and host galaxies from quasar spectroscopy</td><td>60333.76431704</td><td>1222</td><td>GTO</td><td>--</td><td>POLYGON 69.945798319 16.571686993 69.946628519 16.571686993 69.946628519 16.570354577 69.945798319 16.570354577</td><td>mast:JWST/product/jw01222-o011_s000000001_nirspec_f070lp-g140h-s200a1_cal.jpg</td><td>mast:JWST/product/jw01222-o011_s000000001_nirspec_f070lp-g140h-s200a1_s2d.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232625999</td><td>741717597</td></tr>
<tr><td>science</td><td>JWST</td><td>CALJWST</td><td>NIRSPEC/SLIT</td><td>JWST</td><td>F170LP;G235H</td><td>INFRARED</td><td>UHSJ0439+1634</td><td>Galaxy; High-redshift galaxies; Quasars</td><td>jw01222-o011_s000000013_nirspec_f170lp-g235h-s400a1</td><td>69.94621666666667</td><td>16.571033333333332</td><td>spectrum</td><td>Willott, Chris J.</td><td>3</td><td>59968.23952844908</td><td>59968.31842642361</td><td>2844.834</td><td>1660.0</td><td>5000.0</td><td>Cosmic reionization, metal enrichment and host galaxies from quasar spectroscopy</td><td>60333.69175919</td><td>1222</td><td>GTO</td><td>--</td><td>POLYGON 69.945200123 16.574577994 69.946108378 16.574577994 69.946108378 16.573121456 69.945200123 16.573121456</td><td>mast:JWST/product/jw01222-o011_s000000013_nirspec_f170lp-g235h-s400a1_cal.jpg</td><td>mast:JWST/product/jw01222-o011_s000000013_nirspec_f170lp-g235h-s400a1_s2d.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232626001</td><td>741717631</td></tr>
</table></div></div></div>
</div>
<p>There are a lot of results (over 200!), so for convenience here, let’s just use two files per galaxy, curated in this list below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a list of JWST spectra to add to our plot</span>
<span class="n">jwst_spectra</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;VDES J0020-3653&quot;</span><span class="p">,</span>
     <span class="s2">&quot;proposal_id&quot;</span><span class="p">:</span> <span class="mi">1222</span><span class="p">,</span>
     <span class="s2">&quot;redshift&quot;</span><span class="p">:</span> <span class="mf">6.860</span><span class="p">,</span>
     <span class="s2">&quot;obs1&quot;</span><span class="p">:</span> <span class="s2">&quot;jw01222-o012_s000000001_nirspec_f170lp-g235h-s200a2-s200a1&quot;</span><span class="p">,</span>
     <span class="s2">&quot;obs2&quot;</span><span class="p">:</span> <span class="s2">&quot;jw01222-o012_s000000001_nirspec_f070lp-g140h-s200a1-s200a2&quot;</span><span class="p">},</span>

    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DELS J0411-0907&quot;</span><span class="p">,</span>
     <span class="s2">&quot;proposal_id&quot;</span><span class="p">:</span> <span class="mi">1222</span><span class="p">,</span>
     <span class="s2">&quot;redshift&quot;</span><span class="p">:</span> <span class="mf">6.825</span><span class="p">,</span>
     <span class="s2">&quot;obs1&quot;</span><span class="p">:</span> <span class="s2">&quot;jw01222-o002_s000000001_nirspec_f170lp-g235h-s200a2-s200a1&quot;</span><span class="p">,</span>
     <span class="s2">&quot;obs2&quot;</span><span class="p">:</span> <span class="s2">&quot;jw01222-o002_s000000001_nirspec_f070lp-g140h-s200a1-s200a2&quot;</span><span class="p">,</span>
     <span class="p">},</span>

    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;UHS J0439+1634&quot;</span><span class="p">,</span>
     <span class="s2">&quot;proposal_id&quot;</span><span class="p">:</span> <span class="mi">1222</span><span class="p">,</span>
     <span class="s2">&quot;redshift&quot;</span><span class="p">:</span> <span class="mf">6.519</span><span class="p">,</span>
     <span class="s2">&quot;obs1&quot;</span><span class="p">:</span> <span class="s2">&quot;jw01222-o011_s000000001_nirspec_f170lp-g235h-s200a1&quot;</span><span class="p">,</span>
     <span class="s2">&quot;obs2&quot;</span><span class="p">:</span> <span class="s2">&quot;jw01222-o011_s000000001_nirspec_f070lp-g140h-s200a1&quot;</span><span class="p">,</span>
     <span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>For each of these three galaxies, we will download the JWST spectra and store them in a small dictonary, just like we did for eBOSS.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_jwst_qso_spectrum</span><span class="p">(</span><span class="n">jwst_spec_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given an JWST observation ID, query MAST and download the spectrum using astroquery.mast</span>

<span class="sd">    Parameters:</span>
<span class="sd">    =============</span>
<span class="sd">    jwst_spec_data: dict</span>
<span class="sd">        Dictionary of object name and observation ids for retreieving the JWST spectra</span>

<span class="sd">    Returns:</span>
<span class="sd">    =============</span>
<span class="sd">    dictionary of...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">jwst_spec_dict</span><span class="p">[</span><span class="s1">&#39;redshift&#39;</span><span class="p">]</span>

    <span class="c1"># Query MAST for JWST observation</span>
    <span class="n">obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_collection</span><span class="o">=</span><span class="s1">&#39;JWST&#39;</span><span class="p">,</span> <span class="c1"># Search for JWST data</span>
                                           <span class="n">obs_id</span><span class="o">=</span><span class="n">jwst_spec_dict</span><span class="p">[</span><span class="s1">&#39;obs1&#39;</span><span class="p">],</span> <span class="c1"># Search on obs_id</span>
                                           <span class="p">)</span>
    <span class="c1"># Retrieve products</span>
    <span class="n">products_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs_list</span><span class="p">)</span>
    <span class="c1"># Filter products to just extracted 1D spectra</span>
    <span class="n">products_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">products_list</span><span class="p">,</span> <span class="n">productType</span><span class="o">=</span><span class="s1">&#39;SCIENCE&#39;</span><span class="p">,</span>
                                                 <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="s1">&#39;ANNNN_X1D&#39;</span><span class="p">,</span>
                                                 <span class="n">mrp_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Download spectrum file</span>
    <span class="n">jwst_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">products_list</span><span class="p">)</span>
    <span class="c1"># Open file</span>
    <span class="n">jwst_spec</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">jwst_manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># Retrieve wavelength and flux from the file</span>
    <span class="n">wls</span> <span class="o">=</span> <span class="n">jwst_spec</span><span class="p">[</span><span class="s1">&#39;EXTRACT1D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WAVELENGTH&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10000</span> <span class="c1"># convert microns to Angstroms</span>
    <span class="n">observed_flux</span> <span class="o">=</span> <span class="n">jwst_spec</span><span class="p">[</span><span class="s1">&#39;EXTRACT1D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span>
    <span class="c1"># Normalize the Flux values based on some percentile values</span>
    <span class="n">min_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">observed_flux</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># 5th percentile</span>
    <span class="n">max_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">observed_flux</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">)</span> <span class="c1"># 99th percentile</span>
    <span class="n">normalized_flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">observed_flux</span><span class="o">-</span><span class="n">min_flux</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_flux</span><span class="o">-</span><span class="n">min_flux</span><span class="p">)</span>

    <span class="c1"># Do it again for the second obs</span>
    <span class="n">obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_collection</span><span class="o">=</span><span class="s1">&#39;JWST&#39;</span><span class="p">,</span> <span class="c1"># Search for JWST data</span>
                                           <span class="n">obs_id</span><span class="o">=</span><span class="n">jwst_spec_dict</span><span class="p">[</span><span class="s1">&#39;obs2&#39;</span><span class="p">])</span> <span class="c1"># Search on obs_id</span>
    <span class="c1"># Retrieve products</span>
    <span class="n">products_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs_list</span><span class="p">)</span>
    <span class="c1"># Filter products to just extracted 1D spectra</span>
    <span class="n">products_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">products_list</span><span class="p">,</span> <span class="n">productType</span><span class="o">=</span><span class="s1">&#39;SCIENCE&#39;</span><span class="p">,</span>
                                                 <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="s1">&#39;ANNNN_X1D&#39;</span><span class="p">,</span>
                                                 <span class="n">mrp_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Download spectrum file</span>
    <span class="n">jwst_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">products_list</span><span class="p">)</span>
    <span class="c1"># Open file</span>
    <span class="n">jwst_spec</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">jwst_manifest</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># Retrieve wavelength and flux from the file</span>
    <span class="n">wls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">jwst_spec</span><span class="p">[</span><span class="s1">&#39;EXTRACT1D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WAVELENGTH&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10000</span><span class="p">)</span> <span class="c1"># convert microns to Angstroms</span>
    <span class="n">observed_flux</span> <span class="o">=</span> <span class="n">jwst_spec</span><span class="p">[</span><span class="s1">&#39;EXTRACT1D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FLUX&#39;</span><span class="p">]</span>
    <span class="c1"># Normalize the Flux values based on some percentile values</span>
    <span class="n">min_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">observed_flux</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="c1"># 30th percentile</span>
    <span class="n">max_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">observed_flux</span><span class="p">,</span> <span class="mf">99.5</span><span class="p">)</span> <span class="c1"># 99th percentile</span>
    <span class="n">normalized_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normalized_flux</span><span class="p">,</span> <span class="p">(</span><span class="n">observed_flux</span><span class="o">-</span><span class="n">min_flux</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_flux</span><span class="o">-</span><span class="n">min_flux</span><span class="p">))</span>

    <span class="c1"># Define a dictionary with the spectrum and other information we want to save</span>
    <span class="n">qso_spec</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">jwst_spec_dict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
        <span class="s2">&quot;redshift&quot;</span><span class="p">:</span> <span class="n">z</span><span class="p">,</span>
        <span class="s2">&quot;wls&quot;</span><span class="p">:</span> <span class="n">wls</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">wls</span><span class="p">)],</span>
        <span class="s2">&quot;flux&quot;</span><span class="p">:</span> <span class="n">normalized_flux</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">wls</span><span class="p">)],</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">qso_spec</span>   


<span class="n">jwst_qsos</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_jwst_qso_spectrum</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jwst_spectra</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01222-o012_s000000001_nirspec_f170lp-g235h-s200a2-s200a1_x1d.fits to ./mastDownload/JWST/jw01222-o012_s000000001_nirspec_f170lp-g235h-s200a2-s200a1/jw01222-o012_s000000001_nirspec_f170lp-g235h-s200a2-s200a1_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01222-o012_s000000001_nirspec_f070lp-g140h-s200a1-s200a2_x1d.fits to ./mastDownload/JWST/jw01222-o012_s000000001_nirspec_f070lp-g140h-s200a1-s200a2/jw01222-o012_s000000001_nirspec_f070lp-g140h-s200a1-s200a2_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01222-o002_s000000001_nirspec_f170lp-g235h-s200a2-s200a1_x1d.fits to ./mastDownload/JWST/jw01222-o002_s000000001_nirspec_f170lp-g235h-s200a2-s200a1/jw01222-o002_s000000001_nirspec_f170lp-g235h-s200a2-s200a1_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01222-o002_s000000001_nirspec_f070lp-g140h-s200a1-s200a2_x1d.fits to ./mastDownload/JWST/jw01222-o002_s000000001_nirspec_f070lp-g140h-s200a1-s200a2/jw01222-o002_s000000001_nirspec_f070lp-g140h-s200a1-s200a2_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01222-o011_s000000001_nirspec_f170lp-g235h-s200a1_x1d.fits to ./mastDownload/JWST/jw01222-o011_s000000001_nirspec_f170lp-g235h-s200a1/jw01222-o011_s000000001_nirspec_f170lp-g235h-s200a1_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01222-o011_s000000001_nirspec_f070lp-g140h-s200a1_x1d.fits to ./mastDownload/JWST/jw01222-o011_s000000001_nirspec_f070lp-g140h-s200a1/jw01222-o011_s000000001_nirspec_f070lp-g140h-s200a1_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<p>Let’s plot one of these, like we did before, to see what it looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up spectrum plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">qso</span> <span class="o">=</span> <span class="n">jwst_qsos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">redshift</span> <span class="o">=</span> <span class="n">qso</span><span class="p">[</span><span class="s1">&#39;redshift&#39;</span><span class="p">]</span>
<span class="c1"># Plot the observed spectrum</span>
<span class="n">wls</span> <span class="o">=</span> <span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">]</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">qso</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed Spectrum&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">wls</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">flux</span><span class="p">,</span> <span class="n">flux</span><span class="p">],</span>
               <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Plot emission lines</span>
<span class="n">plot_emission_lines</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">redshift</span><span class="p">)</span>

<span class="c1"># Set title and labels</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;JWST Spectrum - </span><span class="si">{</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Add redshift to plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;z = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">redshift</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flux&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="c1"># Add grid lines</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span> <span class="c1"># Add plot legend</span>
<span class="c1"># Set axes limits</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">]))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">]))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># remove space between plots</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># Display Plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/acfce29893a3a4fdd8a9c5e3a04f981ed575a9ea17575dfffb7bf701a5609ac2.png" src="../../../_images/acfce29893a3a4fdd8a9c5e3a04f981ed575a9ea17575dfffb7bf701a5609ac2.png" />
</div>
</div>
<p>Notice how this NIRSPEC spectrum covers a much different wavelength range than eBOSS. eBOSS spectra fall between 3,000 and 10,000 angstroms in visible light. JWST observed between 7,000 and 30,000 Angstroms! The JWST spectrum still has the same strong emission lines (Lyman-<span class="math notranslate nohighlight">\(\alpha\)</span>, C-IV and Mg II) that we saw before in the lower-redshift eBOSS quasars, only in infrared wavelengths because this quasar is so far away.</p>
<section id="combining-eboss-and-jwst-data">
<h2>Combining eBOSS and JWST Data<a class="headerlink" href="#combining-eboss-and-jwst-data" title="Permalink to this heading">#</a></h2>
<p>Now we can recreate our plot from before, adding these JWST spectra as very-high-redshift examples!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="k">for</span> <span class="n">qso</span> <span class="ow">in</span> <span class="n">jwst_qsos</span><span class="p">:</span>
    <span class="c1"># Round to nearest 0.25 in redshift just to align things on a grid</span>
    <span class="n">nearest_redshift</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;redshift&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">nearest_redshift</span><span class="o">-</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">nearest_redshift</span><span class="o">+</span><span class="mf">0.07</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">],</span> <span class="n">qso</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">100</span><span class="p">),</span> <span class="n">nearest_redshift</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;JWST </span><span class="si">{</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>


<span class="k">for</span> <span class="n">qso</span> <span class="ow">in</span> <span class="n">all_qsos</span><span class="p">:</span>
    <span class="c1"># Round to nearest 0.25 in redshift just to align things on a grid</span>
    <span class="n">nearest_redshift</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;redshift&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">nearest_redshift</span><span class="o">-</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">nearest_redshift</span><span class="o">+</span><span class="mf">0.07</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">],</span> <span class="n">qso</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">10400</span><span class="p">,</span> <span class="n">nearest_redshift</span><span class="p">,</span> <span class="n">qso</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">all_redshifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;redshift&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">qso</span> <span class="ow">in</span> <span class="n">all_qsos</span><span class="o">+</span><span class="n">jwst_qsos</span><span class="p">])</span>
<span class="n">wl_limits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">qso</span><span class="p">[</span><span class="s1">&#39;wls&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">qso</span> <span class="ow">in</span> <span class="n">all_qsos</span><span class="o">+</span><span class="n">jwst_qsos</span><span class="p">])</span>
<span class="n">wl_limits</span><span class="p">[</span><span class="n">wl_limits</span> <span class="o">&gt;</span> <span class="mi">12500</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12500</span>

<span class="c1"># Label and annotate emission lines</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">emline</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">emission_line_list</span><span class="p">):</span>
    <span class="c1"># Calculate observed wavelength for redshift</span>
    <span class="n">wavelength_obs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">all_redshifts</span><span class="p">)</span><span class="o">*</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;rest_wavelength&#39;</span><span class="p">]</span>
    <span class="c1"># Limit the points to those within the wavelength range of each spectrum</span>
    <span class="n">point_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">wavelength_obs</span> <span class="o">&lt;=</span> <span class="n">wl_limits</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">wavelength_obs</span> <span class="o">&gt;=</span> <span class="mi">3500</span><span class="p">)</span>
    <span class="c1"># Plot the points</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">point_mask</span><span class="p">],</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">all_redshifts</span><span class="p">[</span><span class="n">point_mask</span><span class="p">]],</span>
                         <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span>
                         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">points</span><span class="o">.</span><span class="n">set_path_effects</span><span class="p">([</span><span class="n">path_effects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)])</span>
    <span class="c1"># Add connecting lines between the points</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">point_mask</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="n">ConnectionPatch</span><span class="p">((</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">point_mask</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">all_redshifts</span><span class="p">[</span><span class="n">point_mask</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span>
                             <span class="p">(</span><span class="n">wavelength_obs</span><span class="p">[</span><span class="n">point_mask</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">all_redshifts</span><span class="p">[</span><span class="n">point_mask</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> 
                             <span class="n">coordsA</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">coordsB</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">axesA</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">axesB</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span> <span class="n">shrinkA</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                             <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">cp</span><span class="o">.</span><span class="n">set_path_effects</span><span class="p">([</span><span class="n">path_effects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>

    <span class="c1"># Add text for line labels</span>
    <span class="n">text_coord_x</span> <span class="o">=</span> <span class="n">wavelength_obs</span><span class="p">[</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_index&#39;</span><span class="p">]]</span><span class="o">-</span><span class="mi">550</span>
    <span class="n">text_coord_y</span> <span class="o">=</span> <span class="n">all_redshifts</span><span class="p">[</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_index&#39;</span><span class="p">]]</span><span class="o">+</span><span class="mf">0.075</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">text_coord_x</span><span class="p">,</span> <span class="n">text_coord_y</span><span class="p">,</span> <span class="n">emline</span><span class="p">[</span><span class="s1">&#39;emline&#39;</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_color&#39;</span><span class="p">],</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;label_angle&#39;</span><span class="p">])</span>
    <span class="c1"># Add white border for readability</span>
    <span class="n">text</span><span class="o">.</span><span class="n">set_path_effects</span><span class="p">([</span><span class="n">path_effects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)])</span>

<span class="c1">#plt.xlim(3596, 24000)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">3596</span><span class="p">,</span> <span class="mi">12500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Redshift (z)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Quasar Emission Lines Across Redshift - JWST and eBOSS&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/24ee339c3808b2628b23a25e8e29bafcf23e1b06795ea158e4656ae0e4454ecb.png" src="../../../_images/24ee339c3808b2628b23a25e8e29bafcf23e1b06795ea158e4656ae0e4454ecb.png" />
</div>
</div>
<hr class="docutils" />
<p>Congratulations! You have reached the end of this tutorial notebook. You have learned how to access and download eBOSS data from MAST, and combine it with NIRSPEC observations to characterize quasar spectra across cosmic time.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="additional-resources">
<h1>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h1>
<p>Additional resources are linked below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://archive.stsci.edu/missions-and-data/sdss">SDSS Legacy Archive at MAST</a></p></li>
<li><p><a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/The+SDSS+Legacy+Archive+at+MAST">SDSS Legacy Archive at MAST User Manual</a></p></li>
<li><p><a class="reference external" href="https://www.sdss4.org/surveys/eboss/">SDSS-IV eBOSS Survey</a></p></li>
<li><p><a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html">astroquery.mast User Manual</a></p></li>
<li><p><a class="reference external" href="https://mast.stsci.edu/api/v0/index.html">MAST API</a></p></li>
</ul>
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Permalink to this heading">#</a></h2>
<p>If you use eBOSS data for published research, see the following links for information on which citations to include in your paper:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://sdss.org/collaboration/citing-sdss/">Citing SDSS</a></p></li>
<li><p><a class="reference external" href="https://archive.stsci.edu/publishing/mission-acknowledgements">Citing MAST</a></p></li>
<li><p><a class="reference external" href="https://www.astropy.org/acknowledging.html">Citing astropy</a></p></li>
</ul>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h2>
<p><strong>Author(s):</strong> Julie Imig (jimig&#64;stsci.edu) <br>
<strong>Keyword(s):</strong> Tutorial, SDSS, eBOSS, JWST, QSO, quasar <br>
<strong>First published:</strong> March 2025 <br>
<strong>Last updated:</strong> March 2025 <br></p>
<hr class="docutils" />
<p><span class="xref myst">Top of Page</span>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/style-guides/master/guides/images/stsci-logo.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/style-guides/master/guides/images/stsci-logo.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/SDSS/eBOSS_JWST_tutorial"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Characterizing Variable Stars with APOGEE + TESS</p>
      </div>
    </a>
    <a class="right-next"
       href="../eBOSS_HST_hubbles_law/hubbles_law.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Calculating the Hubble Constant with eBOSS</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Exploring High-Redshift Quasars with eBOSS and JWST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-eboss-data-at-mast">Accessing eBOSS data at MAST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-all-eboss-data">Querying all eBOSS data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-specific-target">Searching for a specific target</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-eboss-data-products">Downloading eBOSS data products</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-an-eboss-spectrum">Plotting an eBOSS Spectrum</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identifying-emission-lines-in-a-qso-spectrum">Identifying Emission Lines in a QSO Spectrum</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-qso-spectra-at-different-redshift">Exploring QSO spectra at different redshift</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-high-redshift-jwst-spectra">Searching for High-Redshift JWST spectra</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-eboss-and-jwst-data">Combining eBOSS and JWST Data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>