
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Mapping Galaxy Properties with MaNGA + HST &#8212; MAST Notebook Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css?v=cd6c26fb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css?v=32d70693" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-SK672ZMP7G"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/SDSS/MaNGA_HST_tutorial/MaNGA_HST_tutorial';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Characterizing Variable Stars with APOGEE + TESS" href="../APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html" />
    <link rel="prev" title="Sloan Digital Sky Survey (SDSS)" href="../sdss.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/mastlogo.svg" class="logo__image only-light" alt="MAST Notebook Repository - Home"/>
    <script>document.write(`<img src="../../../_static/mastlogo.svg" class="logo__image only-dark" alt="MAST Notebook Repository - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to the MAST Notebook Repository!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">GALEX</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../GALEX/mis_mosaic/mis_mosaic.html">Surveying dust structure via GALEX MIS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HSC</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/queries.html">Intro HSC Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSCV3_API/hscv3_api.html">Hubble Source Catalog API Notebook</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSCV3_SMC_API/hscv3_smc_api.html">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HSC_TAP/HSC_TAP.html">MAST Table Access Protocol Hubble Source Catalog Demo</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/SWEEPS.html">SWEEPS Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1/sweeps_hscv3p1.html">Hubble Source Catalog SWEEPS Proper Motion (CasJobs Version)</a></li>






















<li class="toctree-l2"><a class="reference internal" href="../../HSC/SWEEPS_HSCV3P1_API/sweeps_hscv3p1_api.html">Hubble Source Catalog SWEEPS Proper Motion (API Version)</a></li>









</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../HSC/HCV.html">Hubble Catalog of Variables (HCV) Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../HSC/HCV_API/HCV_API_demo.html">Hubble Catalog of Variables Notebook (API version)</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../HSC/HCV_CASJOBS/HCV_casjobs_demo.html">Hubble Catalog of Variables Notebook (CasJobs version)</a></li>



</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">IUE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html">Exploring UV Extinction Curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JWST</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">Accessing JWST Proposal Data in astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/duplication_checking/duplication_checking.html">JWST Duplication Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">JWST Engineering Data Retrieval</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/SI_keyword_exoplanet_search/SI_keyword_exoplanet_search.html">JWST SI Keyword Search for Exoplanet Spectra</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/MAST_metadata_search/MAST_metadata_search.html">Astroquery: Exploring Metadata from the James Webb Space Telescope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_lightcurves/plotting_lightcurves.html">Using Kepler Data to Plot a Light Curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_images_from_tpf/plotting_images_from_tpf.html">Plotting Images from Kepler Target Pixel Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_dvts/plotting_dvts.html">Read and Plot A Kepler Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_catalog_over_FFI/plotting_catalog_over_FFI.html">Plotting a Catalog over a Kepler Full Frame Image File</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/lightkurve.html">Lightkurve</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_lc_products/lightkurve_analyzing_lc_products.html">Using <em>Kepler</em> Light Curve Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_tpf_products/lightkurve_analyzing_tpf_products.html">Using <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_searching_for_data/lightkurve_searching_for_data.html">Searching for <em>Kepler</em>/<em>K2</em> and <em>TESS</em> Data Products Using Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_custom_aperture_photometry/lightkurve_custom_aperture_photometry.html">Creating Your Own Light Curves using Custom Aperture Photometry</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_combining_multiple_quarters/lightkurve_combining_multiple_quarters.html">Combining Multiple Quarters of <em>Kepler</em> Data with Lightkurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_interactively_inspecting_TPFs_and_LCs/lightkurve_interactively_inspecting_TPFs_and_LCs.html">Interactively Inspecting Target Pixel Files and Light Curves</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/inst_noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_1_data_gaps_and_quality_flags/instrumental_noise_1_data_gaps_and_quality_flags.html">Data Gaps and Quality Flags</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_2_spurious_signals_and_time_sampling_effects/instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">Spurious Signals and Time Sampling Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_3_seasonal_and_detector_effects/instrumental_noise_3_seasonal_and_detector_effects.html">Seasonal and Detector Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_4_electronic_noise/instrumental_noise_4_electronic_noise.html">Electronic Noise</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/signals.html">Identifying Periodic Signals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/identifying_transiting_planet_signals/identifying_transiting_planet_signals.html">Identifying Transiting Planet Signals in a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/measuring_a_rotation_period/measuring_a_rotation_period.html">Measuring and Removing a Rotation Period Signal from a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/visualizing_periodic_signals_using_a_river_plot/visualizing_periodic_signals_using_a_river_plot.html">Visualizing Periodic Signals Using a River Plot</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/verifying_the_location_of_a_signal/verifying_the_location_of_a_signal.html">Verifying the Location of a Signal in <em>Kepler</em> Pixel Data</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/periodograms.html">Periodograms &amp; Asteroseismology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/creating_periodograms/creating_periodograms.html">Creating Periodograms</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">How to Understand and Manipulate the Periodogram of an Oscillating Star</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">How to Estimate a Star’s Mass and Radius Using Asteroseismology</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">K2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../K2/TPF/TPF.html">Beginner: Read and Display A K2 Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a K2 Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/removing_instrumental_noise_using_pld/removing_instrumental_noise_using_pld.html">Removing Instrumental Noise from <em>K2</em> and <em>TESS</em> Light Curves Using Pixel Level Decorrelation (PLD)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MCCM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MCCM/FIMS-SPEAR/hyperspectral_healpix_maps/hyperspectral_healpix_maps.html">Working with FIMS-SPEAR Hyperspectral HEALPix Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SDSS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../sdss.html">Sloan Digital Sky Survey (SDSS)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Mapping Galaxy Properties with MaNGA + HST</a></li>



<li class="toctree-l2"><a class="reference internal" href="../APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html">Characterizing Variable Stars with APOGEE + TESS</a></li>






<li class="toctree-l2"><a class="reference internal" href="../eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html">Exploring High-Redshift Quasars with eBOSS and JWST</a></li>




<li class="toctree-l2"><a class="reference internal" href="../eBOSS_HST_hubbles_law/hubbles_law.html">Calculating the Hubble Constant with eBOSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SDSS_LEGACY_IMAGING_cmd/cmd_diagram.html">Creating a Color-Magnitude Diagram for Messier 13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SDSS_LEGACY_IMAGING_galaxy_morphology/galaxy_morphology.html">Galaxy Morphology with SDSS and Astrocut</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SDSS_SEGUE_spectra/sdss_stellar_spectra.html">Exploring Stellar Spectra with SDSS SEGUE</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multi-Mission Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../multi_mission/astroquery.html">Astroquery</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_search/beginner_search.html">Beginner: Searching MAST using astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_zcut/beginner_zcut.html">Beginner: Zcut and Astroquery Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/large_downloads/large_downloads.html">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/historic_quasar_observations/historic_quasar_observations.html">Historical Quasar Observations</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/wildcard_searches/wildcard_searches.html">Wildcard Handling with Astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/missions_mast_search/missions_mast_search.html">Searching for Mission-Specific Data with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/galex_panstarrs_bulk_download/galex_panstarrs_bulk_download.html"><strong>Large downloads in astroquery.mast from AWS to local storage</strong></a></li>

</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../multi_mission/display_footprints/display_footprints.html">PySIAF Observation Footprint Viewer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PanSTARRS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">MAST Table Access Protocol PanSTARRS 1 DR2 Demo</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_image/PS1_image.html">Get Images from the PS1 Image Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TESS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">Retrieve TESS Data Validation Products with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">Read and Plot A TESS Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Read and Display a TESS Full Frame Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">Read and Plot A TESS Light Curve File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">Read and Display A TESS Target Pixel File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">Exoplanet Data and TESS Light Curves Using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">Download MAST TESS Light Curves Within an FFI Footprint Using TAP</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">Search The TESS Input Catalog Centered On HD 209458.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">A Tour of the Contents of the TESS 2-minute Cadence Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tesscut_astroquery/beginner_tesscut_astroquery.html">Cutout of the TESS FFIs using Astrocut and Astroquery</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/lc.html">Light Curves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">Intermediate:  Search and Download GI Program Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tasoc_lc/interm_tasoc_lc.html">Intermediate: Finding Flares and Variable Stars in TASOC Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/asteroid_rotation/asteroid_rotation.html">Finding the Rotation Curve of an Asteroid or Comet with TESScut and Lightkurve</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/FFIs.html">TESS FFIs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">Intermediate: Create TESS FFI Cutout using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/making_tess_cubes_and_cutouts/making_tess_cubes_and_cutouts.html">Generating Cubes and Cutouts from TESS FFIs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">Intermediate: Retrieve TESS Pixel Response Function Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/removing_scattered_light_using_regression/removing_scattered_light_using_regression.html">Removing Scattered Light from <em>TESS</em> Data Using the Lightkurve <code class="docutils literal notranslate"><span class="pre">RegressionCorrector</span></code></a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualizations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Visualizations/mast_sky/mast_sky.html">MAST’S View of the Sky</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://timeseries.science.stsci.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/spacetelescope/mast_notebooks&urlpath=lab/tree/mast_notebooks/notebooks/SDSS/MaNGA_HST_tutorial/MaNGA_HST_tutorial.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/SDSS/MaNGA_HST_tutorial/MaNGA_HST_tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/SDSS/MaNGA_HST_tutorial/MaNGA_HST_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mapping Galaxy Properties with MaNGA + HST</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Mapping Galaxy Properties with MaNGA + HST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-manga-data-at-mast">Accessing MaNGA data at MAST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-all-manga-data">Querying all MaNGA data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-specific-galaxy">Searching for a specific galaxy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-manga-data-products">Downloading MaNGA data products</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-velocity-and-flux-maps-from-manga">Plotting velocity and flux maps from MaNGA</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-hst-observations-of-this-galaxy">Searching for HST observations of this galaxy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-search-using-astroquery-mast">Coordinate search using astroquery.mast</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-hst-images">Plot the HST images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colorizing-hst-images-with-astropy">Colorizing HST images with astropy</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-manga-and-hst-data">Combining MaNGA and HST data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-an-h-alpha-emission-map">Creating an H-alpha Emission Map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-stellar-velocity-field">Plotting the stellar velocity field</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a id="top"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="mapping-galaxy-properties-with-manga-hst">
<h1>Mapping Galaxy Properties with MaNGA + HST<a class="headerlink" href="#mapping-galaxy-properties-with-manga-hst" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<p>By the end of this tutorial, you will:</p>
<ul class="simple">
<li><p>Understand how to search the MAST Archive and download SDSS MaNGA data using <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></p></li>
<li><p>Plot galaxy properties including H-<span class="math notranslate nohighlight">\(\alpha\)</span> emission line flux and stellar velocities with MaNGA</p></li>
<li><p>Understand how to search for HST data complementing the MaNGA observations</p></li>
<li><p>Create maps of galaxy properties by combining HST and MaNGA data</p></li>
</ul>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#Introduction"><span class="xref myst">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#Imports"><span class="xref myst">Imports</span></a></p></li>
<li><p><a class="reference internal" href="#MaNGA"><span class="xref myst">Accessing MaNGA data at MAST</span></a></p>
<ul>
<li><p><a class="reference internal" href="#MaNGA-query"><span class="xref myst">Querying All MaNGA data</span></a></p></li>
<li><p><a class="reference internal" href="#MaNGA-galaxy"><span class="xref myst">Searching for a specific galaxy</span></a></p></li>
<li><p><a class="reference internal" href="#MaNGA-download"><span class="xref myst">Downloading MaNGA data products</span></a></p></li>
<li><p><a class="reference internal" href="#MaNGA-plot"><span class="xref myst">Plotting velocity and flux maps from MaNGA</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#HST"><span class="xref myst">Searching for HST data of this galaxy</span></a></p>
<ul>
<li><p><a class="reference internal" href="#HST-query"><span class="xref myst">Coordinate search using astroquery.mast</span></a></p></li>
<li><p><a class="reference internal" href="#HST-colorize"><span class="xref myst">Colorizing HST images with astropy</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#HST-MaNGA"><span class="xref myst">Combining MaNGA and HST data</span></a></p>
<ul>
<li><p><a class="reference internal" href="#HST-MaNGA-Halpha"><span class="xref myst">Creating an H-alpha Emission Map</span></a></p></li>
<li><p><a class="reference internal" href="#HST-MaNGA-Velocity"><span class="xref myst">Plotting the stellar velocity field</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#Resources"><span class="xref myst">Additional Resources</span></a></p>
<ul>
<li><p><a class="reference internal" href="#Citations"><span class="xref myst">How to Cite</span></a></p></li>
<li><p><a class="reference internal" href="#About"><span class="xref myst">About This Notebook</span></a></p></li>
</ul>
</li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p><a id="Introduction"></a></p>
<p>The <a class="reference external" href="https://www.sdss4.org/surveys/manga/">Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</a> survey provides optical-wavelength integral field unit (IFU) spectroscopy for over 10,000 nearby galaxies. MaNGA collected data between 2014 - 2020 as part of the <a class="reference external" href="https://www.sdss4.org">Sloan Digital Sky Survey (SDSS-IV) project</a>. MaNGA data is now available at the <a class="reference external" href="https://archive.stsci.edu">Mikulski Archive for Space Telescopes (MAST)</a> through the <a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/The+SDSS+Legacy+Archive+at+MAST">SDSS Legacy Archive at MAST</a>.</p>
<p>In this notebook tutorial, we will demonstrate how to access MaNGA data at MAST using Python. One MaNGA observation, an interacting galaxy pair named <code class="docutils literal notranslate"><span class="pre">MaNGA</span> <span class="pre">7443-12703</span></code> will be used to demonstrate the basics of how to download and plot MaNGA data. We will then combine this MaNGA data with HST observations, also accessible from MAST, to study this galaxy pair in detail, exploring how its gas and stars are moving as the galaxies merge together.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<p><a id="Imports"></a></p>
<p>The main packages we’re using for this notebook and their use-cases are:</p>
<ul class="simple">
<li><p><em>astropy.coordinates</em> for handling astronomical coordinates</p></li>
<li><p><em>astroquery.mast Observations</em> for searching the MAST archive</p></li>
<li><p><em>astropy.visualization</em> for colorizing images</p></li>
<li><p><em>astropy.wcs WCS</em> for handling spatial footprints</p></li>
<li><p><em>astropy.units</em> for working with astronomical units</p></li>
<li><p><em>astropy.io fits</em> for accessing FITS files</p></li>
<li><p><em>matplotlib.pyplot</em> for plotting data</p></li>
<li><p><em>numpy</em> to handle array functions</p></li>
<li><p><em>PIL</em> for plotting and handling preview (png/jpg) images</p></li>
<li><p><em>reproject</em> for coordinate transformations and projections</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_lupton_rgb</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.wcs</span><span class="w"> </span><span class="kn">import</span> <span class="n">WCS</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.io.fits</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fits</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">PIL</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">reproject</span>
</pre></div>
</div>
</div>
</div>
<p>This cell updates some of the settings in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to use larger font sizes in the figures:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Update Plotting Parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> 
          <span class="s1">&#39;text.usetex&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;font.family&#39;</span><span class="p">:</span> <span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p><a id="MaNGA"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="accessing-manga-data-at-mast">
<h1>Accessing MaNGA data at MAST<a class="headerlink" href="#accessing-manga-data-at-mast" title="Link to this heading">#</a></h1>
<p>The <a class="reference external" href="https://outerspace.stsci.edu/display/SDSS/The+SDSS+Legacy+Archive+at+MAST">SDSS Legacy Archive at MAST</a> hosts all of the science-ready data products from the <a class="reference external" href="https://www.sdss4.org/surveys/manga/">SDSS-IV MaNGA Survey</a>, which includes data for over 10,000 different nearby galaxies taken with the Apache Point Observatory SDSS-2.5m telescope. This notebook will demonstrate how to search and download MaNGA data using MAST.</p>
<img src="https://www.sdss4.org/wp-content/uploads/2014/07/manga_v3.jpg" alt="The SDSS MaNGA survey obtains spectra across the entire face of target galaxies using custom designed fiber bundles. The title text in the top-center of the image reads 'SDSS-IV Dissects 10,000 Galaxies in Nearby Universe'. In the top left corner is a small inset image of the SDSS 2.5m telescope at Apache Point Observatory, where the MaNGA data was taken. The center-left shows an image of a pair of hands plugging an optical fiber into the MaNGA instrument. The SDSS-IV logo is in the bottom-left. A close-up photo of the MaNGA instrument is shown in the center and bottom-right area of the image, demonstrating that each MaNGA data cube is made from dozens of optical fibers arranged in a hexagon shape, which each take a spectrum at a different location in the galaxy. The top-right inset shows two example spectra from MaNGA, one taken from the center of the fiber bundle (labeled 1) and one taken from the edge of the fiber bundle (labeled 2), showing how the spectrum of the central regions differs dramatically from outer regions. Image Credit: Dana Berry / SkyWorks Digital Inc., David Law, and the SDSS collaboration." width="500px">
<center><i>Image Credit: Dana Berry / SkyWorks Digital Inc., David Law, and the SDSS collaboration.</i></center>
<p><a id="MaNGA-query"></a></p>
<section id="querying-all-manga-data">
<h2>Querying all MaNGA data<a class="headerlink" href="#querying-all-manga-data" title="Link to this heading">#</a></h2>
<p>Searching for MaNGA data is straightforward with <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code>. In this example, we use <code class="docutils literal notranslate"><span class="pre">Observations.query_criteria</span></code> and search for <code class="docutils literal notranslate"><span class="pre">provenance_name</span> <span class="pre">=</span> <span class="pre">'MaNGA'</span></code>. This will return a table describing all of the MaNGA data hosted by the MAST archive.</p>
<p>Other useful search parameters for MaNGA data might include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">obs_collection</span> <span class="pre">=</span> <span class="pre">'SDSS'</span></code>: searches for all SDSS data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_classification</span> <span class="pre">=</span> <span class="pre">'GALAXY'</span></code>: searches for only galaxies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">obs_id</span></code> to search for specific targets</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search for MaNGA data</span>
<span class="n">manga_obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;MaNGA&#39;</span><span class="p">)</span>

<span class="c1"># Display First Ten Entries in Table</span>
<span class="n">manga_obs_list</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=10</i>
<table id="table139705263595536" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th></tr></thead>
<thead><tr><th>str7</th><th>str4</th><th>str5</th><th>str5</th><th>str4</th><th>str4</th><th>str7</th><th>str9</th><th>str9</th><th>str22</th><th>float64</th><th>float64</th><th>str4</th><th>str18</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str59</th><th>float64</th><th>str3</th><th>str1</th><th>int64</th><th>str53</th><th>str37</th><th>str61</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>str9</th></tr></thead>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-601561</td><td>GALAXY</td><td>sdss_manga_12696-1901</td><td>13.943292</td><td>0.6450414</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 13.943292 0.6450414 0.001736111111111111</td><td>mast:SDSS/manga/12696/1901/1901.png</td><td>mast:SDSS/manga/12696/1901/manga-12696-1901-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291748</td><td>635473185</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-32796</td><td>GALAXY</td><td>sdss_manga_12696-12704</td><td>14.374275</td><td>0.10294809</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 14.374275 0.10294809 0.0045138888888888885</td><td>mast:SDSS/manga/12696/12704/12704.png</td><td>mast:SDSS/manga/12696/12704/manga-12696-12704-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291749</td><td>635473584</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-32827</td><td>GALAXY</td><td>sdss_manga_12696-12705</td><td>14.560282</td><td>-0.29682866</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 14.560282 -0.29682866 0.0045138888888888885</td><td>mast:SDSS/manga/12696/12705/12705.png</td><td>mast:SDSS/manga/12696/12705/manga-12696-12705-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291750</td><td>635473984</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-32223</td><td>GALAXY</td><td>sdss_manga_12696-12702</td><td>13.427716</td><td>-1.0851671</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 13.427716 -1.0851671 0.0045138888888888885</td><td>mast:SDSS/manga/12696/12702/12702.png</td><td>mast:SDSS/manga/12696/12702/manga-12696-12702-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291751</td><td>635474496</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-32708</td><td>GALAXY</td><td>sdss_manga_12696-12701</td><td>13.976234</td><td>-0.92219584</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 13.976234 -0.92219584 0.0045138888888888885</td><td>mast:SDSS/manga/12696/12701/12701.png</td><td>mast:SDSS/manga/12696/12701/manga-12696-12701-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291752</td><td>635474974</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-32623</td><td>GALAXY</td><td>sdss_manga_12696-3703</td><td>14.197601</td><td>-0.92006382</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 14.197601 -0.92006382 0.0024305555555555556</td><td>mast:SDSS/manga/12696/3703/3703.png</td><td>mast:SDSS/manga/12696/3703/manga-12696-3703-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291753</td><td>635475119</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-32786</td><td>GALAXY</td><td>sdss_manga_12696-6103</td><td>14.210907</td><td>0.34647026</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 14.210907 0.34647026 0.003125</td><td>mast:SDSS/manga/12696/6103/6103.png</td><td>mast:SDSS/manga/12696/6103/manga-12696-6103-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291754</td><td>635475317</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-32691</td><td>GALAXY</td><td>sdss_manga_12696-6102</td><td>14.292417</td><td>-0.34695556</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 14.292417 -0.34695556 0.003125</td><td>mast:SDSS/manga/12696/6102/6102.png</td><td>mast:SDSS/manga/12696/6102/manga-12696-6102-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291755</td><td>635475480</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-107844</td><td>GALAXY</td><td>sdss_manga_12696-3702</td><td>14.365107</td><td>-0.47157688</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 14.365107 -0.47157688 0.0024305555555555556</td><td>mast:SDSS/manga/12696/3702/3702.png</td><td>mast:SDSS/manga/12696/3702/manga-12696-3702-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291756</td><td>635475604</td></tr>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>1-32715</td><td>GALAXY</td><td>sdss_manga_12696-12703</td><td>14.185601</td><td>-0.87482496</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>59080.0</td><td>59083.0</td><td>13501.2</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 14.185601 -0.87482496 0.0045138888888888885</td><td>mast:SDSS/manga/12696/12703/12703.png</td><td>mast:SDSS/manga/12696/12703/manga-12696-12703-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291757</td><td>635475953</td></tr>
</table></div></div></div>
</div>
<p><a id="MaNGA-galaxy"></a></p>
</section>
<section id="searching-for-a-specific-galaxy">
<h2>Searching for a specific galaxy<a class="headerlink" href="#searching-for-a-specific-galaxy" title="Link to this heading">#</a></h2>
<p>Let’s narrow down the search to one particular galaxy: MaNGA galaxy 7443-12703, also known as “Mrk 848B”. This is an interacting galaxy pair currently undergoing a merger event: the two galaxies are colliding and will eventually merge together into one large galaxy. Studying merger events like this one help us understand how galaxies grow and evolve over time.</p>
<p>We can search for this galaxy in particular using the <code class="docutils literal notranslate"><span class="pre">obs_id</span></code> keyword:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search for MaNGA galaxy 7443-12703</span>
<span class="n">manga_obs_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;MaNGA&#39;</span><span class="p">,</span>
                                             <span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;sdss_manga_7443-12703&#39;</span><span class="p">)</span>

<span class="c1"># Display results</span>
<span class="n">manga_obs_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=1</i>
<table id="table139705011538448" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th></tr></thead>
<thead><tr><th>str7</th><th>str4</th><th>str5</th><th>str5</th><th>str4</th><th>str4</th><th>str7</th><th>str9</th><th>str6</th><th>str21</th><th>float64</th><th>float64</th><th>str4</th><th>str18</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str59</th><th>float64</th><th>str3</th><th>str1</th><th>int64</th><th>str48</th><th>str36</th><th>str59</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>str9</th></tr></thead>
<tr><td>science</td><td>SDSS</td><td>MaNGA</td><td>MaNGA</td><td>SDSS</td><td>None</td><td>OPTICAL</td><td>12-193481</td><td>GALAXY</td><td>sdss_manga_7443-12703</td><td>229.52558</td><td>42.745842</td><td>cube</td><td>SDSS Collaboration</td><td>3</td><td>56741.0</td><td>56745.0</td><td>13501.5</td><td>362.09999999999997</td><td>1035.4</td><td>Mapping Nearby Galaxies at Apache Point Observatory (MaNGA)</td><td>59554.0</td><td>N/A</td><td>--</td><td>--</td><td>CIRCLE 229.52558 42.745842 0.0045138888888888885</td><td>mast:SDSS/manga/7443/12703/12703.png</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LOGCUBE.fits.gz</td><td>PUBLIC</td><td>False</td><td>nan</td><td>232291699</td><td>636473677</td></tr>
</table></div></div></div>
</div>
<p><a id="MaNGA-download"></a></p>
</section>
<section id="downloading-manga-data-products">
<h2>Downloading MaNGA data products<a class="headerlink" href="#downloading-manga-data-products" title="Link to this heading">#</a></h2>
<p>List all of the data products availble for this galaxy using <code class="docutils literal notranslate"><span class="pre">Observations.get_product_list()</span></code>.</p>
<p>There are 13 total files available for this galaxy, which include include a preview image (<code class="docutils literal notranslate"><span class="pre">12703.png</span></code>), the 3D MaNGA spectral cube (<code class="docutils literal notranslate"><span class="pre">manga-7443-12703-LOGCUBE.fits.gz</span></code>), and the MaNGA MAP file (<code class="docutils literal notranslate"><span class="pre">manga-7443-12703-MAPS-HYB10-MILESHC-MASTARSSP.fits.gz</span></code>) which contains measurements and parameters from the MaNGA data analysis pipeline.</p>
<p>More information on all of these products can be seen in the search results table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get list of products (files) associated with this observation </span>
<span class="n">manga_products_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">manga_obs_list</span><span class="p">)</span>

<span class="c1"># Show Products List</span>
<span class="n">manga_products_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=15</i>
<table id="table139704991877456" class="table-striped table-bordered table-condensed">
<thead><tr><th>obsID</th><th>obs_collection</th><th>dataproduct_type</th><th>obs_id</th><th>description</th><th>type</th><th>dataURI</th><th>productType</th><th>productGroupDescription</th><th>productSubGroupDescription</th><th>productDocumentationURL</th><th>project</th><th>prvversion</th><th>proposal_id</th><th>productFilename</th><th>size</th><th>parent_obsid</th><th>dataRights</th><th>calib_level</th><th>filters</th></tr></thead>
<thead><tr><th>str9</th><th>str4</th><th>str12</th><th>str21</th><th>str256</th><th>str1</th><th>str83</th><th>str7</th><th>str28</th><th>str14</th><th>str61</th><th>str5</th><th>str6</th><th>str3</th><th>str56</th><th>int64</th><th>str9</th><th>str6</th><th>int64</th><th>str4</th></tr></thead>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>Preview-Full</td><td>S</td><td>mast:SDSS/manga/7443/12703/12703.png</td><td>PREVIEW</td><td>--</td><td>--</td><td>--</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>12703.png</td><td>238960</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA IFU Data Cube, with linear wavelength sampling</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LINCUBE.fits.gz</td><td>SCIENCE</td><td>--</td><td>CUBE</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-LINCUBE.fits.gz</td><td>308685608</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA Data Analysis Maps. Same as HYB10-MILESHC-MASTARSSP except hierarchically clustered templates from MaStar are used to fit the stellar continuum in the emission-line module.</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-MAPS-HYB10-MILESHC-MASTARHC2.fits.gz</td><td>SCIENCE</td><td>--</td><td>MAPS</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-MAPS-HYB10-MILESHC-MASTARHC2.fits.gz</td><td>11180464</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA Data Analysis Maps. Analysis of each individual spaxel with S/N&gt;1 ; spaxels must have a valid continuum fit for an emission-line model to be fit.</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-MAPS-SPX-MILESHC-MASTARSSP.fits.gz</td><td>SCIENCE</td><td>--</td><td>MAPS</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-MAPS-SPX-MILESHC-MASTARSSP.fits.gz</td><td>10814176</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA Data Analysis Maps. Spaxels are binned to S/N~10 using the Voronoi binning algorithm; all binned spectra are treated independently.</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-MAPS-VOR10-MILESHC-MASTARSSP.fits.gz</td><td>SCIENCE</td><td>--</td><td>MAPS</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-MAPS-VOR10-MILESHC-MASTARSSP.fits.gz</td><td>6018405</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA Data Analysis Model Cubes. Same as HYB10-MILESHC-MASTARSSP except hierarchically clustered templates from MaStar are used to fit the stellar continuum in the emission-line module.</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LOGCUBE-HYB10-MILESHC-MASTARHC2.fits.gz</td><td>SCIENCE</td><td>--</td><td>MODELCUBE</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-LOGCUBE-HYB10-MILESHC-MASTARHC2.fits.gz</td><td>178831813</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA Data Analysis Model Cubes. Analysis of each individual spaxel with S/N&gt;1 ; spaxels must have a valid continuum fit for an emission-line model to be fit.</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LOGCUBE-SPX-MILESHC-MASTARSSP.fits.gz</td><td>SCIENCE</td><td>--</td><td>MODELCUBE</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-LOGCUBE-SPX-MILESHC-MASTARSSP.fits.gz</td><td>248679687</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SSDSS MaNGA Data Analysis Model Cubes. Spaxels are binned to S/N~10 using the Voronoi binning algorithm; all binned spectra are treated independently.</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LOGCUBE-VOR10-MILESHC-MASTARSSP.fits.gz</td><td>SCIENCE</td><td>--</td><td>MODELCUBE</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-LOGCUBE-VOR10-MILESHC-MASTARSSP.fits.gz</td><td>132859770</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA Row-Stacked Spectra, with linear wavelength sampling</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LINRSS.fits.gz</td><td>SCIENCE</td><td>--</td><td>RSS</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-LINRSS.fits.gz</td><td>247013854</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA IFU Data Cube, with logarithmic wavelength sampling</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LOGCUBE.fits.gz</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>CUBE</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-LOGCUBE.fits.gz</td><td>212028256</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA Data Analysis Maps. Stellar-continuum analysis of spectra binned to S/N~10 for the stellar kinematics, with hierarchically clustered MILES templates; emission-line analysis done on individual spaxels, with MaStar simple stellar population models</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-MAPS-HYB10-MILESHC-MASTARSSP.fits.gz</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>MAPS</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-MAPS-HYB10-MILESHC-MASTARSSP.fits.gz</td><td>11162876</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA DAP Model Cubes. Stellar-continuum analysis of spectra binned to S/N~10 for the stellar kinematics, with hierarchically clustered MILES templates; emission-line analysis done on individual spaxels, with MaStar simple stellar population models</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LOGCUBE-HYB10-MILESHC-MASTARSSP.fits.gz</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>MODELCUBE</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-LOGCUBE-HYB10-MILESHC-MASTARSSP.fits.gz</td><td>179163798</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232291699</td><td>SDSS</td><td>cube</td><td>sdss_manga_7443-12703</td><td>SDSS MaNGA Row-Stacked Spectra, with logarithmic wavelength sampling</td><td>S</td><td>mast:SDSS/manga/7443/12703/manga-7443-12703-LOGRSS.fits.gz</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>RSS</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>manga-7443-12703-LOGRSS.fits.gz</td><td>169503381</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>None</td></tr>
<tr><td>232325022</td><td>SDSS</td><td>measurements</td><td>sdss_manga_drpall</td><td>SDSS MaNGA Data Reduction Pipline (DRP) summary catalog. This provides collated summary tables on the observations and data reduction from MaNGA, including targeting information, photometry, and reduction quality for each observation.</td><td>D</td><td>mast:SDSS/manga/drpall-v3_1_1.fits</td><td>SCIENCE</td><td>--</td><td>MaNGA Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>drpall-v3_1_1.fits</td><td>75360960</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
<tr><td>232325023</td><td>SDSS</td><td>measurements</td><td>sdss_manga_dapall</td><td>SDSS MaNGA Data Analysis Pipeline (DAP) summary catalog.  This provides collated summary information from the analysis output of MaNGA observations, including distance and redshift estimates, stellar and gas velocities, and spectral index measurements.</td><td>D</td><td>mast:SDSS/manga/dapall-v3_1_1-3.1.0.fits</td><td>SCIENCE</td><td>--</td><td>MaNGA Catalogs</td><td>https://outerspace.stsci.edu/display/SDSS/MaNGA+Data+Products</td><td>MaNGA</td><td>v3_1_1</td><td>N/A</td><td>dapall-v3_1_1-3.1.0.fits</td><td>146030400</td><td>232291699</td><td>PUBLIC</td><td>3</td><td>--</td></tr>
</table></div></div></div>
</div>
<p>Now we will download some of these files using <code class="docutils literal notranslate"><span class="pre">Observations.download_products()</span></code>. To start, let’s download the preview image to see what this galaxy pair looks like. The parameters used are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">manga_products_list</span></code>: the list of products from the previous cell</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">productType='PREVIEW'</span></code>: limit the list to preview files only</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flat=True</span></code>: download the data into the current directory</p></li>
</ul>
<p>The download will print a status message when completed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">manga_products_list</span><span class="p">,</span> <span class="n">productType</span><span class="o">=</span><span class="s1">&#39;PREVIEW&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./12703.png with expected size 238960. [astroquery.query]
 Local Path  Status  Message URL 
----------- -------- ------- ----
./12703.png COMPLETE    None None
</pre></div>
</div>
</div>
</div>
<p>The Right Ascension (RA) and declination (Dec) coordinates for this image are contained in the file as a <a class="reference external" href="https://astropy-astrofrog.readthedocs.io/en/latest/wcs/">World Coordinate System (WCS)</a> axis. Using <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS()</span></code>, we can retrieve this information from the file and use it in the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_wcs_from_png</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Retrieves WCS information from png file &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">ii</span><span class="p">:</span>
        <span class="n">ww</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ii</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ww</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">ww</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="n">ww</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;WCSAXES&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">WCS</span><span class="p">(</span><span class="n">ww</span><span class="p">)</span>   
</pre></div>
</div>
</div>
</div>
<p>Now let’s plot this preview image to see what these galaxies look like!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open image file</span>
<span class="n">manga_preview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;12703.png&#39;</span><span class="p">))</span>

<span class="c1"># Set up plot using WCS projection from the file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">get_wcs_from_png</span><span class="p">(</span><span class="s1">&#39;12703.png&#39;</span><span class="p">))</span>

<span class="c1"># Show the image</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">manga_preview</span><span class="p">)</span>

<span class="c1"># Label title and axes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MaNGA Preview Image&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Right Ascension&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Declination&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/608085b83ddaf8a2c9405a3a6e1f0ca83384644442956217e92f3fd388efe6e0.png" src="../../../_images/608085b83ddaf8a2c9405a3a6e1f0ca83384644442956217e92f3fd388efe6e0.png" />
</div>
</div>
<p>Next, let’s download the <strong>Minimum Recommended Products</strong>. These are the recommended files to download for this MaNGA galaxy. You can select the Minimum Recommended Products using <code class="docutils literal notranslate"><span class="pre">mrp_only=True</span></code>. This will download 4 files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download Minimum Recommended Products</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">manga_products_list</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./manga-7443-12703-LOGCUBE-HYB10-MILESHC-MASTARSSP.fits.gz with expected size 179163798. [astroquery.query]
INFO: Found cached file ./manga-7443-12703-LOGCUBE.fits.gz with expected size 212028256. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./manga-7443-12703-LOGRSS.fits.gz with expected size 169503381. [astroquery.query]
INFO: Found cached file ./manga-7443-12703-MAPS-HYB10-MILESHC-MASTARSSP.fits.gz with expected size 11162876. [astroquery.query]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=4</i>
<table id="table139705021780496" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str58</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>./manga-7443-12703-LOGCUBE-HYB10-MILESHC-MASTARSSP.fits.gz</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./manga-7443-12703-LOGCUBE.fits.gz</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./manga-7443-12703-LOGRSS.fits.gz</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./manga-7443-12703-MAPS-HYB10-MILESHC-MASTARSSP.fits.gz</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p><a id="MaNGA-plot"></a></p>
</section>
<section id="plotting-velocity-and-flux-maps-from-manga">
<h2>Plotting velocity and flux maps from MaNGA<a class="headerlink" href="#plotting-velocity-and-flux-maps-from-manga" title="Link to this heading">#</a></h2>
<p>Now that the MaNGA data has been downloaded, we can plot some of the galaxy properties. The ManGA MAP file (<code class="docutils literal notranslate"><span class="pre">manga-7443-12703-MAPS-HYB10-MILESHC-MASTARSSP.fits.gz</span></code>) contains the output and results from the <a class="reference external" href="https://www.sdss4.org/dr17/manga/manga-analysis-pipeline/">MaNGA Data Analysis Pipeline (DAP)</a>. This example is based off of the <a class="reference external" href="https://www.sdss4.org/dr17/manga/manga-tutorials/dap-tutorial/dap-python-tutorial/">MaNGA DAP Python Tutorial</a>, and plots the g-band flux, the H-alpha emission line flux, and the stellar velocity field from MaNGA.</p>
<p>The full description of contents of the the MaNGA MAP file is <a class="reference external" href="https://data.sdss.org/datamodel/files/MANGA_SPECTRO_ANALYSIS/DRPVER/DAPVER/DAPTYPE/PLATE/IFU/manga-MAPS-DAPTYPE.html">available here</a>.</p>
<p>Let’s open the file and view some basic information:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open MaNGA MAP file</span>
<span class="n">manga_map</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;manga-7443-12703-MAPS-HYB10-MILESHC-MASTARSSP.fits.gz&#39;</span><span class="p">)</span>

<span class="c1"># Print information on file extensions</span>
<span class="n">manga_map</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: manga-7443-12703-MAPS-HYB10-MILESHC-MASTARSSP.fits.gz
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     147   ()      
  1  SPX_SKYCOO    1 ImageHDU        44   (74, 74, 2)   float32   
  2  SPX_ELLCOO    1 ImageHDU        49   (74, 74, 4)   float32   
  3  SPX_MFLUX     1 ImageHDU        37   (74, 74)   float32   
  4  SPX_MFLUX_IVAR    1 ImageHDU        38   (74, 74)   float32   
  5  SPX_SNR       1 ImageHDU        35   (74, 74)   float32   
  6  BINID         1 ImageHDU        46   (74, 74, 5)   int32   
  7  BIN_LWSKYCOO    1 ImageHDU        44   (74, 74, 2)   float32   
  8  BIN_LWELLCOO    1 ImageHDU        49   (74, 74, 4)   float32   
  9  BIN_AREA      1 ImageHDU        36   (74, 74)   float32   
 10  BIN_FAREA     1 ImageHDU        35   (74, 74)   float32   
 11  BIN_MFLUX     1 ImageHDU        38   (74, 74)   float32   
 12  BIN_MFLUX_IVAR    1 ImageHDU        39   (74, 74)   float32   
 13  BIN_MFLUX_MASK    1 ImageHDU        38   (74, 74)   int32   
 14  BIN_SNR       1 ImageHDU        35   (74, 74)   float32   
 15  STELLAR_VEL    1 ImageHDU        38   (74, 74)   float32   
 16  STELLAR_VEL_IVAR    1 ImageHDU        39   (74, 74)   float32   
 17  STELLAR_VEL_MASK    1 ImageHDU        38   (74, 74)   int32   
 18  STELLAR_SIGMA    1 ImageHDU        38   (74, 74)   float32   
 19  STELLAR_SIGMA_IVAR    1 ImageHDU        39   (74, 74)   float32   
 20  STELLAR_SIGMA_MASK    1 ImageHDU        38   (74, 74)   int32   
 21  STELLAR_SIGMACORR    1 ImageHDU        44   (74, 74, 2)   float32   
 22  STELLAR_FOM    1 ImageHDU        59   (74, 74, 9)   float32   
 23  EMLINE_SFLUX    1 ImageHDU        79   (74, 74, 35)   float32   
 24  EMLINE_SFLUX_IVAR    1 ImageHDU        80   (74, 74, 35)   float32   
 25  EMLINE_SFLUX_MASK    1 ImageHDU        79   (74, 74, 35)   int32   
 26  EMLINE_SEW    1 ImageHDU        79   (74, 74, 35)   float32   
 27  EMLINE_SEW_CNT    1 ImageHDU        77   (74, 74, 35)   float32   
 28  EMLINE_SEW_IVAR    1 ImageHDU        80   (74, 74, 35)   float32   
 29  EMLINE_SEW_MASK    1 ImageHDU        79   (74, 74, 35)   int32   
 30  EMLINE_GFLUX    1 ImageHDU        79   (74, 74, 35)   float32   
 31  EMLINE_GFLUX_IVAR    1 ImageHDU        80   (74, 74, 35)   float32   
 32  EMLINE_GFLUX_MASK    1 ImageHDU        79   (74, 74, 35)   int32   
 33  EMLINE_GEW    1 ImageHDU        79   (74, 74, 35)   float32   
 34  EMLINE_GEW_CNT    1 ImageHDU        77   (74, 74, 35)   float32   
 35  EMLINE_GEW_IVAR    1 ImageHDU        80   (74, 74, 35)   float32   
 36  EMLINE_GEW_MASK    1 ImageHDU        79   (74, 74, 35)   int32   
 37  EMLINE_GVEL    1 ImageHDU        79   (74, 74, 35)   float32   
 38  EMLINE_GVEL_IVAR    1 ImageHDU        80   (74, 74, 35)   float32   
 39  EMLINE_GVEL_MASK    1 ImageHDU        79   (74, 74, 35)   int32   
 40  EMLINE_GSIGMA    1 ImageHDU        79   (74, 74, 35)   float32   
 41  EMLINE_GSIGMA_IVAR    1 ImageHDU        80   (74, 74, 35)   float32   
 42  EMLINE_GSIGMA_MASK    1 ImageHDU        79   (74, 74, 35)   int32   
 43  EMLINE_INSTSIGMA    1 ImageHDU        77   (74, 74, 35)   float32   
 44  EMLINE_TPLSIGMA    1 ImageHDU        77   (74, 74, 35)   float32   
 45  EMLINE_GA     1 ImageHDU        77   (74, 74, 35)   float32   
 46  EMLINE_GANR    1 ImageHDU        76   (74, 74, 35)   float32   
 47  EMLINE_FOM    1 ImageHDU        59   (74, 74, 9)   float32   
 48  EMLINE_LFOM    1 ImageHDU        76   (74, 74, 35)   float32   
 49  SPECINDEX     1 ImageHDU       135   (74, 74, 46)   float32   
 50  SPECINDEX_IVAR    1 ImageHDU       136   (74, 74, 46)   float32   
 51  SPECINDEX_MASK    1 ImageHDU        90   (74, 74, 46)   int32   
 52  SPECINDEX_CORR    1 ImageHDU        87   (74, 74, 46)   float32   
 53  SPECINDEX_MODEL    1 ImageHDU        87   (74, 74, 46)   float32   
 54  SPECINDEX_BF    1 ImageHDU       135   (74, 74, 46)   float32   
 55  SPECINDEX_BF_IVAR    1 ImageHDU       136   (74, 74, 46)   float32   
 56  SPECINDEX_BF_MASK    1 ImageHDU        90   (74, 74, 46)   int32   
 57  SPECINDEX_BF_CORR    1 ImageHDU        87   (74, 74, 46)   float32   
 58  SPECINDEX_BF_MODEL    1 ImageHDU        87   (74, 74, 46)   float32   
 59  SPECINDEX_WGT    1 ImageHDU       135   (74, 74, 46)   float32   
 60  SPECINDEX_WGT_IVAR    1 ImageHDU       136   (74, 74, 46)   float32   
 61  SPECINDEX_WGT_MASK    1 ImageHDU        90   (74, 74, 46)   int32   
 62  SPECINDEX_WGT_CORR    1 ImageHDU        87   (74, 74, 46)   float32   
 63  SPECINDEX_WGT_MODEL    1 ImageHDU        87   (74, 74, 46)   float32   
</pre></div>
</div>
</div>
</div>
<p>To make the plot in the next cell, we will use three different extensions of the MAP file. Here is the description of each of these extensions from the <a class="reference external" href="https://data.sdss.org/datamodel/files/MANGA_SPECTRO_ANALYSIS/DRPVER/DAPVER/DAPTYPE/PLATE/IFU/manga-MAPS-DAPTYPE.html">data model</a>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SPX_MFLUX</span></code></p>
<ul>
<li><p>Description: “g-band-weighted mean flux, not corrected for Galactic extinction or internal attenuation.”</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">EMLINE_GFLUX</span></code></p>
<ul>
<li><p>Description: “gaussian profile integrated flux from a combined continuum+emission-line fit. The flux ratio of the [NeIII], [OIII], [OI], [NII], and [S III] lines are fixed and cannot be treated as independent measurements. The emission-line fluxes account for Galactic reddening using the E(B-V) (copied to the DAP primary headers, see the EBVGAL header keyword) value provided by the DRP header and assuming an O’Donnell (1994, ApJ, 422, 158) reddening law; however, no attenuation correction is applied for dust internal to the galaxy. See <a class="reference external" href="https://data.sdss.org/datamodel/files/MANGA_SPECTRO_ANALYSIS/DRPVER/DAPVER/DAPTYPE/PLATE/IFU/manga-MAPS-DAPTYPE.html#eml_gauss">here</a> for more information.”</p></li>
<li><p>Specifically, we will be using the H-alpha emission line flux from this extension</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">STELLAR_VEL</span></code></p>
<ul>
<li><p>Description: “Line-of-sight stellar velocity, relative to the input guess redshift (given as cz by the keyword SCINPVEL in the header of the PRIMARY extension, and most often identical to the NSA redshift).”</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#=========================================</span>
<span class="c1"># Set up Plot</span>
<span class="c1">#=========================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># Grab the WCS information from the header</span>
<span class="n">manga_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">manga_map</span><span class="p">[</span><span class="s1">&#39;SPX_MFLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">manga_wcs</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">manga_wcs</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">manga_wcs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Right Ascension&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Declination&#39;</span><span class="p">)</span>


<span class="c1">#=========================================</span>
<span class="c1"># Subplot 1: MaNGA Flux Map</span>
<span class="c1">#=========================================</span>
<span class="c1"># The &#39;SPX_MFLUX&#39; ext contains the g-band-weighted mean flux</span>
<span class="n">manga_flux</span> <span class="o">=</span> <span class="n">manga_map</span><span class="p">[</span><span class="s1">&#39;SPX_MFLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">manga_flux</span><span class="p">[</span><span class="n">manga_flux</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="c1"># mask for quality data</span>

<span class="c1"># Plot image</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">manga_flux</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MaNGA g-band Flux&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Flux [$10^{-17}$ erg/s/cm$^</span><span class="si">{2}</span><span class="s1">$/Å/spaxel]&#39;</span><span class="p">,</span>
             <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
             

<span class="c1">#=========================================</span>
<span class="c1"># Subplot 2: MaNGA H-Alpha Emission Map</span>
<span class="c1">#=========================================</span>

<span class="c1"># Define the emission line indexes for this ext</span>
<span class="n">emline</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">manga_map</span><span class="p">[</span><span class="s1">&#39;EMLINE_GFLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">emline</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        
<span class="c1"># The &#39;EMLINE_GFLUX&#39; ext contains the emission line measurements</span>
<span class="n">h_alpha_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">manga_map</span><span class="p">[</span><span class="s1">&#39;EMLINE_GFLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;Ha-6564&#39;</span><span class="p">]])</span>
<span class="n">h_alpha_flux</span><span class="p">[</span><span class="n">h_alpha_flux</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="c1"># mask for quality data</span>

<span class="c1"># Plot image</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">h_alpha_flux</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;H-$\alpha$ Emission [$10^{-17}$ erg/s/cm$^</span><span class="si">{2}</span><span class="s1">$/spaxel]&#39;</span><span class="p">,</span>
             <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;H-$\alpha$ Emission&#39;</span><span class="p">)</span>

<span class="c1">#=========================================</span>
<span class="c1"># Subplot 3: MaNGA Stellar Velocity Field</span>
<span class="c1">#=========================================</span>
<span class="c1"># The &#39;STELLAR_VEL&#39; ext contains the stellar velocity measurements</span>
<span class="n">qual_mask</span> <span class="o">=</span> <span class="n">manga_map</span><span class="p">[</span><span class="s1">&#39;STELLAR_VEL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;QUALDATA&#39;</span><span class="p">]</span> <span class="c1"># mask for quality data</span>
<span class="n">velocity_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">(</span><span class="n">manga_map</span><span class="p">[</span><span class="s1">&#39;STELLAR_VEL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                 <span class="n">mask</span><span class="o">=</span><span class="n">manga_map</span><span class="p">[</span><span class="n">qual_mask</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># plot Image</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">velocity_map</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> 
                <span class="n">vmin</span><span class="o">=-</span><span class="mi">125</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Stellar Velocity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Stellar Velocity [km/s]&#39;</span><span class="p">,</span>
             <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>

<span class="c1">#plt.subplots_adjust(hspace=0)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/5a9b5b17353ebe2424f6521419c98871441ad2d7f7784bf27b198eeb9cd8c7d8.png" src="../../../_images/5a9b5b17353ebe2424f6521419c98871441ad2d7f7784bf27b198eeb9cd8c7d8.png" />
</div>
</div>
<hr class="docutils" />
<p><a id="HST"></a>
<a id="HST-query"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="searching-for-hst-observations-of-this-galaxy">
<h1>Searching for HST observations of this galaxy<a class="headerlink" href="#searching-for-hst-observations-of-this-galaxy" title="Link to this heading">#</a></h1>
<section id="coordinate-search-using-astroquery-mast">
<h2>Coordinate search using astroquery.mast<a class="headerlink" href="#coordinate-search-using-astroquery-mast" title="Link to this heading">#</a></h2>
<p>Now let’s search for HST obersvations of this same galaxy. Similar to before, we will be using <code class="docutils literal notranslate"><span class="pre">Observations.query_criteria()</span></code> to search the MAST archive, but this time, we will search for HST observations (<code class="docutils literal notranslate"><span class="pre">obs_collection='HST'</span></code>) near the coordinates of this MaNGA galaxy pair.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve RA and DEC of MaNGA observations</span>
<span class="n">ra</span> <span class="o">=</span> <span class="n">manga_obs_list</span><span class="p">[</span><span class="s1">&#39;s_ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dec</span> <span class="o">=</span> <span class="n">manga_obs_list</span><span class="p">[</span><span class="s1">&#39;s_dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># make a SkyCoord object from these coordinates</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>

<span class="c1"># Search for HST observations based on coordinates</span>
<span class="n">hst_obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="c1"># Search by coordinates</span>
                                      <span class="n">coordinates</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> 
                                      <span class="c1"># Search for HST observations</span>
                                      <span class="n">obs_collection</span><span class="o">=</span><span class="s1">&#39;HST&#39;</span><span class="p">,</span>
                                      <span class="c1"># Select only Science observations (not calibration files)</span>
                                      <span class="n">intentType</span><span class="o">=</span><span class="s1">&#39;science&#39;</span><span class="p">,</span>
                                      <span class="c1"># Select calibrated reduced observations</span>
                                      <span class="n">provenance_name</span><span class="o">=</span><span class="s1">&#39;CAL*&#39;</span><span class="p">)</span> 

<span class="c1"># Display Results</span>
<span class="n">hst_obs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    (229.52558, 42.745842)&gt;
</pre></div>
</div>
<div class="output text_html"><div><i>Table masked=True length=3</i>
<table id="table139705020506768" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>objID</th><th>objID1</th><th>distance</th></tr></thead>
<thead><tr><th>str7</th><th>str3</th><th>str6</th><th>str7</th><th>str3</th><th>str5</th><th>str8</th><th>str6</th><th>str72</th><th>str9</th><th>float64</th><th>float64</th><th>str5</th><th>str16</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str92</th><th>float64</th><th>str5</th><th>str2</th><th>int64</th><th>str1018</th><th>str34</th><th>str35</th><th>str6</th><th>bool</th><th>float64</th><th>str8</th><th>str9</th><th>str9</th><th>float64</th></tr></thead>
<tr><td>science</td><td>HST</td><td>CALACS</td><td>ACS/WFC</td><td>HST</td><td>F435W</td><td>OPTICAL</td><td>VV705</td><td>GALAXY;INTERACTING GALAXY</td><td>j9cv55010</td><td>229.52625</td><td>42.74361111111</td><td>image</td><td>Evans, Aaron S.</td><td>3</td><td>53688.666267974535</td><td>53688.685249456015</td><td>1320.0</td><td>370.0</td><td>479.99999999999994</td><td>An ACS Survey of a Complete Sample of Luminous Infrared Galaxies in the Local Universe</td><td>54054.37582171</td><td>10592</td><td>GO</td><td>--</td><td>POLYGON -130.43192424000009 42.709320519999878 -130.43365449999982 42.737909309999957 -130.4337529317022 42.737911043013639 -130.43380304000004 42.738738559999888 -130.43390147880342 42.738740292976125 -130.43395158999988 42.739567809999961 -130.4342075292484 42.739572315111893 -130.4360726999999 42.765917500000093 -130.43616278895598 42.765919959882218 -130.43622134999993 42.766746739999988 -130.43631144527563 42.766749199904545 -130.43637000999993 42.767575989999933 -130.51272945999986 42.769635319999914 -130.51073934999991 42.742010469999961 -130.51064930025817 42.742008068768754 -130.51058976999991 42.741181329999925 -130.51049972627087 42.741178928778268 -130.51047888276389 42.740889446885376 -130.51120778999976 42.740901790000045 -130.50944171000017 42.712314169999942 -130.50934332360208 42.712312501929482 -130.50929222999994 42.711485029999928 -130.50919384069635 42.711483361716873 -130.50914275000005 42.710655890000126 -130.43192424000009 42.709320519999878 -130.43192424000009 42.709320519999878</td><td>mast:HST/product/j9cv55010_drz.jpg</td><td>mast:HST/product/j9cv55010_drz.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24826349</td><td>904034532</td><td>904034532</td><td>0.0</td></tr>
<tr><td>science</td><td>HST</td><td>CALACS</td><td>ACS/WFC</td><td>HST</td><td>F814W</td><td>OPTICAL</td><td>VV705</td><td>GALAXY;INTERACTING GALAXY</td><td>j9cv55020</td><td>229.52625</td><td>42.74361111111</td><td>image</td><td>Evans, Aaron S.</td><td>3</td><td>53688.73142982639</td><td>53688.74207797454</td><td>760.0</td><td>708.0</td><td>959.0</td><td>An ACS Survey of a Complete Sample of Luminous Infrared Galaxies in the Local Universe</td><td>54054.39680547</td><td>10592</td><td>GO</td><td>--</td><td>POLYGON -130.43207268999996 42.710149770000072 -130.43380304000004 42.738738559999888 -130.43390147880342 42.738740292976125 -130.43395158999988 42.739567809999961 -130.43429750999272 42.739573898841904 -130.43622134999993 42.766746739999988 -130.43631144527563 42.766749199904545 -130.43637000999993 42.767575989999933 -130.51272945999986 42.769635319999914 -130.51073934999991 42.742010469999961 -130.51064930025817 42.742008068768754 -130.51058976999991 42.741181329999925 -130.48078808475617 42.740382738212219 -130.51120778999976 42.740901790000045 -130.50944171000017 42.712314169999942 -130.50934332360208 42.712312501929482 -130.50929222999994 42.711485029999928 -130.43207268999996 42.710149770000072 -130.43207268999996 42.710149770000072</td><td>mast:HST/product/j9cv55020_drz.jpg</td><td>mast:HST/product/j9cv55020_drz.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24826350</td><td>903974953</td><td>903974953</td><td>0.0</td></tr>
<tr><td>science</td><td>HST</td><td>CALWF3</td><td>WFC3/IR</td><td>HST</td><td>F160W</td><td>INFRARED</td><td>VV-705</td><td>GALAXY;INTERACTING GALAXY;MULTIPLE NUCLEI;ULTRALUMINOUS IR GAL;STARBURST</td><td>ia1e42010</td><td>229.52625</td><td>42.74361111111</td><td>image</td><td>Surace, Jason A.</td><td>3</td><td>55191.08020185185</td><td>55191.14344517361</td><td>2395.398924</td><td>1393.8999999999999</td><td>1692.4</td><td>HST NICMOS Survey of the Nuclear Regions of Luminous Infrared Galaxies in the Local Universe</td><td>55556.22577551</td><td>11235</td><td>GO</td><td>--</td><td>POLYGON -130.45141896 42.72726823 -130.45139424562964 42.727623085811551 -130.45085739 42.72760092 -130.45083267175158 42.727955780706409 -130.45029576000002 42.72793361 -130.44791957 42.76202341 -130.44881279242628 42.762060290893743 -130.44877189 42.76264689 -130.50066389 42.76477749 -130.50068833934091 42.764422591918347 -130.50122566 42.76444453 -130.50125010335393 42.764089669031847 -130.5017873 42.7641116 -130.50413399 42.73002074 -130.50324120188574 42.729984288688932 -130.50328157 42.72939763 -130.45141896 42.72726823 -130.45141896 42.72726823</td><td>mast:HST/product/ia1e42010_drz.jpg</td><td>mast:HST/product/ia1e42010_drz.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24794549</td><td>909816807</td><td>909816807</td><td>0.0</td></tr>
</table></div></div></div>
</div>
<p>The table of results shown above tells us that there are three observations of this galaxy from HST, in three different filters: F160W, F435W, and F814W. Let’s see what data products are available associated with these observations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hst_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">hst_obs</span><span class="p">)</span>

<span class="c1"># Filter product list </span>
<span class="n">hst_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">hst_products</span><span class="p">,</span>
                                            <span class="c1"># Select science files</span>
                                            <span class="n">productType</span><span class="o">=</span><span class="s2">&quot;SCIENCE&quot;</span><span class="p">,</span>
                                            <span class="c1"># Recommended Products</span>
                                            <span class="n">productGroupDescription</span><span class="o">=</span><span class="s2">&quot;Minimum Recommended Products&quot;</span><span class="p">,</span> 
                                            <span class="c1"># Select DRZ files - the calibrated combined images</span>
                                            <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="s1">&#39;DRZ&#39;</span><span class="p">)</span>
<span class="n">hst_products</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=3</i>
<table id="table139705008259728" class="table-striped table-bordered table-condensed">
<thead><tr><th>obsID</th><th>obs_collection</th><th>dataproduct_type</th><th>obs_id</th><th>description</th><th>type</th><th>dataURI</th><th>productType</th><th>productGroupDescription</th><th>productSubGroupDescription</th><th>productDocumentationURL</th><th>project</th><th>prvversion</th><th>proposal_id</th><th>productFilename</th><th>size</th><th>parent_obsid</th><th>dataRights</th><th>calib_level</th><th>filters</th></tr></thead>
<thead><tr><th>str8</th><th>str3</th><th>str5</th><th>str35</th><th>str64</th><th>str1</th><th>str95</th><th>str9</th><th>str28</th><th>str11</th><th>str1</th><th>str7</th><th>str20</th><th>str5</th><th>str50</th><th>int64</th><th>str8</th><th>str6</th><th>int64</th><th>str9</th></tr></thead>
<tr><td>24794549</td><td>HST</td><td>image</td><td>ia1e42010</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/ia1e42010_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALWF3</td><td>3.7.2 (Apr-15-2024)</td><td>11235</td><td>ia1e42010_drz.fits</td><td>13587840</td><td>24794549</td><td>PUBLIC</td><td>3</td><td>F160W</td></tr>
<tr><td>24826349</td><td>HST</td><td>image</td><td>j9cv55010</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/j9cv55010_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALACS</td><td>DrizzlePac 3.10.0</td><td>10592</td><td>j9cv55010_drz.fits</td><td>221209920</td><td>24826349</td><td>PUBLIC</td><td>3</td><td>F435W</td></tr>
<tr><td>24826350</td><td>HST</td><td>image</td><td>j9cv55020</td><td>DADS DRZ file - Calibrated combined image ACS/WFC3/WFPC2/STIS</td><td>D</td><td>mast:HST/product/j9cv55020_drz.fits</td><td>SCIENCE</td><td>Minimum Recommended Products</td><td>DRZ</td><td>--</td><td>CALACS</td><td>DrizzlePac 3.10.0</td><td>10592</td><td>j9cv55020_drz.fits</td><td>217800000</td><td>24826350</td><td>PUBLIC</td><td>3</td><td>F814W</td></tr>
</table></div></div></div>
</div>
<p>With our products selected, we can proceed to download. We’ll use <code class="docutils literal notranslate"><span class="pre">flat=True</span></code> to put them all into the same directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download products</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">hst_products</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./ia1e42010_drz.fits with expected size 13587840. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file ./j9cv55010_drz.fits with expected size 221209920. [astroquery.query]
INFO: Found cached file ./j9cv55020_drz.fits with expected size 217800000. [astroquery.query]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=3</i>
<table id="table139705021471056" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str20</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>./ia1e42010_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./j9cv55010_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./j9cv55020_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p><a id="HST-plot"></a></p>
</section>
<section id="plot-the-hst-images">
<h2>Plot the HST images<a class="headerlink" href="#plot-the-hst-images" title="Link to this heading">#</a></h2>
<p>Let’s plot the three HST images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open files</span>
<span class="n">f160w</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;ia1e42010_drz.fits&#39;</span><span class="p">)</span>
<span class="n">f435w</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;j9cv55010_drz.fits&#39;</span><span class="p">)</span>
<span class="n">f814w</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;j9cv55020_drz.fits&#39;</span><span class="p">)</span>


<span class="n">f160w_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">f160w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">f435w_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">f814w_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">f814w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

<span class="c1">#=========================================</span>
<span class="c1"># Set up Plot</span>
<span class="c1">#=========================================</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">f160w_wcs</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">f435w_wcs</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">f814w_wcs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Right Ascension&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Declination&#39;</span><span class="p">)</span>

<span class="c1">#=========================================</span>
<span class="c1"># Subplot 1: F160W filter image</span>
<span class="c1">#=========================================</span>
<span class="c1"># Note - this image is upside-down compared to the other two</span>
<span class="n">fits_file</span> <span class="o">=</span> <span class="n">f160w</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;INSTRUME&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILTER&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#=========================================</span>
<span class="c1"># Subplot 2: F435W filter image</span>
<span class="c1">#=========================================</span>
<span class="n">fits_file</span> <span class="o">=</span> <span class="n">f435w</span>
<span class="n">wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;INSTRUME&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILTER2&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#=========================================</span>
<span class="c1"># Subplot 3: F814W filter image</span>
<span class="c1">#=========================================</span>
<span class="n">fits_file</span> <span class="o">=</span> <span class="n">f814w</span>
<span class="n">wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;INSTRUME&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">fits_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILTER2&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/25ad34e59e7641261faf32192d98f56ce6c4fe59d952d248cdf5fd78786d1be0.png" src="../../../_images/25ad34e59e7641261faf32192d98f56ce6c4fe59d952d248cdf5fd78786d1be0.png" />
</div>
</div>
<p><a id="HST-colorize"></a></p>
</section>
<section id="colorizing-hst-images-with-astropy">
<h2>Colorizing HST images with astropy<a class="headerlink" href="#colorizing-hst-images-with-astropy" title="Link to this heading">#</a></h2>
<p>We can combine all three HST images here and colorize them using the <code class="docutils literal notranslate"><span class="pre">make_lupton_rgb()</span></code> function from astropy. This function takes image data from three filter images, and combines them as an RGB image. In this example, we will order by wavelength and map the IR filter (F160W) to the red channel (‘r’), the F814W filter to the green channel (‘g’), and the F435W filter to the blue channel (‘b’).</p>
<p>Before we colorize the images, however, we need to reproject them onto the same coordinate system. We will resample the F160W and F814W images to the same projection as the F435W image, because the F435W image is the largest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print image shapes:</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F160W shape: </span><span class="si">{</span><span class="n">f160w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F814W shape: </span><span class="si">{</span><span class="n">f814w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F435W shape: </span><span class="si">{</span><span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Reproject all three HST images into the same frame (using F435W image as base)</span>
<span class="c1"># This may take about a minute.</span>
<span class="n">r</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">reproject</span><span class="o">.</span><span class="n">reproject_interp</span><span class="p">(</span><span class="n">f160w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">g</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">reproject</span><span class="o">.</span><span class="n">reproject_interp</span><span class="p">(</span><span class="n">f814w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">b</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">reproject</span><span class="o">.</span><span class="n">reproject_interp</span><span class="p">(</span><span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

<span class="c1"># Colorize image using the three filters</span>
<span class="n">hst_image</span> <span class="o">=</span> <span class="n">make_lupton_rgb</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F160W shape: (996, 1124)
F814W shape: (4297, 4221)
F435W shape: (4358, 4227)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/micromamba/envs/ci-env/lib/python3.11/site-packages/astropy/visualization/basic_rgb.py:153: RuntimeWarning: invalid value encountered in cast
  return image_rgb.astype(output_dtype)
</pre></div>
</div>
</div>
</div>
<p>Our reprojection and colorization is complete! Let’s now plot the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">f435w_wcs</span><span class="p">)</span>

<span class="c1"># Plot image</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hst_image</span><span class="p">)</span>

<span class="c1"># Zoom in</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1800</span><span class="p">,</span> <span class="mi">2600</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2900</span><span class="p">)</span>

<span class="c1"># Label Plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Right Ascension&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Declination&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;HST Image (colorized)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/6696c2916977df889a2829fa1814fe5039431bb2cdb02d0c021adc5553f60501.png" src="../../../_images/6696c2916977df889a2829fa1814fe5039431bb2cdb02d0c021adc5553f60501.png" />
</div>
</div>
<p>This image looks great! There are certainly a few places where bright spots in one image are affecting the final result; this can be seen as the green speckles across the lower third of the image.</p>
<hr class="docutils" />
<p><a id="HST-MaNGA"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="combining-manga-and-hst-data">
<h1>Combining MaNGA and HST data<a class="headerlink" href="#combining-manga-and-hst-data" title="Link to this heading">#</a></h1>
<p>Now that we have downloaded both MaNGA and HST data, let’s combine them into one plot to map some of properties of this merging pair of galaxies!</p>
<p>The key to combining the HST and MaNGA data is the <a class="reference external" href="https://astropy-astrofrog.readthedocs.io/en/latest/wcs/">World Coordinate System (WCS)</a> transformations done by astropy. Using information from the file headers, <code class="docutils literal notranslate"><span class="pre">astropy.wcs()</span></code> will calculate the RA and DEC coordinates corresponding to each pixel in the image, allowing us to project both datasets on the same figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Store WCS for easy coordinate transformations</span>
<span class="n">hst_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">manga_wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">manga_map</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

<span class="c1">#=========================================</span>
<span class="c1"># Set up Plot</span>
<span class="c1">#=========================================</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">hst_wcs</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">hst_wcs</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">hst_wcs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]:</span>
    <span class="c1"># Zoom in</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span> <span class="mi">2550</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">2300</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
    <span class="c1"># Label Axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;RA&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Dec&#39;</span><span class="p">)</span>
    <span class="c1"># Plot Grid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    
<span class="c1">#=========================================</span>
<span class="c1"># Subplot 1: HST Image</span>
<span class="c1">#=========================================</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hst_image</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;HST Image (colorized)&#39;</span><span class="p">)</span>

<span class="c1">#=========================================</span>
<span class="c1"># Subplot 2: MaNGA H-alpha Emission</span>
<span class="c1">#=========================================</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;MaNGA H-$\alpha$ Flux&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;[$10^{-17}$ erg/s/cm$^</span><span class="si">{2}</span><span class="s1">$/spaxel]&#39;</span><span class="p">)</span>

<span class="n">h_alpha_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">manga_map</span><span class="p">[</span><span class="s1">&#39;EMLINE_GFLUX&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">emline</span><span class="p">[</span><span class="s1">&#39;Ha-6564&#39;</span><span class="p">]])</span>
<span class="n">h_alpha_flux</span><span class="p">[</span><span class="n">h_alpha_flux</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="c1"># mask for quality data</span>


<span class="c1"># Plot H-alpha flux</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">h_alpha_flux</span><span class="p">),</span>
           <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">manga_wcs</span><span class="p">),</span>
           <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot MaNGA contours</span>
<span class="n">contour_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">contour_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contour_levels</span><span class="p">]</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">label_level</span><span class="p">,</span> <span class="n">label_string</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">contour_levels</span><span class="p">,</span> <span class="n">contour_labels</span><span class="p">):</span>
    <span class="n">fmt</span><span class="p">[</span><span class="n">label_level</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_string</span>

<span class="n">contours</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">h_alpha_flux</span><span class="p">,</span>
                       <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">manga_wcs</span><span class="p">),</span>
                       <span class="n">levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">contours</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>


<span class="c1">#=========================================</span>
<span class="c1"># Subplot 3: HST + MaNGA</span>
<span class="c1">#=========================================</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;HST + MaNGA H-$\alpha$ Contours&#39;</span><span class="p">)</span>

<span class="c1"># Plot background HST image</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hst_image</span><span class="p">)</span>
    
<span class="c1"># Plot MaNGA contours</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">h_alpha_flux</span><span class="p">,</span>
                       <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">manga_wcs</span><span class="p">),</span>
                       <span class="n">levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">contours</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/c90639054117f2763691ac036fe34164b2b080da069ca56aa8248cd600ccdf64.png" src="../../../_images/c90639054117f2763691ac036fe34164b2b080da069ca56aa8248cd600ccdf64.png" />
</div>
</div>
<p>This plot encapsulates everything we have learned so far, showing the colorized HST image (left), the H-alpha flux from MaNGA (middle), and combining them both into a single image (right).</p>
<p><a id="HST-MaNGA-Halpha"></a></p>
<section id="creating-an-h-alpha-emission-map">
<h2>Creating an H-alpha Emission Map<a class="headerlink" href="#creating-an-h-alpha-emission-map" title="Link to this heading">#</a></h2>
<p>We can isolate the last panel and plot it by itself, too.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">hst_wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">2550</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">2350</span><span class="p">,</span> <span class="mi">2900</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Right Ascension&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Declination&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;HST Image + H-$\alpha$ Emission from MaNGA&#39;</span><span class="p">)</span>

<span class="c1"># Plot the HST image</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hst_image</span><span class="p">)</span>


<span class="c1"># Plot MaNGA contours</span>
<span class="n">contour_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">contour_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contour_levels</span><span class="p">]</span>
<span class="n">contour_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;1 $\times10^{-17}$ erg/s/cm$^</span><span class="si">{2}</span><span class="s1">$/spaxel&#39;</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">label_level</span><span class="p">,</span> <span class="n">label_string</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">contour_levels</span><span class="p">,</span> <span class="n">contour_labels</span><span class="p">):</span>
    <span class="n">fmt</span><span class="p">[</span><span class="n">label_level</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_string</span>

<span class="n">contours</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">h_alpha_flux</span><span class="p">,</span>
                      <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">manga_wcs</span><span class="p">),</span>
                      <span class="n">levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">contours</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;manga_halpha_map.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0d40cd5422860b5783bcc07548f39fb68339d4d37da83ec7452c844f2cee0cd7.png" src="../../../_images/0d40cd5422860b5783bcc07548f39fb68339d4d37da83ec7452c844f2cee0cd7.png" />
</div>
</div>
<p>In this figure, we can see that the H-alpha flux from MaNGA follows the spiral arms of the top galaxy, and the emission is strongest near the center of both galaxies.</p>
<p><a id="HST-MaNGA-Velocity"></a></p>
</section>
<section id="plotting-the-stellar-velocity-field">
<h2>Plotting the stellar velocity field<a class="headerlink" href="#plotting-the-stellar-velocity-field" title="Link to this heading">#</a></h2>
<p>Last but not least, let’s do the same thing with the stellar velocity! The stellar velocity field from MaNGA will show which parts of the galaxies are redshifted (moving away from us, which we will plot in red), and which parts are blueshifted (moving toward us, which we will plot in blue).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">WCS</span><span class="p">(</span><span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span>
          <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">WCS</span><span class="p">(</span><span class="n">f435w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">2550</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">2350</span><span class="p">,</span> <span class="mi">2900</span><span class="p">)</span>

<span class="n">bin_indx</span> <span class="o">=</span> <span class="n">manga_map</span><span class="p">[</span><span class="s1">&#39;BINID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">unique_bins</span><span class="p">,</span> <span class="n">unique_indices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
                                        <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">bin_indx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>

<span class="n">x_pix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">74</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">74</span><span class="p">)])[</span><span class="n">unique_indices</span><span class="p">]</span>
<span class="n">y_pix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">74</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">74</span><span class="p">)])[</span><span class="n">unique_indices</span><span class="p">]</span>
<span class="n">v_map</span> <span class="o">=</span> <span class="n">velocity_map</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">unique_indices</span><span class="p">]</span>

<span class="c1"># Get the luminosity-weighted x and y coordinates of the unique bins</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_pix</span><span class="p">,</span> <span class="n">y_pix</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">v_map</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">vmin</span><span class="o">=-</span><span class="mi">150</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">,</span> 
                <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">manga_wcs</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Stellar Velocity [km/s]&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Right Ascension&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Declination&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Stellar Velocity from MaNGA&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;manga_velocity_map.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/df471cf19148db47dd09e221b5ee619dcd2c9d331c3d5e71c9c27697a10b8dc8.png" src="../../../_images/df471cf19148db47dd09e221b5ee619dcd2c9d331c3d5e71c9c27697a10b8dc8.png" />
</div>
</div>
<p>This plot shows that this galaxy pair is rotating vertically (from the perspective of this image). The arm in the upper galaxy is blueshifted, while most of the lower galaxy, and the end of the arm is redshifted.</p>
<hr class="docutils" />
<p>Congratulations! You have reached the end of this tutorial notebook. You have learned how to access and download MaNGA data from MAST, and combine it with HST images to map different properties for this merging pair of galaxies.</p>
<p><a id="Resources"></a></p>
</section>
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Link to this heading">#</a></h2>
<p>Additional resources are linked below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://archive.stsci.edu/missions-and-data/sdss">SDSS Legacy Archive at MAST</a></p></li>
<li><p><a class="reference external" href="https://www.sdss4.org/surveys/manga/">SDSS-IV MaNGA Survey</a></p></li>
<li><p><a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html">astroquery.mast User Manual</a></p></li>
<li><p><a class="reference external" href="https://mast.stsci.edu/api/v0/index.html">MAST API</a></p></li>
</ul>
</section>
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Link to this heading">#</a></h2>
<p><a id="Citations"></a></p>
<p>If you use MaNGA data for published research, see the following links for information on which citations to include in your paper:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://sdss.org/collaboration/citing-sdss/">Citing SDSS</a></p></li>
<li><p><a class="reference external" href="https://www.sdss4.org/dr17/manga/manga-technical-papers/">Citing MaNGA</a></p></li>
<li><p><a class="reference external" href="https://archive.stsci.edu/publishing/mission-acknowledgements">Citing MAST</a></p></li>
<li><p><a class="reference external" href="https://www.astropy.org/acknowledging.html">Citing astropy</a></p></li>
</ul>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Link to this heading">#</a></h2>
<p><a id="About"></a></p>
<p>For questions or issues with this notebook, you can open a github issue or email archive&#64;stsci.edu.</p>
<p><strong>Authors:</strong> Julie Imig, Brian Cherinka <br>
<strong>Keywords:</strong> Tutorial, SDSS, MaNGA, HST, galaxies <br>
<strong>First published:</strong> October 2024 <br>
<strong>Last updated:</strong> October 2024 <br></p>
<hr class="docutils" />
<p><a class="reference internal" href="#top"><span class="xref myst">Top of Page</span></a>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/style-guides/master/guides/images/stsci-logo.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/style-guides/master/guides/images/stsci-logo.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/SDSS/MaNGA_HST_tutorial"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../sdss.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Sloan Digital Sky Survey (SDSS)</p>
      </div>
    </a>
    <a class="right-next"
       href="../APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Characterizing Variable Stars with APOGEE + TESS</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Mapping Galaxy Properties with MaNGA + HST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-manga-data-at-mast">Accessing MaNGA data at MAST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-all-manga-data">Querying all MaNGA data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-specific-galaxy">Searching for a specific galaxy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-manga-data-products">Downloading MaNGA data products</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-velocity-and-flux-maps-from-manga">Plotting velocity and flux maps from MaNGA</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-hst-observations-of-this-galaxy">Searching for HST observations of this galaxy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-search-using-astroquery-mast">Coordinate search using astroquery.mast</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-hst-images">Plot the HST images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colorizing-hst-images-with-astropy">Colorizing HST images with astropy</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-manga-and-hst-data">Combining MaNGA and HST data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-an-h-alpha-emission-map">Creating an H-alpha Emission Map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-stellar-velocity-field">Plotting the stellar velocity field</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>