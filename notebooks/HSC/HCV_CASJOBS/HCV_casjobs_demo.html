
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hubble Catalog of Variables Notebook (CasJobs version) &#8212; MAST Notebook Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css?v=cd6c26fb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css?v=32d70693" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-SK672ZMP7G"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/HSC/HCV_CASJOBS/HCV_casjobs_demo';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Exploring UV Extinction Curves" href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html" />
    <link rel="prev" title="Hubble Catalog of Variables Notebook (API version)" href="../HCV_API/HCV_API_demo.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/mastlogo.svg" class="logo__image only-light" alt="MAST Notebook Repository - Home"/>
    <script>document.write(`<img src="../../../_static/mastlogo.svg" class="logo__image only-dark" alt="MAST Notebook Repository - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to the MAST Notebook Repository!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">GALEX</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../GALEX/mis_mosaic/mis_mosaic.html">Surveying dust structure via GALEX MIS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HSC</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../queries.html">Intro HSC Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../HSCV3_API/hscv3_api.html">Hubble Source Catalog API Notebook</a></li>



<li class="toctree-l2"><a class="reference internal" href="../HSCV3_SMC_API/hscv3_smc_api.html">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</a></li>



<li class="toctree-l2"><a class="reference internal" href="../HSC_TAP/HSC_TAP.html">MAST Table Access Protocol Hubble Source Catalog Demo</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../SWEEPS.html">SWEEPS Queries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../SWEEPS_HSCV3P1/sweeps_hscv3p1.html">Hubble Source Catalog SWEEPS Proper Motion (CasJobs Version)</a></li>






















<li class="toctree-l2"><a class="reference internal" href="../SWEEPS_HSCV3P1_API/sweeps_hscv3p1_api.html">Hubble Source Catalog SWEEPS Proper Motion (API Version)</a></li>









</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../HCV.html">Hubble Catalog of Variables (HCV) Queries</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../HCV_API/HCV_API_demo.html">Hubble Catalog of Variables Notebook (API version)</a></li>



<li class="toctree-l2 current active"><a class="current reference internal" href="#">Hubble Catalog of Variables Notebook (CasJobs version)</a></li>



</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">IUE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html">Exploring UV Extinction Curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JWST</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">Accessing JWST Proposal Data in astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/duplication_checking/duplication_checking.html">JWST Duplication Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">JWST Engineering Data Retrieval</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/SI_keyword_exoplanet_search/SI_keyword_exoplanet_search.html">JWST SI Keyword Search for Exoplanet Spectra</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/MAST_metadata_search/MAST_metadata_search.html">Astroquery: Exploring Metadata from the James Webb Space Telescope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_lightcurves/plotting_lightcurves.html">Using Kepler Data to Plot a Light Curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_images_from_tpf/plotting_images_from_tpf.html">Plotting Images from Kepler Target Pixel Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_dvts/plotting_dvts.html">Read and Plot A Kepler Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_catalog_over_FFI/plotting_catalog_over_FFI.html">Plotting a Catalog over a Kepler Full Frame Image File</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/lightkurve.html">Lightkurve</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_lc_products/lightkurve_analyzing_lc_products.html">Using <em>Kepler</em> Light Curve Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_tpf_products/lightkurve_analyzing_tpf_products.html">Using <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_searching_for_data/lightkurve_searching_for_data.html">Searching for <em>Kepler</em>/<em>K2</em> and <em>TESS</em> Data Products Using Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_custom_aperture_photometry/lightkurve_custom_aperture_photometry.html">Creating Your Own Light Curves using Custom Aperture Photometry</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_combining_multiple_quarters/lightkurve_combining_multiple_quarters.html">Combining Multiple Quarters of <em>Kepler</em> Data with Lightkurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_interactively_inspecting_TPFs_and_LCs/lightkurve_interactively_inspecting_TPFs_and_LCs.html">Interactively Inspecting Target Pixel Files and Light Curves</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/inst_noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_1_data_gaps_and_quality_flags/instrumental_noise_1_data_gaps_and_quality_flags.html">Data Gaps and Quality Flags</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_2_spurious_signals_and_time_sampling_effects/instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">Spurious Signals and Time Sampling Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_3_seasonal_and_detector_effects/instrumental_noise_3_seasonal_and_detector_effects.html">Seasonal and Detector Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_4_electronic_noise/instrumental_noise_4_electronic_noise.html">Electronic Noise</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/signals.html">Identifying Periodic Signals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/identifying_transiting_planet_signals/identifying_transiting_planet_signals.html">Identifying Transiting Planet Signals in a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/measuring_a_rotation_period/measuring_a_rotation_period.html">Measuring and Removing a Rotation Period Signal from a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/visualizing_periodic_signals_using_a_river_plot/visualizing_periodic_signals_using_a_river_plot.html">Visualizing Periodic Signals Using a River Plot</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/verifying_the_location_of_a_signal/verifying_the_location_of_a_signal.html">Verifying the Location of a Signal in <em>Kepler</em> Pixel Data</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/periodograms.html">Periodograms &amp; Asteroseismology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/creating_periodograms/creating_periodograms.html">Creating Periodograms</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">How to Understand and Manipulate the Periodogram of an Oscillating Star</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">How to Estimate a Star’s Mass and Radius Using Asteroseismology</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">K2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../K2/TPF/TPF.html">Beginner: Read and Display A K2 Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a K2 Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/removing_instrumental_noise_using_pld/removing_instrumental_noise_using_pld.html">Removing Instrumental Noise from <em>K2</em> and <em>TESS</em> Light Curves Using Pixel Level Decorrelation (PLD)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MCCM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MCCM/FIMS-SPEAR/hyperspectral_healpix_maps/hyperspectral_healpix_maps.html">Working with FIMS-SPEAR Hyperspectral HEALPix Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SDSS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../SDSS/sdss.html">Sloan Digital Sky Survey (SDSS)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../SDSS/MaNGA_HST_tutorial/MaNGA_HST_tutorial.html">Mapping Galaxy Properties with MaNGA + HST</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../SDSS/APOGEE_TESS_tutorial/APOGEE_TESS_tutorial.html">Characterizing Variable Stars with APOGEE + TESS</a></li>






<li class="toctree-l2"><a class="reference internal" href="../../SDSS/eBOSS_JWST_tutorial/eBOSS_JWST_tutorial.html">Exploring High-Redshift Quasars with eBOSS and JWST</a></li>




<li class="toctree-l2"><a class="reference internal" href="../../SDSS/eBOSS_HST_hubbles_law/hubbles_law.html">Calculating the Hubble Constant with eBOSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SDSS/SDSS_LEGACY_IMAGING_cmd/cmd_diagram.html">Creating a Color-Magnitude Diagram for Messier 13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SDSS/SDSS_LEGACY_IMAGING_galaxy_morphology/galaxy_morphology.html">Galaxy Morphology with SDSS and Astrocut</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Multi-Mission Tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../multi_mission/astroquery.html">Astroquery</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_search/beginner_search.html">Beginner: Searching MAST using astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/beginner_zcut/beginner_zcut.html">Beginner: Zcut and Astroquery Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/large_downloads/large_downloads.html">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/historic_quasar_observations/historic_quasar_observations.html">Historical Quasar Observations</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/wildcard_searches/wildcard_searches.html">Wildcard Handling with Astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/missions_mast_search/missions_mast_search.html">Searching for Mission-Specific Data with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../multi_mission/galex_panstarrs_bulk_download/galex_panstarrs_bulk_download.html"><strong>Large downloads in astroquery.mast from AWS to local storage</strong></a></li>

</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../multi_mission/display_footprints/display_footprints.html">PySIAF Observation Footprint Viewer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PanSTARRS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">MAST Table Access Protocol PanSTARRS 1 DR2 Demo</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_image/PS1_image.html">Get Images from the PS1 Image Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TESS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/beginner.html">Beginner Notebooks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">Retrieve TESS Data Validation Products with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">Read and Plot A TESS Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Read and Display a TESS Full Frame Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">Read and Plot A TESS Light Curve File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">Read and Display A TESS Target Pixel File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">Exoplanet Data and TESS Light Curves Using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">Download MAST TESS Light Curves Within an FFI Footprint Using TAP</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">Search The TESS Input Catalog Centered On HD 209458.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">A Tour of the Contents of the TESS 2-minute Cadence Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tesscut_astroquery/beginner_tesscut_astroquery.html">Cutout of the TESS FFIs using Astrocut and Astroquery</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/lc.html">Light Curves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">Intermediate:  Search and Download GI Program Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tasoc_lc/interm_tasoc_lc.html">Intermediate: Finding Flares and Variable Stars in TASOC Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/asteroid_rotation/asteroid_rotation.html">Finding the Rotation Curve of an Asteroid or Comet with TESScut and Lightkurve</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/FFIs.html">TESS FFIs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">Intermediate: Create TESS FFI Cutout using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/making_tess_cubes_and_cutouts/making_tess_cubes_and_cutouts.html">Generating Cubes and Cutouts from TESS FFIs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/noise.html">Instrumental Noise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">Intermediate: Retrieve TESS Pixel Response Function Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/removing_scattered_light_using_regression/removing_scattered_light_using_regression.html">Removing Scattered Light from <em>TESS</em> Data Using the Lightkurve <code class="docutils literal notranslate"><span class="pre">RegressionCorrector</span></code></a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualizations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Visualizations/mast_sky/mast_sky.html">MAST’S View of the Sky</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://timeseries.science.stsci.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/spacetelescope/mast_notebooks&urlpath=lab/tree/mast_notebooks/notebooks/HSC/HCV_CASJOBS/HCV_casjobs_demo.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/HSC/HCV_CASJOBS/HCV_casjobs_demo.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/HSC/HCV_CASJOBS/HCV_casjobs_demo.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hubble Catalog of Variables Notebook (CasJobs version)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Hubble Catalog of Variables Notebook (CasJobs version)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization <a name="initialization"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-python-modules">Install Python modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-your-casjobs-account-information">Set up your CasJobs account information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-objects-near-ic-1613">Variable objects near IC 1613 <a name="ic1613"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-astropy-name-resolver-to-get-position-of-ic-1613">Use <code class="docutils literal notranslate"><span class="pre">astropy</span></code> name resolver to get position of IC 1613 <a name="resolver"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-objects-near-ic-1613-with-acs-f475w-and-f814w-measurements-from-hcv">Select objects near IC 1613 with ACS F475W and F814W measurements from HCV <a name="summary"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-variable-classification-columns">Description of the variable classification columns <a name="classification"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-objects-with-measurements-in-both-f475w-and-f814w">Find objects with measurements in both F475W and F814W</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-object-positions-on-the-sky">Plot object positions on the sky <a name="positions"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w">Plot HCV MAD variability index versus magnitude in F475W <a name="variability"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-variables-in-color-magnitude-diagram">Plot variables in color-magnitude diagram <a name="cmd"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-a-light-curve-for-a-nova-in-m87">Get a light curve for a nova in M87 <a name="m87"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-light-curve-for-a-given-matchid">Extract light curve for a given MatchID <a name="lightcurve"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-hla-image-cutouts-for-the-nova">Get HLA image cutouts for the nova <a name="cutouts"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-hcv-automatic-classification-to-expert-validations">Compare the HCV automatic classification to expert validations <a name="expert"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-mad-variability-index-distribution-with-expert-classifications">Plot the MAD variability index distribution with expert classifications <a name="mad_expert"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-bins">Data &amp; Bins</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plots">Plots</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index">Plot the fraction of artifacts as a function of MAD variability index <a name="artifacts"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv">Plot light curve for the most variable high quality candidate in the HCV <a name="most_variable"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hubble-catalog-of-variables-notebook-casjobs-version">
<h1>Hubble Catalog of Variables Notebook (CasJobs version)<a class="headerlink" href="#hubble-catalog-of-variables-notebook-casjobs-version" title="Link to this heading">#</a></h1>
<p>This notebook shows how to access the <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">Hubble Catalogs of Variables (HCV)</a>. The HCV is a large catalog of faint variable objects extracted from version 3 of the <a class="reference external" href="https://archive.stsci.edu/hst/hsc">Hubble Source Catalog</a>.  The HCV project at the National Observatory of Athens was funded by the European Space Agency (PI: Alceste Bonanos). The data products for the HCV are available both at the <a class="reference external" href="http://archives.esac.esa.int/ehst">ESA Hubble Archive</a> at <a class="reference external" href="https://www.cosmos.esa.int/web/esdc">ESAC</a> through the <a class="reference external" href="http://archives.esac.esa.int/hcv-explorer">HCV Explorer</a> interface and at STScI.
See <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019A%26A...630A..92B/abstract">Bonanos et al. (2019)</a> for more details.</p>
<p>Data tables in <a class="reference external" href="https://mastweb.stsci.edu/hcasjobs">MAST CasJobs</a> are queried from Python using the <a class="reference external" href="https://github.com/rlwastro/mastcasjobs">mastcasjobs</a> module. For similar examples using the <a class="reference external" href="https://catalogs.mast.stsci.edu/docs/hsc.html">MAST API</a>, which is easier to use but less powerful than CasJobs, see <a class="reference internal" href="../HCV_API/HCV_API_demo.html"><span class="std std-doc">HCV_API_demo</span></a>.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="instructions">
<h1>Instructions:<a class="headerlink" href="#instructions" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Complete the initialization steps <a class="reference internal" href="#initialization"><span class="xref myst">described below</span></a>.</p></li>
<li><p>Run the notebook to completion.</p></li>
<li><p>Modify and rerun any sections of the Table of Contents below.</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="#initialization"><span class="xref myst">Intialization</span></a></p></li>
<li><p><a class="reference internal" href="#ic1613"><span class="xref myst">Variable objects in IC 1613</span></a></p>
<ul>
<li><p><a class="reference internal" href="#resolver"><span class="xref myst">Name resolver</span></a></p></li>
<li><p><a class="reference internal" href="#summary"><span class="xref myst">Select objects from HCV</span></a></p></li>
<li><p><a class="reference internal" href="#classification"><span class="xref myst">Information on HCV variable classification</span></a></p></li>
<li><p><a class="reference internal" href="#positions"><span class="xref myst">Sky coverage</span></a></p></li>
<li><p><a class="reference internal" href="#variability"><span class="xref myst">Properties of variable objects</span></a></p></li>
<li><p><a class="reference internal" href="#cmd"><span class="xref myst">Color magnitude diagram</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#m87"><span class="xref myst">Light curve for a nova in M87</span></a></p>
<ul>
<li><p><a class="reference internal" href="#lightcurve"><span class="xref myst">Extract and plot light curve for the nova</span></a></p></li>
<li><p><a class="reference internal" href="#cutouts"><span class="xref myst">HLA cutout images for selected measurements</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#expert"><span class="xref myst">Compare the HCV automatic classification to expert validations</span></a></p>
<ul>
<li><p><a class="reference internal" href="#mad_expert"><span class="xref myst">Plot MAD variability index distribution</span></a></p></li>
<li><p><a class="reference internal" href="#artifacts"><span class="xref myst">Plot fraction of artifacts vs. MAD</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#most_variable"><span class="xref myst">Plot light curve for most variable high-quality candidate in the HCV</span></a></p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="initialization">
<h1>Initialization <a name="initialization"></a><a class="headerlink" href="#initialization" title="Link to this heading">#</a></h1>
<section id="install-python-modules">
<h2>Install Python modules<a class="headerlink" href="#install-python-modules" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><em>This notebook requires the use of <strong>Python 3</strong>.</em></p></li>
<li><p>Modules can be installed with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, if using the <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">Anaconda distribution</a> of python, or with <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<ul class="simple">
<li><p>If you are using <code class="docutils literal notranslate"><span class="pre">conda</span></code>, do not install / update / remove a module with <code class="docutils literal notranslate"><span class="pre">pip</span></code>, that exists in a <code class="docutils literal notranslate"><span class="pre">conda</span></code> <a class="reference external" href="http://archive.stsci.edu/hlsp/hcv/">channel</a>.</p></li>
<li><p>If a module is not available with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, then it’s okay to install it with <code class="docutils literal notranslate"><span class="pre">pip</span></code></p></li>
</ul>
</li>
<li><p>Install <code class="docutils literal notranslate"><span class="pre">mastcasjobs</span></code> and <code class="docutils literal notranslate"><span class="pre">casjobs</span></code> with <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">mastcasjobs</span>
</pre></div>
</div>
</section>
<section id="set-up-your-casjobs-account-information">
<h2>Set up your CasJobs account information<a class="headerlink" href="#set-up-your-casjobs-account-information" title="Link to this heading">#</a></h2>
<p>You must have a <a class="reference external" href="http://archives.esac.esa.int/ehst">MAST Casjobs</a> account. Note that MAST Casjobs accounts are independent of SDSS Casjobs accounts.</p>
<p>For easy startup, you can optionally set the environment variables <code class="docutils literal notranslate"><span class="pre">CASJOBS_USERID</span></code> and/or <code class="docutils literal notranslate"><span class="pre">CASJOBS_PW</span></code> with your Casjobs account information.  The Casjobs user ID and password are what you enter when logging into Casjobs.</p>
<p>This script prompts for your Casjobs user ID and password during initialization if the environment variables are not defined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">astropy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">join</span>

<span class="c1"># check that version of mastcasjobs is new enough</span>
<span class="c1"># we are using some features not in version 0.0.1</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pkg_resources</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_distribution</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">packaging.version</span><span class="w"> </span><span class="kn">import</span> <span class="n">Version</span> <span class="k">as</span> <span class="n">V</span>

<span class="k">assert</span> <span class="n">V</span><span class="p">(</span><span class="n">get_distribution</span><span class="p">(</span><span class="s2">&quot;mastcasjobs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">version</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">V</span><span class="p">(</span><span class="s1">&#39;0.0.2&#39;</span><span class="p">),</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">A newer version of mastcasjobs is required.</span>
<span class="s2">Update mastcasjobs to current version using this command:</span>
<span class="s2">pip install --upgrade git+git://github.com/rlwastro/mastcasjobs@master</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">mastcasjobs</span>

<span class="c1"># set width for pprint</span>
<span class="n">astropy</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">max_width</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2746/2985569151.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  from pkg_resources import get_distribution
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set universal matplotlib parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HSCContext</span> <span class="o">=</span> <span class="s2">&quot;HSCv3&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Set up Casjobs environment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">getpass</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CASJOBS_USERID&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CASJOBS_USERID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter Casjobs UserID:&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CASJOBS_PW&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CASJOBS_PW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s1">&#39;Enter Casjobs password:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="variable-objects-near-ic-1613">
<h2>Variable objects near IC 1613 <a name="ic1613"></a><a class="headerlink" href="#variable-objects-near-ic-1613" title="Link to this heading">#</a></h2>
<section id="use-astropy-name-resolver-to-get-position-of-ic-1613">
<h3>Use <code class="docutils literal notranslate"><span class="pre">astropy</span></code> name resolver to get position of IC 1613 <a name="resolver"></a><a class="headerlink" href="#use-astropy-name-resolver-to-get-position-of-ic-1613" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;IC 1613&#39;</span>
<span class="n">coord_ic1613</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

<span class="n">ra_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span>
<span class="n">dec_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">degree</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ra: </span><span class="si">{</span><span class="n">ra_ic1613</span><span class="si">}</span><span class="se">\n</span><span class="s1">dec: </span><span class="si">{</span><span class="n">dec_ic1613</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ra: 16.2016962
dec: 2.1194959
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-objects-near-ic-1613-with-acs-f475w-and-f814w-measurements-from-hcv">
<h3>Select objects near IC 1613 with ACS F475W and F814W measurements from HCV <a name="summary"></a><a class="headerlink" href="#select-objects-near-ic-1613-with-acs-f475w-and-f814w-measurements-from-hcv" title="Link to this heading">#</a></h3>
<p>This searches the HCV summary table for objects within 0.5 degrees of the galaxy center.  Note that this returns both variable and non-variable objects.  We restrict the sample to objects with measurements in the two filters of interest.  This uses the <code class="docutils literal notranslate"><span class="pre">SearchHCVMatchID</span></code> function to do the cone search.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DBtable</span> <span class="o">=</span> <span class="s2">&quot;HCV_demo&quot;</span>
<span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;MyDB&quot;</span><span class="p">)</span>

<span class="c1"># drop table if it already exists</span>
<span class="n">jobs</span><span class="o">.</span><span class="n">drop_table_if_exists</span><span class="p">(</span><span class="n">DBtable</span><span class="p">)</span>

<span class="c1"># get main information</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mf">1800.0</span> <span class="c1"># arcsec</span>
<span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select m.MatchID, m.GroupID, m.SubGroupID, m.RA, m.Dec,</span>
<span class="s2">   m.AutoClass, m.ExpertClass, m.NumFilters,</span>
<span class="s2">   f.Filter, f.FilterDetFlag, f.VarQualFlag, f.NumLC, </span>
<span class="s2">   f.MeanMag, f.MeanCorrMag, f.MAD, f.Chi2</span>
<span class="s2">into mydb.</span><span class="si">{</span><span class="n">DBtable</span><span class="si">}</span>
<span class="s2">from SearchHCVMatchID(</span><span class="si">{</span><span class="n">ra_ic1613</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">dec_ic1613</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">) s</span>
<span class="s2">join HCVmatch m on m.MatchID=s.MatchID</span>
<span class="s2">join HCVfilter f on f.MatchID=s.MatchID and (f.Filter=&#39;ACS_F475W&#39; or f.Filter=&#39;ACS_F814W&#39;)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># fast retrieval using special MAST Casjobs service</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">fast_table</span><span class="p">(</span><span class="n">DBtable</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="c1"># show some of the variable sources</span>
<span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Completed in 2.7 sec
Rows Affected
-------------
        40196
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.4 s: Retrieved 6.34MB table MyDB.HCV_demo
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.7 s: Converted to 40196 row table
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=522</i>
<table id="table140413085207824" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>GroupID</th><th>SubGroupID</th><th>RA</th><th>Dec</th><th>AutoClass</th><th>ExpertClass</th><th>NumFilters</th><th>Filter</th><th>FilterDetFlag</th><th>VarQualFlag</th><th>NumLC</th><th>MeanMag</th><th>MeanCorrMag</th><th>MAD</th><th>Chi2</th></tr></thead>
<thead><tr><th>int64</th><th>int32</th><th>int32</th><th>float64</th><th>float64</th><th>int32</th><th>int32</th><th>int32</th><th>str9</th><th>uint8</th><th>str5</th><th>int32</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>12131288</td><td>69810</td><td>-5</td><td>16.095659</td><td>2.161246</td><td>1</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>BACAA</td><td>12</td><td>25.248</td><td>25.250</td><td>0.1296</td><td>11.8544</td></tr>
<tr><td>12131288</td><td>69810</td><td>-5</td><td>16.095659</td><td>2.161246</td><td>1</td><td>1</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AAAAC</td><td>12</td><td>25.215</td><td>25.217</td><td>0.0611</td><td>2.3024</td></tr>
<tr><td>82653722</td><td>69810</td><td>-5</td><td>16.097239</td><td>2.162066</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>12</td><td>25.237</td><td>25.238</td><td>0.2312</td><td>64.6089</td></tr>
<tr><td>82653722</td><td>69810</td><td>-5</td><td>16.097239</td><td>2.162066</td><td>2</td><td>1</td><td>2</td><td>ACS_F814W</td><td>1</td><td>BACAA</td><td>12</td><td>25.069</td><td>25.070</td><td>0.1416</td><td>20.4986</td></tr>
<tr><td>100437228</td><td>69810</td><td>-5</td><td>16.111309</td><td>2.160908</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>ABCAA</td><td>12</td><td>23.249</td><td>23.249</td><td>0.1215</td><td>1231.5608</td></tr>
<tr><td>100437228</td><td>69810</td><td>-5</td><td>16.111309</td><td>2.160908</td><td>2</td><td>1</td><td>2</td><td>ACS_F814W</td><td>1</td><td>ABCAA</td><td>12</td><td>22.850</td><td>22.850</td><td>0.0719</td><td>329.2444</td></tr>
<tr><td>4358745</td><td>69810</td><td>-5</td><td>16.111961</td><td>2.157844</td><td>1</td><td>2</td><td>1</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>7</td><td>26.108</td><td>26.111</td><td>0.1011</td><td>44.0548</td></tr>
<tr><td>60282987</td><td>69810</td><td>-5</td><td>16.147720</td><td>2.145969</td><td>1</td><td>4</td><td>2</td><td>ACS_F475W</td><td>0</td><td>AAAAC</td><td>11</td><td>25.495</td><td>25.495</td><td>0.0215</td><td>0.3819</td></tr>
<tr><td>60282987</td><td>69810</td><td>-5</td><td>16.147720</td><td>2.145969</td><td>1</td><td>4</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AACAA</td><td>11</td><td>24.842</td><td>24.843</td><td>0.0796</td><td>35.2635</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>49069115</td><td>69810</td><td>-5</td><td>16.129946</td><td>2.144896</td><td>1</td><td>2</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>11</td><td>25.450</td><td>25.450</td><td>0.0689</td><td>3.4870</td></tr>
<tr><td>49069115</td><td>69810</td><td>-5</td><td>16.129946</td><td>2.144896</td><td>1</td><td>2</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AAAAC</td><td>11</td><td>24.791</td><td>24.792</td><td>0.0217</td><td>0.7766</td></tr>
<tr><td>34776117</td><td>69810</td><td>-5</td><td>16.130381</td><td>2.143142</td><td>1</td><td>2</td><td>2</td><td>ACS_F475W</td><td>0</td><td>AAAAB</td><td>12</td><td>25.310</td><td>25.310</td><td>0.0479</td><td>5.6800</td></tr>
<tr><td>34776117</td><td>69810</td><td>-5</td><td>16.130381</td><td>2.143142</td><td>1</td><td>2</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AACAB</td><td>12</td><td>24.507</td><td>24.509</td><td>0.0732</td><td>8.8664</td></tr>
<tr><td>31257941</td><td>69810</td><td>-5</td><td>16.107393</td><td>2.128815</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>12</td><td>23.168</td><td>23.168</td><td>0.0664</td><td>3751.2152</td></tr>
<tr><td>31257941</td><td>69810</td><td>-5</td><td>16.107393</td><td>2.128815</td><td>2</td><td>1</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AACAA</td><td>12</td><td>22.885</td><td>22.887</td><td>0.0862</td><td>814.8062</td></tr>
<tr><td>14005460</td><td>69810</td><td>-5</td><td>16.109657</td><td>2.127282</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACCA</td><td>12</td><td>25.470</td><td>25.470</td><td>0.1774</td><td>56.3907</td></tr>
<tr><td>14005460</td><td>69810</td><td>-5</td><td>16.109657</td><td>2.127282</td><td>2</td><td>1</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AACAA</td><td>10</td><td>25.248</td><td>25.250</td><td>0.1241</td><td>16.0616</td></tr>
<tr><td>57557150</td><td>69810</td><td>-5</td><td>16.108461</td><td>2.128060</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>12</td><td>25.319</td><td>25.319</td><td>0.1391</td><td>18.9906</td></tr>
<tr><td>57557150</td><td>69810</td><td>-5</td><td>16.108461</td><td>2.128060</td><td>2</td><td>1</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AABAC</td><td>12</td><td>25.319</td><td>25.320</td><td>0.0877</td><td>4.2321</td></tr>
</table></div></div></div>
</div>
</section>
<section id="description-of-the-variable-classification-columns">
<h3>Description of the variable classification columns <a name="classification"></a><a class="headerlink" href="#description-of-the-variable-classification-columns" title="Link to this heading">#</a></h3>
<p>Several of the table columns have information on the variability.</p>
<ul class="simple">
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code> and <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> have summary information on the variability for a given <code class="docutils literal notranslate"><span class="pre">MatchID</span></code> object.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>: Classification as provided by the system: 0=constant 1=single filter variable candidate (SFVC) 2=multi-filter variable candidate (MFVC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code>: Classification as provided by expert: 0=not classified by expert, 1=high confidence variable, 2=probable variable, 4=possible artifact</p></li>
</ul>
</li>
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">MAD</span></code> and <code class="docutils literal notranslate"><span class="pre">Chi2</span></code> are variability indices using the median absolute deviation and the <span class="math notranslate nohighlight">\(\chi^2\)</span> parameter for the given filter.</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">VarQualFlag</span></code> is a variability quality flag (see Section 5 of the paper). The five letters correspond to CI, D, MagerrAper2, MagAper2-MagAuto, p2p; AAAAA corresponds to the highest quality flag.</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">FilterDetFlag</span></code> is the filter detection flag: 1=source is variable in this filter, 0=source is not variable in this filter.</p></li>
</ul>
<p>See the HCV paper by <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a> for more details on the computation and meaning of these quantities.</p>
</section>
<section id="find-objects-with-measurements-in-both-f475w-and-f814w">
<h3>Find objects with measurements in both F475W and F814W<a class="headerlink" href="#find-objects-with-measurements-in-both-f475w-and-f814w" title="Link to this heading">#</a></h3>
<p>This could also be done in the SQL query.  Here we use the <code class="docutils literal notranslate"><span class="pre">Astropy.table.join</span></code> function instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the only key needed to do the join is MatchID, but we include other common columns</span>
<span class="c1"># so that join includes only one copy of them</span>
<span class="n">jtab</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACS_F475W&#39;</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACS_F814W&#39;</span><span class="p">],</span>
            <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">,</span> <span class="s1">&#39;GroupID&#39;</span><span class="p">,</span> <span class="s1">&#39;SubGroupID&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoClass&#39;</span><span class="p">,</span> <span class="s1">&#39;ExpertClass&#39;</span><span class="p">],</span>
            <span class="n">table_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f475&#39;</span><span class="p">,</span> <span class="s1">&#39;f814&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">),</span> <span class="s2">&quot;matched F475W+F814W objects&quot;</span><span class="p">)</span>
<span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17090 matched F475W+F814W objects
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=258</i>
<table id="table140413082918736" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>GroupID</th><th>SubGroupID</th><th>RA</th><th>Dec</th><th>AutoClass</th><th>ExpertClass</th><th>NumFilters_f475</th><th>Filter_f475</th><th>FilterDetFlag_f475</th><th>VarQualFlag_f475</th><th>NumLC_f475</th><th>MeanMag_f475</th><th>MeanCorrMag_f475</th><th>MAD_f475</th><th>Chi2_f475</th><th>NumFilters_f814</th><th>Filter_f814</th><th>FilterDetFlag_f814</th><th>VarQualFlag_f814</th><th>NumLC_f814</th><th>MeanMag_f814</th><th>MeanCorrMag_f814</th><th>MAD_f814</th><th>Chi2_f814</th></tr></thead>
<thead><tr><th>int64</th><th>int32</th><th>int32</th><th>float64</th><th>float64</th><th>int32</th><th>int32</th><th>int32</th><th>str9</th><th>uint8</th><th>str5</th><th>int32</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int32</th><th>str9</th><th>uint8</th><th>str5</th><th>int32</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>96457</td><td>69810</td><td>-5</td><td>16.141516</td><td>2.177815</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>12</td><td>23.192</td><td>23.192</td><td>0.0686</td><td>424.7097</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AAAAC</td><td>12</td><td>22.946</td><td>22.947</td><td>0.0402</td><td>77.5733</td></tr>
<tr><td>813653</td><td>69810</td><td>-5</td><td>16.128353</td><td>2.160147</td><td>1</td><td>4</td><td>2</td><td>ACS_F475W</td><td>0</td><td>AAAAC</td><td>10</td><td>25.508</td><td>25.507</td><td>0.0243</td><td>0.2945</td><td>2</td><td>ACS_F814W</td><td>1</td><td>BACAB</td><td>11</td><td>24.906</td><td>24.908</td><td>0.0795</td><td>8.5797</td></tr>
<tr><td>1012692</td><td>69810</td><td>-5</td><td>16.134809</td><td>2.144720</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>7</td><td>25.439</td><td>25.438</td><td>0.1446</td><td>17.9867</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AABAB</td><td>8</td><td>25.208</td><td>25.210</td><td>0.1152</td><td>6.6471</td></tr>
<tr><td>1085386</td><td>69810</td><td>-5</td><td>16.118544</td><td>2.160845</td><td>1</td><td>4</td><td>2</td><td>ACS_F475W</td><td>0</td><td>AAAAC</td><td>11</td><td>24.351</td><td>24.352</td><td>0.0174</td><td>3.1311</td><td>2</td><td>ACS_F814W</td><td>1</td><td>BABBB</td><td>11</td><td>23.476</td><td>23.476</td><td>0.0697</td><td>40.7630</td></tr>
<tr><td>1286857</td><td>69810</td><td>-5</td><td>16.119205</td><td>2.184252</td><td>1</td><td>2</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AABAB</td><td>12</td><td>23.137</td><td>23.138</td><td>0.0477</td><td>53.2282</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AAAAC</td><td>12</td><td>21.073</td><td>21.075</td><td>0.0128</td><td>46.8982</td></tr>
<tr><td>1309271</td><td>69810</td><td>-5</td><td>16.130571</td><td>2.152512</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>12</td><td>25.347</td><td>25.348</td><td>0.1399</td><td>20.0434</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AAAAC</td><td>12</td><td>25.043</td><td>25.044</td><td>0.0804</td><td>5.2954</td></tr>
<tr><td>1479646</td><td>69810</td><td>-5</td><td>16.120852</td><td>2.152737</td><td>1</td><td>2</td><td>2</td><td>ACS_F475W</td><td>0</td><td>CACAA</td><td>12</td><td>23.691</td><td>23.692</td><td>0.0332</td><td>41.9525</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AABAB</td><td>12</td><td>22.501</td><td>22.503</td><td>0.0362</td><td>68.2414</td></tr>
<tr><td>1661315</td><td>69810</td><td>-5</td><td>16.110571</td><td>2.143526</td><td>1</td><td>4</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAB</td><td>12</td><td>25.220</td><td>25.221</td><td>0.0780</td><td>5.8648</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AAAAC</td><td>12</td><td>25.887</td><td>25.889</td><td>0.0595</td><td>0.8037</td></tr>
<tr><td>1826474</td><td>69810</td><td>-5</td><td>16.101532</td><td>2.171855</td><td>1</td><td>2</td><td>2</td><td>ACS_F475W</td><td>0</td><td>AAAAC</td><td>11</td><td>25.735</td><td>25.737</td><td>0.0259</td><td>0.5195</td><td>2</td><td>ACS_F814W</td><td>1</td><td>BACAB</td><td>11</td><td>24.889</td><td>24.890</td><td>0.0822</td><td>9.2131</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>102132800</td><td>69810</td><td>-5</td><td>16.126160</td><td>2.145442</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>12</td><td>23.691</td><td>23.692</td><td>0.0750</td><td>129.5717</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AACBA</td><td>12</td><td>24.503</td><td>24.505</td><td>0.1038</td><td>27.1660</td></tr>
<tr><td>102239423</td><td>69810</td><td>-5</td><td>16.138706</td><td>2.155652</td><td>1</td><td>2</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AABAA</td><td>12</td><td>22.810</td><td>22.811</td><td>0.0982</td><td>307.5226</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AABAA</td><td>12</td><td>22.735</td><td>22.737</td><td>0.0382</td><td>96.9001</td></tr>
<tr><td>103232694</td><td>69810</td><td>-5</td><td>16.107565</td><td>2.174399</td><td>1</td><td>4</td><td>2</td><td>ACS_F475W</td><td>0</td><td>AAAAC</td><td>11</td><td>22.422</td><td>22.422</td><td>0.0060</td><td>1.7118</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AAAAC</td><td>11</td><td>22.425</td><td>22.426</td><td>0.0335</td><td>27.9930</td></tr>
<tr><td>104300195</td><td>69810</td><td>-5</td><td>16.124981</td><td>2.171772</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>12</td><td>25.540</td><td>25.541</td><td>0.1054</td><td>58.7587</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AACAA</td><td>12</td><td>25.382</td><td>25.384</td><td>0.1217</td><td>9.4811</td></tr>
<tr><td>105173757</td><td>69810</td><td>-5</td><td>16.133703</td><td>2.184506</td><td>2</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AAAAA</td><td>12</td><td>21.372</td><td>21.372</td><td>0.1589</td><td>2810.1572</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AACAA</td><td>12</td><td>22.240</td><td>22.242</td><td>0.1825</td><td>829.2399</td></tr>
<tr><td>106466795</td><td>69810</td><td>-5</td><td>16.127056</td><td>2.166390</td><td>1</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACAA</td><td>12</td><td>25.357</td><td>25.358</td><td>0.1425</td><td>13.4065</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AAAAC</td><td>12</td><td>25.257</td><td>25.259</td><td>0.0462</td><td>2.8032</td></tr>
<tr><td>106640363</td><td>69810</td><td>-5</td><td>16.135796</td><td>2.149099</td><td>1</td><td>2</td><td>2</td><td>ACS_F475W</td><td>1</td><td>CACAA</td><td>8</td><td>25.577</td><td>25.579</td><td>0.1161</td><td>5.8168</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AABAB</td><td>9</td><td>24.944</td><td>24.946</td><td>0.0661</td><td>8.3312</td></tr>
<tr><td>106843213</td><td>69810</td><td>-5</td><td>16.110342</td><td>2.150373</td><td>1</td><td>4</td><td>2</td><td>ACS_F475W</td><td>0</td><td>CACCB</td><td>12</td><td>23.691</td><td>23.691</td><td>0.0269</td><td>30.7690</td><td>2</td><td>ACS_F814W</td><td>1</td><td>CACBA</td><td>12</td><td>24.429</td><td>24.431</td><td>0.0710</td><td>25.8158</td></tr>
<tr><td>107834538</td><td>69810</td><td>-5</td><td>16.107105</td><td>2.160084</td><td>1</td><td>1</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AABAC</td><td>12</td><td>25.400</td><td>25.401</td><td>0.0818</td><td>3.4254</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AAAAC</td><td>12</td><td>25.128</td><td>25.129</td><td>0.0578</td><td>1.7916</td></tr>
<tr><td>108048053</td><td>69810</td><td>-5</td><td>16.150572</td><td>2.142590</td><td>1</td><td>2</td><td>2</td><td>ACS_F475W</td><td>1</td><td>AACCA</td><td>10</td><td>25.297</td><td>25.297</td><td>0.0697</td><td>22.9085</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AAAAC</td><td>11</td><td>24.544</td><td>24.546</td><td>0.0273</td><td>1.6361</td></tr>
</table></div></div></div>
</div>
</section>
<section id="plot-object-positions-on-the-sky">
<h3>Plot object positions on the sky <a name="positions"></a><a class="headerlink" href="#plot-object-positions-on-the-sky" title="Link to this heading">#</a></h3>
<p>We mark the galaxy center as well.  Note that this field is in the outskirts of IC 1613.  The 0.5 degree search radius (which is the maximum allowed in the API) allows finding these objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> HCV measurements&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">jtab</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ra_ic1613</span><span class="p">,</span> <span class="n">dec_ic1613</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;RA [deg]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dec [deg]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb477195310&gt;
</pre></div>
</div>
<img alt="../../../_images/ff624ded3fcb06d178787ef8e46bcde6521d90f3b072108c6735353035130101.png" src="../../../_images/ff624ded3fcb06d178787ef8e46bcde6521d90f3b072108c6735353035130101.png" />
</div>
</div>
</section>
<section id="plot-hcv-mad-variability-index-versus-magnitude-in-f475w">
<h3>Plot HCV MAD variability index versus magnitude in F475W <a name="variability"></a><a class="headerlink" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w" title="Link to this heading">#</a></h3>
<p>The median absolute deviation variability index is used by the HCV to identify variables.  It measures the scatter among the multi-epoch measurements.  Some scatter is expected from noise (which increases for fainter objects).   Objects with MAD values that are high are likely to be variable.</p>
<p>This plots single-filter and multi-filter variable candidates (SFVC and MFVC) in different colors.  Note that variable objects with low F475W MAD values are variable in a different filter (typically F814W in this field).</p>
<p>This plot is similar to the upper panel of Figure 4 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define plot parameter lists</span>
<span class="n">auto_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">])</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:cyan&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;non-&#39;</span><span class="p">,</span> <span class="s1">&#39;single-filter &#39;</span><span class="p">,</span> <span class="s1">&#39;multi-filter &#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">auto_class</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ac</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">,</span> <span class="s1">&#39;MAD_f475&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">variable candidates&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ACS_F475W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;ACS_F475W MAD [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb478131350&gt;
</pre></div>
</div>
<img alt="../../../_images/272b759bfdc20535f0d9b35475f7a4c6d7f6c5ea65ad5cb6b8102b1d7d30bbf7.png" src="../../../_images/272b759bfdc20535f0d9b35475f7a4c6d7f6c5ea65ad5cb6b8102b1d7d30bbf7.png" />
</div>
</div>
</section>
<section id="plot-variables-in-color-magnitude-diagram">
<h3>Plot variables in color-magnitude diagram <a name="cmd"></a><a class="headerlink" href="#plot-variables-in-color-magnitude-diagram" title="Link to this heading">#</a></h3>
<p>Many of the candidate variables lie on the instability strip.</p>
<p>This plot is similar to the lower panel of Figure 4 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add a new column to jtab</span>
<span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MCMf475-MCMf814&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag_f814&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># uses same plot parameters defined in the previous plot</span>
<span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">auto_class</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">jtab</span><span class="p">[</span><span class="n">jtab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ac</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MCMf475-MCMf814&#39;</span><span class="p">,</span> <span class="s1">&#39;MeanCorrMag_f475&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">variable candidates&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;ACS F475W - F814W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;ACS F475W [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">jtab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb477f51350&gt;
</pre></div>
</div>
<img alt="../../../_images/f3eac5f8155bb1ea7e74262ee83674b55135523e1ea5f285a8b12242fa639091.png" src="../../../_images/f3eac5f8155bb1ea7e74262ee83674b55135523e1ea5f285a8b12242fa639091.png" />
</div>
</div>
</section>
</section>
<section id="get-a-light-curve-for-a-nova-in-m87">
<h2>Get a light curve for a nova in M87 <a name="m87"></a><a class="headerlink" href="#get-a-light-curve-for-a-nova-in-m87" title="Link to this heading">#</a></h2>
<section id="extract-light-curve-for-a-given-matchid">
<h3>Extract light curve for a given MatchID <a name="lightcurve"></a><a class="headerlink" href="#extract-light-curve-for-a-given-matchid" title="Link to this heading">#</a></h3>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">MatchID</span></code> could be determined by positional searches, filtering the catalog, etc.  This object comes from the top left panel of Figure 9 in <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matchid</span> <span class="o">=</span> <span class="mi">1905457</span>

<span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get light curves for F606W and F814W</span>
<span class="n">nova_606</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;select * from HCVdetailed</span>
<span class="s2">where MatchID=</span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s2"> and Filter=&#39;ACS_F606W&#39;&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nova_606</span><span class="p">)</span><span class="si">}</span><span class="s2"> F606W measurements&quot;</span><span class="p">)</span>

<span class="n">nova_814</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;select * from HCVdetailed</span>
<span class="s2">where MatchID=</span><span class="si">{}</span><span class="s2"> and Filter=&#39;ACS_F814W&#39;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matchid</span><span class="p">),</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">nova_814</span><span class="p">)</span><span class="si">}</span><span class="s2"> F814W measurements&quot;</span><span class="p">)</span>

<span class="c1"># get the object RA and Dec as well</span>
<span class="n">nova_tab</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;select MatchID, RA, Dec from HCVmatch</span>
<span class="s2">where MatchID=</span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved object info&quot;</span><span class="p">)</span>

<span class="n">nova_606</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3 sec: retrieved 21 F606W measurements
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7 sec: retrieved 22 F814W measurements
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0 sec: retrieved object info
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=21</i>
<table id="table140413083860944" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>Filter</th><th>MJD</th><th>ImageName</th><th>Mag</th><th>CorrMag</th><th>MagErr</th><th>CI</th><th>D</th></tr></thead>
<thead><tr><th>int64</th><th>str9</th><th>float64</th><th>str26</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1905457</td><td>ACS_F606W</td><td>53767.4197952871</td><td>hst_10543_29_acs_wfc_f606w</td><td>25.327</td><td>25.3267132802993</td><td>0.1305</td><td>0.840648114681244</td><td>13.499119758606</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53768.4190663833</td><td>hst_10543_30_acs_wfc_f606w</td><td>23.9694</td><td>23.9676109802196</td><td>0.0394</td><td>1.04379630088806</td><td>11.9895544052124</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53769.3576541713</td><td>hst_10543_31_acs_wfc_f606w</td><td>23.6005</td><td>23.6000842124737</td><td>0.0306</td><td>0.974166631698608</td><td>9.30478286743164</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53771.1017052617</td><td>hst_10543_33_acs_wfc_f606w</td><td>23.6105</td><td>23.6157510517543</td><td>0.030300001</td><td>0.96657407283783</td><td>2.96933674812317</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53772.8098534283</td><td>hst_10543_35_acs_wfc_f606w</td><td>23.621799</td><td>23.602993885395</td><td>0.0328</td><td>0.992037057876587</td><td>4.45478820800781</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53774.4746564087</td><td>hst_10543_37_acs_wfc_f606w</td><td>24.015499</td><td>24.0123868023881</td><td>0.042599998</td><td>1.0246297121048</td><td>3.4874792098999</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53775.2799112014</td><td>hst_10543_38_acs_wfc_f606w</td><td>23.9037</td><td>23.9077547341058</td><td>0.0381</td><td>0.985185205936432</td><td>3.49740219116211</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53776.0893441574</td><td>hst_10543_39_acs_wfc_f606w</td><td>24.015499</td><td>24.0182108840315</td><td>0.0414</td><td>1.05314815044403</td><td>8.44466972351074</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53776.9439852673</td><td>hst_10543_40_acs_wfc_f606w</td><td>24.065701</td><td>24.0743889490328</td><td>0.044599999</td><td>1.24157404899597</td><td>7.6749701499939</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53778.562434162</td><td>hst_10543_42_acs_wfc_f606w</td><td>24.430799</td><td>24.4274937224049</td><td>0.059500001</td><td>1.07425928115845</td><td>3.26662158966064</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53779.4097260174</td><td>hst_10543_43_acs_wfc_f606w</td><td>24.415899</td><td>24.4150584573105</td><td>0.062600002</td><td>0.965277791023254</td><td>2.09669971466064</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53780.2090778507</td><td>hst_10543_44_acs_wfc_f606w</td><td>24.697599</td><td>24.6944838119623</td><td>0.080499999</td><td>0.810648143291473</td><td>6.5630521774292</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53782.61915897</td><td>hst_10543_47_acs_wfc_f606w</td><td>24.560801</td><td>24.5570748994592</td><td>0.065399997</td><td>1.09907412528992</td><td>2.88692712783813</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53784.2176541714</td><td>hst_10543_73_acs_wfc_f606w</td><td>24.7827</td><td>24.7770110702267</td><td>0.079000004</td><td>0.888148188591003</td><td>3.16040587425232</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53786.1563230369</td><td>hst_10543_86_acs_wfc_f606w</td><td>24.9091</td><td>24.8532684587691</td><td>0.0902</td><td>1.03777778148651</td><td>8.54914951324463</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53787.0225386124</td><td>hst_10543_92_acs_wfc_f606w</td><td>25.114599</td><td>25.0878230960564</td><td>0.1127</td><td>0.924444437026978</td><td>4.14372444152832</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53792.6850963715</td><td>hst_10543_49_acs_wfc_f606w</td><td>25.228001</td><td>25.231832236643</td><td>0.1147</td><td>1.14425933361053</td><td>11.9895496368408</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53793.5260915786</td><td>hst_10543_a1_acs_wfc_f606w</td><td>25.153601</td><td>25.1604359861786</td><td>0.1071</td><td>0.925648152828217</td><td>7.5528678894043</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53796.1486378878</td><td>hst_10543_b8_acs_wfc_f606w</td><td>24.0172</td><td>23.9985920051837</td><td>0.0436</td><td>1.51175928115845</td><td>10.1193161010742</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53798.5892174062</td><td>hst_10543_50_acs_wfc_f606w</td><td>25.563601</td><td>25.5708965234736</td><td>0.15350001</td><td>0.953240752220154</td><td>12.9010400772095</td></tr>
<tr><td>1905457</td><td>ACS_F606W</td><td>53799.4608942058</td><td>hst_10543_c4_acs_wfc_f606w</td><td>25.5895</td><td>25.5908707417737</td><td>0.1602</td><td>0.92981481552124</td><td>5.97602415084839</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS F606W&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nova_606</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS F814W&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nova_814</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Nova in M87 (MatchID: </span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb477f4b990&gt;
</pre></div>
</div>
<img alt="../../../_images/f3008ce76370750eba3aea0314e81f428dffab4e7d8f63f63eba79d81f9b263f.png" src="../../../_images/f3008ce76370750eba3aea0314e81f428dffab4e7d8f63f63eba79d81f9b263f.png" />
</div>
</div>
</section>
<section id="get-hla-image-cutouts-for-the-nova">
<h3>Get HLA image cutouts for the nova <a name="cutouts"></a><a class="headerlink" href="#get-hla-image-cutouts-for-the-nova" title="Link to this heading">#</a></h3>
<p>The <a class="reference external" href="https://hla.stsci.edu">Hubble Legacy Archive (HLA)</a> images were the source of the measurements in the HSC and HCV, and it can be useful to look at the images.  Examination of the images can be useful to identified cosmic-ray contamination and other possible image artifacts.  In this case, no issues are seen, so the light curve is reliable.</p>
<p>Note that the ACS F606W images of M87 have only a single exposure, so they do have cosmic ray contamination.  The accompanying F814W images have multiple exposures, allowing CRs to be removed.  In this case the F814W combined image is used to find objects, while the F606W exposure is used only for photometry.  That reduces the effects of F606W CRs on the catalog but it is still a good idea to confirm the quality of the images.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_hla_cutout</span></code> function reads a single cutout image (as a JPEG grayscale image) and returns a PIL image object.  See the documentation on the <a class="reference external" href="http://hla.stsci.edu/fitscutcgi_interface.html">fitscut image cutout service</a> for more information on the web service being used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_hla_cutout</span><span class="p">(</span><span class="n">imagename</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="mf">99.5</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get JPEG cutout for an image&quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://hla.stsci.edu/cgi-bin/fitscut.cgi&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span>
                                      <span class="n">red</span><span class="o">=</span><span class="n">imagename</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="n">autoscale</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="n">asinh</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">))</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">im</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images by magnitude from brightest to faintest</span>
<span class="n">phot</span> <span class="o">=</span> <span class="n">nova_606</span>
<span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">])</span>
<span class="c1"># select the brightest, median and faintest magnitudes</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">isort</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">isort</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">isort</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">isort</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="c1"># we plot zoomed-in and zoomed-out views side-by-side for each selected image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize1</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">imsize2</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">nova_tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">nova_tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># define figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># iterate through each set of two subplots in axes</span>
<span class="k">for</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
    
    <span class="c1"># get the images</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize1</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize2</span><span class="p">)</span>
    
    <span class="c1"># plot left column   </span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2"> m=</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># plot right column</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">xbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">imsize1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">imsize2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2"> m=</span><span class="si">{</span><span class="n">phot</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>    
    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: got </span><span class="si">{</span><span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> cutouts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.6 s: got 6 cutouts
</pre></div>
</div>
<img alt="../../../_images/299b7301181e1bdd544b47ecfe60788ae37feda6ea7bdcad4686fd852b430635.png" src="../../../_images/299b7301181e1bdd544b47ecfe60788ae37feda6ea7bdcad4686fd852b430635.png" />
</div>
</div>
</section>
</section>
<section id="compare-the-hcv-automatic-classification-to-expert-validations">
<h2>Compare the HCV automatic classification to expert validations <a name="expert"></a><a class="headerlink" href="#compare-the-hcv-automatic-classification-to-expert-validations" title="Link to this heading">#</a></h2>
<p>The HCV includes an automatic classification <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code> for candidate variables as well as an expert validation for some fields that were selected for visual examination.  See the <a class="reference internal" href="#classification"><span class="xref myst">description of the classification columns</span></a> and the HCV paper by <a class="reference external" href="https://www.aanda.org/component/article?access=doi&amp;amp;doi=10.1051/0004-6361/201936026">Bonanos et al. (2019, AAp)</a> for more details on the computation and meaning of these quantities.</p>
<p>For this example, we select all the objects in the HCV that have expert classification information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DBtable</span> <span class="o">=</span> <span class="s2">&quot;HCV_demo2&quot;</span>
<span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;MyDB&quot;</span><span class="p">)</span>

<span class="c1"># drop table if it already exists</span>
<span class="n">jobs</span><span class="o">.</span><span class="n">drop_table_if_exists</span><span class="p">(</span><span class="n">DBtable</span><span class="p">)</span>

<span class="c1"># get data for objects with an expert validation</span>
<span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select m.MatchID, m.GroupID, m.SubGroupID, m.RA, m.Dec,</span>
<span class="s2">   m.AutoClass, m.ExpertClass, m.NumFilters,</span>
<span class="s2">   f.Filter, f.FilterDetFlag, f.VarQualFlag, f.NumLC, </span>
<span class="s2">   f.MeanMag, f.MeanCorrMag, f.MAD, f.Chi2</span>
<span class="s2">into mydb.</span><span class="si">{</span><span class="n">DBtable</span><span class="si">}</span>
<span class="s2">from HCVmatch m</span>
<span class="s2">join HCVfilter f on m.MatchID=f.MatchID</span>
<span class="s2">where m.ExpertClass&gt;0</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># fast retrieval using special MAST Casjobs service</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">fast_table</span><span class="p">(</span><span class="n">DBtable</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="c1"># tab includes 1 row for each filter (so multiple rows for objects with multiple filters)</span>
<span class="c1"># get an array that has only one row per object</span>
<span class="n">mval</span><span class="p">,</span> <span class="n">uindex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">utab</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="n">uindex</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">utab</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique MatchIDs in table&quot;</span><span class="p">)</span>

<span class="n">tab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Completed in 0.7 sec
Rows Affected
-------------
        31258
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0 s: Retrieved 4.94MB table MyDB.HCV_demo2
1.2 s: Converted to 31258 row table
13533 unique MatchIDs in table
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=31258</i>
<table id="table140413029513936" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>GroupID</th><th>SubGroupID</th><th>RA</th><th>Dec</th><th>AutoClass</th><th>ExpertClass</th><th>NumFilters</th><th>Filter</th><th>FilterDetFlag</th><th>VarQualFlag</th><th>NumLC</th><th>MeanMag</th><th>MeanCorrMag</th><th>MAD</th><th>Chi2</th></tr></thead>
<thead><tr><th>int64</th><th>int32</th><th>int32</th><th>float64</th><th>float64</th><th>int32</th><th>int32</th><th>int32</th><th>str11</th><th>uint8</th><th>str5</th><th>int32</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>875</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>7</td><td>ACS_F435W</td><td>0</td><td>AAAAA</td><td>13</td><td>24.166</td><td>24.166</td><td>0.0384</td><td>7.1169</td></tr>
<tr><td>875</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>7</td><td>ACS_F606W</td><td>0</td><td>AAAAC</td><td>9</td><td>22.836</td><td>22.835</td><td>0.0349</td><td>81.3676</td></tr>
<tr><td>875</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>7</td><td>ACS_F814W</td><td>0</td><td>AAAAA</td><td>23</td><td>22.156</td><td>22.156</td><td>0.0325</td><td>141.7171</td></tr>
<tr><td>875</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>7</td><td>WFC3_F105W</td><td>1</td><td>CAAAB</td><td>14</td><td>21.843</td><td>21.843</td><td>0.0503</td><td>223.4961</td></tr>
<tr><td>875</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>7</td><td>WFC3_F125W</td><td>1</td><td>CBCCA</td><td>6</td><td>21.813</td><td>21.814</td><td>0.0655</td><td>792.8662</td></tr>
<tr><td>875</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>7</td><td>WFC3_F140W</td><td>0</td><td>AAAAA</td><td>6</td><td>21.705</td><td>21.704</td><td>0.0205</td><td>127.6242</td></tr>
<tr><td>875</td><td>1040153</td><td>-5</td><td>64.149673</td><td>-24.110353</td><td>2</td><td>2</td><td>7</td><td>WFC3_F160W</td><td>1</td><td>BABAA</td><td>13</td><td>21.623</td><td>21.624</td><td>0.0322</td><td>112.8544</td></tr>
<tr><td>2006</td><td>521507</td><td>-5</td><td>268.112152</td><td>-17.684282</td><td>2</td><td>2</td><td>2</td><td>WFPC2_F555W</td><td>1</td><td>AAAAC</td><td>7</td><td>21.811</td><td>21.821</td><td>0.1545</td><td>85.2812</td></tr>
<tr><td>2006</td><td>521507</td><td>-5</td><td>268.112152</td><td>-17.684282</td><td>2</td><td>2</td><td>2</td><td>WFPC2_F814W</td><td>1</td><td>AAAAA</td><td>7</td><td>20.513</td><td>20.519</td><td>0.0988</td><td>105.2348</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>108116850</td><td>1045904</td><td>85</td><td>11.627593</td><td>42.061874</td><td>1</td><td>1</td><td>2</td><td>ACS_F475W</td><td>0</td><td>AAAAA</td><td>5</td><td>24.772</td><td>24.774</td><td>0.0498</td><td>52.0622</td></tr>
<tr><td>108116850</td><td>1045904</td><td>85</td><td>11.627593</td><td>42.061874</td><td>1</td><td>1</td><td>2</td><td>ACS_F814W</td><td>1</td><td>AACAA</td><td>5</td><td>24.605</td><td>24.607</td><td>0.1120</td><td>56.7844</td></tr>
<tr><td>108127522</td><td>1043478</td><td>-5</td><td>211.154297</td><td>54.521580</td><td>1</td><td>1</td><td>1</td><td>ACS_F606W</td><td>1</td><td>AACAA</td><td>6</td><td>26.786</td><td>26.786</td><td>0.1496</td><td>12.5680</td></tr>
<tr><td>108141967</td><td>1036556</td><td>-5</td><td>34.188431</td><td>-5.203189</td><td>1</td><td>4</td><td>2</td><td>ACS_F606W</td><td>1</td><td>BAACA</td><td>5</td><td>26.174</td><td>26.175</td><td>0.1806</td><td>5.3338</td></tr>
<tr><td>108141967</td><td>1036556</td><td>-5</td><td>34.188431</td><td>-5.203189</td><td>1</td><td>4</td><td>2</td><td>ACS_F814W</td><td>0</td><td>AAAAC</td><td>5</td><td>25.970</td><td>25.969</td><td>0.0561</td><td>0.2748</td></tr>
<tr><td>108154109</td><td>1084533</td><td>-5</td><td>53.141266</td><td>-27.710630</td><td>1</td><td>2</td><td>5</td><td>ACS_F606W</td><td>0</td><td>CAAAC</td><td>7</td><td>24.477</td><td>24.477</td><td>0.0161</td><td>3.4616</td></tr>
<tr><td>108154109</td><td>1084533</td><td>-5</td><td>53.141266</td><td>-27.710630</td><td>1</td><td>2</td><td>5</td><td>ACS_F775W</td><td>0</td><td>CAAAC</td><td>11</td><td>23.650</td><td>23.650</td><td>0.0588</td><td>2.6932</td></tr>
<tr><td>108154109</td><td>1084533</td><td>-5</td><td>53.141266</td><td>-27.710630</td><td>1</td><td>2</td><td>5</td><td>ACS_F814W</td><td>0</td><td>CAAAC</td><td>5</td><td>23.577</td><td>23.577</td><td>0.0037</td><td>2.9994</td></tr>
<tr><td>108154109</td><td>1084533</td><td>-5</td><td>53.141266</td><td>-27.710630</td><td>1</td><td>2</td><td>5</td><td>ACS_F850LP</td><td>1</td><td>CAAAA</td><td>12</td><td>23.455</td><td>23.455</td><td>0.0639</td><td>3.4468</td></tr>
<tr><td>108154109</td><td>1084533</td><td>-5</td><td>53.141266</td><td>-27.710630</td><td>1</td><td>2</td><td>5</td><td>WFC3_F105W</td><td>0</td><td>AAAAC</td><td>6</td><td>21.541</td><td>21.541</td><td>0.0065</td><td>0.4013</td></tr>
</table></div></div></div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> value of 1 indicates that the object is confidently confirmed to be a variable; 2 means that the measurements do not have apparent problems and so the object is likely to be variable (usually the variability is too small to be obvious in the image); 4 means that the variability is likely to be the result of artifacts in the image (e.g., residual cosmic rays or diffraction spikes from nearby bright stars).</p>
<p>Compare the distributions for single-filter variable candidates (SFVC, <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>=1) and multi-filter variable candidates (MFVC, <code class="docutils literal notranslate"><span class="pre">AutoClass</span></code>=2).  The fraction of artifacts is lower in the MFVC sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sfcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">mfcount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">utab</span><span class="p">[</span><span class="s1">&#39;AutoClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">sfrat</span> <span class="o">=</span> <span class="n">sfcount</span><span class="o">/</span><span class="n">sfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">mfrat</span> <span class="o">=</span> <span class="n">mfcount</span><span class="o">/</span><span class="n">mfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type Variable Likely Artifact Total&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SFVC </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:6d}</span><span class="s2"> </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:5d}</span><span class="s2"> counts&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sfcount</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sfcount</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sfcount</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">sfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFVC </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:6d}</span><span class="s2"> </span><span class="si">{:8d}</span><span class="s2"> </span><span class="si">{:5d}</span><span class="s2"> counts&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mfcount</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mfcount</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mfcount</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mfcount</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SFVC </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:6.3f}</span><span class="s2"> </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:5.3f}</span><span class="s2"> fraction&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sfrat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sfrat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sfrat</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">sfrat</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MFVC </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:6.3f}</span><span class="s2"> </span><span class="si">{:8.3f}</span><span class="s2"> </span><span class="si">{:5.3f}</span><span class="s2"> fraction&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mfrat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mfrat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mfrat</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">mfrat</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type Variable Likely Artifact Total
SFVC     3323   3055     1761  8139 counts
MFVC     2101   2442      851  5394 counts
SFVC    0.408  0.375    0.216 1.000 fraction
MFVC    0.390  0.453    0.158 1.000 fraction
</pre></div>
</div>
</div>
</div>
<section id="plot-the-mad-variability-index-distribution-with-expert-classifications">
<h3>Plot the MAD variability index distribution with expert classifications <a name="mad_expert"></a><a class="headerlink" href="#plot-the-mad-variability-index-distribution-with-expert-classifications" title="Link to this heading">#</a></h3>
<p>Note that only the filters identified as variable (<code class="docutils literal notranslate"><span class="pre">FilterDetFlag</span></code> &gt; 0) are included here.</p>
<p>This version of the plot shows the distributions for the various <code class="docutils literal notranslate"><span class="pre">ExpertClass</span></code> values along with, for comparison, the distribution for all objects in gray (which is identical in each panel).  Most objects are classified as confident or likely variables.  Objects with lower MAD values (indicating a lower amplitude of variability) are less likely to be identified as confident variables because low-level variability is more difficult to confirm via visual examination.</p>
<section id="data-bins">
<h4>Data &amp; Bins<a class="headerlink" href="#data-bins" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;FilterDetFlag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mad</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.e-3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plots">
<h4>Plots<a class="headerlink" href="#plots" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Confident&#39;</span><span class="p">,</span> <span class="s1">&#39;Likely&#39;</span><span class="p">,</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C0&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="n">v</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/371c5bc20a7407db3fabafca8e86474d32d9ea35b0ca0a08676e73fd881d9551.png" src="../../../_images/371c5bc20a7407db3fabafca8e86474d32d9ea35b0ca0a08676e73fd881d9551.png" />
</div>
</div>
<p>The plot below shows the same distributions, but plotted as stacked histograms.  The top panel uses a linear scale on the y-axis and the bottom panel uses a log y scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">ylogs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ylog</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ylogs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Artifact&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Likely Variable&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">ylog</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Confident Variable&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/6a7a6a01e9b334ebad32fb3f58cc725629fd5367d59d463f3fbf6cf1f046ede0.png" src="../../../_images/6a7a6a01e9b334ebad32fb3f58cc725629fd5367d59d463f3fbf6cf1f046ede0.png" />
</div>
</div>
</section>
</section>
<section id="plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index">
<h3>Plot the fraction of artifacts as a function of MAD variability index <a name="artifacts"></a><a class="headerlink" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index" title="Link to this heading">#</a></h3>
<p>This shows how the fraction of artifacts varies with the MAD value.  For larger MAD values the fraction decreases sharply, presumably because such large values are less likely to result from the usual artifacts.  Interestingly, the artifact fraction also declines for smaller MAD values (MAD &lt; 0.1 mag).  Probably that happens because typical artifacts are more likely to produce strong signals than the weaker signals indicated by a low MAD value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;FilterDetFlag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">mad</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;ExpertClass&#39;</span><span class="p">][</span><span class="n">w</span><span class="p">]</span>

<span class="n">xrange</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.e-3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">all_count</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">mad</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">artifact_count</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">mad</span><span class="p">[</span><span class="n">e</span> <span class="o">==</span> <span class="mi">4</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">wnz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nnz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wnz</span><span class="p">)</span>

<span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">xerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">nnz</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">wnz</span><span class="p">]</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">wnz</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># combine bins at edge into one big bin to improve the statistics there</span>
<span class="n">iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">iz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">all_count</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span> <span class="o">+=</span> <span class="n">all_count</span><span class="p">[:</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">artifact_count</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span> <span class="o">+=</span> <span class="n">artifact_count</span><span class="p">[:</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">iz</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[</span><span class="n">iz</span><span class="p">:]</span>
    <span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="n">iz</span><span class="p">:]</span>
    <span class="n">xerr</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[:,</span> <span class="n">iz</span><span class="p">:]</span>
    
<span class="n">iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_count</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">iz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">all_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">all_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">artifact_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[</span><span class="o">-</span><span class="n">iz</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">all_count</span> <span class="o">=</span> <span class="n">all_count</span><span class="p">[:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>
    <span class="n">artifact_count</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="p">[:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>
    <span class="n">xerr</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="n">iz</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xerr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span>

<span class="n">frac</span> <span class="o">=</span> <span class="n">artifact_count</span><span class="o">/</span><span class="n">all_count</span>
<span class="c1"># error on fraction using binomial distribution (approximate)</span>
<span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">frac</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">frac</span><span class="p">)</span><span class="o">/</span><span class="n">all_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Create the plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">ferr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Artifact fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MAD Variability Index [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Artifact Fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;HCV Expert Validation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb476e08890&gt;
</pre></div>
</div>
<img alt="../../../_images/1f08fec006ab1e620d4f8c7f0875237367227e3c23bac145f927758f5f1d18e7.png" src="../../../_images/1f08fec006ab1e620d4f8c7f0875237367227e3c23bac145f927758f5f1d18e7.png" />
</div>
</div>
</section>
<section id="plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv">
<h3>Plot light curve for the most variable high quality candidate in the HCV <a name="most_variable"></a><a class="headerlink" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv" title="Link to this heading">#</a></h3>
<p>Select the candidate variable with the largest MAD value and <code class="docutils literal notranslate"><span class="pre">VarQualFlag</span></code> = ‘AAAAA’.  To find the highest MAD value, we sort by MAD in descending order and select the first result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>

<span class="c1"># join to the Groups table as well to get the target name</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select top 1 m.MatchID, m.GroupID, m.SubGroupID, g.TargetName, m.RA, m.Dec,</span>
<span class="s2">   m.AutoClass, m.ExpertClass, m.NumFilters,</span>
<span class="s2">   f.Filter, f.FilterDetFlag, f.VarQualFlag, f.NumLC, </span>
<span class="s2">   f.MeanMag, f.MeanCorrMag, f.MAD, f.Chi2</span>
<span class="s2">from HCVmatch m</span>
<span class="s2">join HCVfilter f on m.MatchID=f.MatchID</span>
<span class="s2">join Groups g on m.GroupID=g.GroupID</span>
<span class="s2">where f.VarQualFlag=&#39;AAAAA&#39;</span>
<span class="s2">order by f.MAD desc</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MeanCorrMag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Chi2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.4f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MatchID </span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> in group &#39;</span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;TargetName&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; has largest MAD value = </span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">tab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Completed in 1.0 sec
MatchID 5742711 in group &#39;M31&#39; has largest MAD value = 0.86
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140413064371152" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>GroupID</th><th>SubGroupID</th><th>TargetName</th><th>RA</th><th>Dec</th><th>AutoClass</th><th>ExpertClass</th><th>NumFilters</th><th>Filter</th><th>FilterDetFlag</th><th>VarQualFlag</th><th>NumLC</th><th>MeanMag</th><th>MeanCorrMag</th><th>MAD</th><th>Chi2</th></tr></thead>
<thead><tr><th>int64</th><th>int64</th><th>int64</th><th>str3</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>int64</th><th>str9</th><th>str4</th><th>str5</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>5742711</td><td>1045904</td><td>16</td><td>M31</td><td>10.928601</td><td>41.164295</td><td>1</td><td>0</td><td>1</td><td>ACS_F814W</td><td>True</td><td>AAAAA</td><td>5</td><td>22.264</td><td>22.265</td><td>0.8581</td><td>6698.4430</td></tr>
</table></div></div></div>
</div>
<p>Get the light curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matchid</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mfilter</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Filter&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">jobs</span> <span class="o">=</span> <span class="n">mastcasjobs</span><span class="o">.</span><span class="n">MastCasJobs</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">HSCContext</span><span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># get light curves for F606W and F814W</span>
<span class="n">lc</span> <span class="o">=</span> <span class="n">jobs</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;select * from HCVdetailed</span>
<span class="s2">where MatchID=</span><span class="si">{}</span><span class="s2"> and Filter=&#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matchid</span><span class="p">,</span> <span class="n">mfilter</span><span class="p">),</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;HCV demo&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> sec: retrieved </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mfilter</span><span class="si">}</span><span class="s2"> measurements&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3 sec: retrieved 5 ACS_F814W measurements
</pre></div>
</div>
</div>
</div>
<p>Plot the light curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="s1">&#39;MagErr&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mfilter</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">lc</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;MatchID: </span><span class="si">{</span><span class="n">matchid</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;TargetName&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> MAD=</span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MAD&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fb477605550&gt;
</pre></div>
</div>
<img alt="../../../_images/9417e8ce433b94527b248f5dff2df376371b3b39c39dbd4ae7c39ea6ef2af937.png" src="../../../_images/9417e8ce433b94527b248f5dff2df376371b3b39c39dbd4ae7c39ea6ef2af937.png" />
</div>
</div>
<p>Extract cutout images for the entire light curve (since it does not have many points).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images in MJD order</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">])</span>

<span class="c1"># we plot zoomed-in and zoomed-out views side-by-side for each selected image</span>
<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize1</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">imsize2</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;RA&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># define figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># iterate through each set of two subplots in axes</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">ind</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># get the images</span>
    <span class="n">im1</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize1</span><span class="p">)</span>
    <span class="n">im2</span> <span class="o">=</span> <span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize2</span><span class="p">)</span>
    
    <span class="c1"># plot left column    </span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="c1"># plot right column</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">xbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">imsize1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">imsize2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">xbox</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;m=</span><span class="si">{</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;CorrMag&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> MJD=</span><span class="si">{</span><span class="n">lc</span><span class="p">[</span><span class="s1">&#39;MJD&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: finished </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="si">}</span><span class="s2"> epochs&quot;</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: got </span><span class="si">{</span><span class="n">nrows</span><span class="o">*</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> cutouts&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5 s: finished 1 of 5 epochs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.9 s: finished 2 of 5 epochs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.4 s: finished 3 of 5 epochs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.8 s: finished 4 of 5 epochs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.3 s: finished 5 of 5 epochs
7.3 s: got 10 cutouts
</pre></div>
</div>
<img alt="../../../_images/f05bb315fc2fbc93a16fd574f2e44bf5d06e8157891bd0257b62c8f4f4f4ab62.png" src="../../../_images/f05bb315fc2fbc93a16fd574f2e44bf5d06e8157891bd0257b62c8f4f4f4ab62.png" />
</div>
</div>
</section>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Link to this heading">#</a></h2>
<p>If you have comments or questions on this notebook, please contact us through the Archive Help Desk e-mail at <code class="docutils literal notranslate"><span class="pre">archive&#64;stsci.edu</span></code>.</p>
<p><strong>Author(s):</strong> Rick White, Steve Lubow, Trenton McKinney <br>
<strong>Last Updated:</strong> May 2023 <br></p>
<hr class="docutils" />
<p><a class="reference internal" href="#top"><span class="xref myst">Top of Page</span></a>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/HSC/HCV_CASJOBS"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../HCV_API/HCV_API_demo.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Hubble Catalog of Variables Notebook (API version)</p>
      </div>
    </a>
    <a class="right-next"
       href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exploring UV Extinction Curves</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Hubble Catalog of Variables Notebook (CasJobs version)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization <a name="initialization"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-python-modules">Install Python modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-your-casjobs-account-information">Set up your CasJobs account information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-objects-near-ic-1613">Variable objects near IC 1613 <a name="ic1613"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-astropy-name-resolver-to-get-position-of-ic-1613">Use <code class="docutils literal notranslate"><span class="pre">astropy</span></code> name resolver to get position of IC 1613 <a name="resolver"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-objects-near-ic-1613-with-acs-f475w-and-f814w-measurements-from-hcv">Select objects near IC 1613 with ACS F475W and F814W measurements from HCV <a name="summary"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-variable-classification-columns">Description of the variable classification columns <a name="classification"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-objects-with-measurements-in-both-f475w-and-f814w">Find objects with measurements in both F475W and F814W</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-object-positions-on-the-sky">Plot object positions on the sky <a name="positions"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-hcv-mad-variability-index-versus-magnitude-in-f475w">Plot HCV MAD variability index versus magnitude in F475W <a name="variability"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-variables-in-color-magnitude-diagram">Plot variables in color-magnitude diagram <a name="cmd"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-a-light-curve-for-a-nova-in-m87">Get a light curve for a nova in M87 <a name="m87"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-light-curve-for-a-given-matchid">Extract light curve for a given MatchID <a name="lightcurve"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-hla-image-cutouts-for-the-nova">Get HLA image cutouts for the nova <a name="cutouts"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-hcv-automatic-classification-to-expert-validations">Compare the HCV automatic classification to expert validations <a name="expert"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-mad-variability-index-distribution-with-expert-classifications">Plot the MAD variability index distribution with expert classifications <a name="mad_expert"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-bins">Data &amp; Bins</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plots">Plots</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-fraction-of-artifacts-as-a-function-of-mad-variability-index">Plot the fraction of artifacts as a function of MAD variability index <a name="artifacts"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-light-curve-for-the-most-variable-high-quality-candidate-in-the-hcv">Plot light curve for the most variable high quality candidate in the HCV <a name="most_variable"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>