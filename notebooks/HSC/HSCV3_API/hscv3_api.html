
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hubble Source Catalog API Notebook &#8212; MAST Notebook Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css?v=32d70693" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css?v=cd6c26fb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-SK672ZMP7G"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=afe5de03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-SK672ZMP7G');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/HSC/HSCV3_API/hscv3_api';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram" href="../HSCV3_SMC_API/hscv3_smc_api.html" />
    <link rel="prev" title="Hubble Catalog of Variables Notebook (API version)" href="../HCV_API/HCV_API_demo.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/mastlogo.svg" class="logo__image only-light" alt="MAST Notebook Repository - Home"/>
    <script>document.write(`<img src="../../../_static/mastlogo.svg" class="logo__image only-dark" alt="MAST Notebook Repository - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to the MAST Notebook Repository!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Astrocut</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../astrocut/making_tess_cubes_and_cutouts/making_tess_cubes_and_cutouts.html">Generating Cubes and Cutouts from TESS FFIs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Astroquery</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../astroquery/intro.html">Intro</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../astroquery/nb.html">Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../astroquery/beginner_search/beginner_search.html">Beginner: Searching MAST using astroquery.mast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astroquery/beginner_zcut/beginner_zcut.html">Beginner: Zcut and Astroquery Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astroquery/large_downloads/large_downloads.html">Large Downloads in <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../astroquery/historic_quasar_observations/historic_quasar_observations.html">Historical Quasar Observations</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../astroquery/wildcard_searches/wildcard_searches.html">Wildcard Handling with Astroquery.mast</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HSC</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../HCV_API/HCV_API_demo.html">Hubble Catalog of Variables Notebook (API version)</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hubble Source Catalog API Notebook</a></li>



<li class="toctree-l1"><a class="reference internal" href="../HSCV3_SMC_API/hscv3_smc_api.html">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</a></li>



<li class="toctree-l1"><a class="reference internal" href="../HSC_TAP/HSC_TAP.html">MAST Table Access Protocol Hubble Source Catalog Demo</a></li>

<li class="toctree-l1"><a class="reference internal" href="../SWEEPS_HSCV3P1/sweeps_hscv3p1.html">Hubble Source Catalog SWEEPS Proper Motion Notebook</a></li>






















</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">IUE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../IUE/exploring_UV_extinction_curves/exploring_UV_extinction_curves.html">Exploring UV Extinction Curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JWST</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JWST/download_by_program_id/download_by_program_id.html">Accessing JWST Proposal Data in astroquery.mast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/duplication_checking/duplication_checking.html">JWST Duplication Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../JWST/Engineering_Database_Retreival/EDB_Retrieval.html">JWST Engineering Data Retrieval</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../JWST/SI_keyword_exoplanet_search/SI_keyword_exoplanet_search.html">JWST SI Keyword Search for Exoplanet Spectra</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kepler</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/beginner.html">Beginner Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_lightcurves/plotting_lightcurves.html">Using Kepler Data to Plot a Light Curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_images_from_tpf/plotting_images_from_tpf.html">Plotting Images from Kepler Target Pixel Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_dvts/plotting_dvts.html">Read and Plot A Kepler Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/plotting_catalog_over_FFI/plotting_catalog_over_FFI.html">Plotting a Catalog over a Kepler Full Frame Image File</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/lightkurve.html">Lightkurve</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_lc_products/lightkurve_analyzing_lc_products.html">Using <em>Kepler</em> Light Curve Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_analyzing_tpf_products/lightkurve_analyzing_tpf_products.html">Using <em>Kepler</em> Target Pixel File Products with Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_searching_for_data/lightkurve_searching_for_data.html">Searching for <em>Kepler</em>/<em>K2</em> and <em>TESS</em> Data Products Using Lightkurve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_custom_aperture_photometry/lightkurve_custom_aperture_photometry.html">Creating Your Own Light Curves using Custom Aperture Photometry</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_combining_multiple_quarters/lightkurve_combining_multiple_quarters.html">Combining Multiple Quarters of <em>Kepler</em> Data with Lightkurve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/lightkurve_interactively_inspecting_TPFs_and_LCs/lightkurve_interactively_inspecting_TPFs_and_LCs.html">Interactively Inspecting Target Pixel Files and Light Curves</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/inst_noise.html">Instrumental Noise</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_1_data_gaps_and_quality_flags/instrumental_noise_1_data_gaps_and_quality_flags.html">Data Gaps and Quality Flags</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_2_spurious_signals_and_time_sampling_effects/instrumental_noise_2_spurious_signals_and_time_sampling_effects.html">Spurious Signals and Time Sampling Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_3_seasonal_and_detector_effects/instrumental_noise_3_seasonal_and_detector_effects.html">Seasonal and Detector Effects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/instrumental_noise_4_electronic_noise/instrumental_noise_4_electronic_noise.html">Electronic Noise</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/signals.html">Identifying Periodic Signals</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/identifying_transiting_planet_signals/identifying_transiting_planet_signals.html">Identifying Transiting Planet Signals in a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/measuring_a_rotation_period/measuring_a_rotation_period.html">Measuring and Removing a Rotation Period Signal from a <em>Kepler</em> Light Curve</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/visualizing_periodic_signals_using_a_river_plot/visualizing_periodic_signals_using_a_river_plot.html">Visualizing Periodic Signals Using a River Plot</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/verifying_the_location_of_a_signal/verifying_the_location_of_a_signal.html">Verifying the Location of a Signal in <em>Kepler</em> Pixel Data</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Kepler/periodograms.html">Periodograms &amp; Asteroseismology</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Kepler/creating_periodograms/creating_periodograms.html">Creating Periodograms</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star/how_to_understand_and_manipulate_the_periodogram_of_an_oscillating_star.html">How to Understand and Manipulate the Periodogram of an Oscillating Star</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Kepler/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology/how_to_estimate_a_stars_mass_and_radius_using_asteroseismology.html">How to Estimate a Star’s Mass and Radius Using Asteroseismology</a></li>

</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">K2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../K2/TPF/TPF.html">Beginner: Read and Display A K2 Target Pixel File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Beginner: Read and Display a K2 Full Frame Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../K2/removing_instrumental_noise_using_pld/removing_instrumental_noise_using_pld.html">Removing Instrumental Noise from <em>K2</em> and <em>TESS</em> Light Curves Using Pixel Level Decorrelation (PLD)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MCCM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MCCM/FIMS-SPEAR/hyperspectral_healpix_maps/hyperspectral_healpix_maps.html">Working with FIMS-SPEAR Hyperspectral HEALPix Maps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PanSTARRS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_DR2_TAP/PS1_DR2_TAP.html">MAST Table Access Protocol PanSTARRS 1 DR2 Demo</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../PanSTARRS/PS1_image/PS1_image.html">Get Images from the PS1 Image Server</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">TESS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/beginner.html">Beginner Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_astroquery_dv/beginner_astroquery_dv.html">Retrieve TESS Data Validation Products with Astroquery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_dvt/beginner_how_to_use_dvt.html">Read and Plot A TESS Data Validation Timeseries File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_ffi/beginner_how_to_use_ffi.html">Read and Display a TESS Full Frame Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_lc/beginner_how_to_use_lc.html">Read and Plot A TESS Light Curve File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_how_to_use_tp/beginner_how_to_use_tp.html">Read and Display A TESS Target Pixel File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_exomast/beginner_tess_exomast.html">Exoplanet Data and TESS Light Curves Using Python Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tess_tap_search/beginner_tess_tap_search.html">Download MAST TESS Light Curves Within an FFI Footprint Using TAP</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tic_search_hd209458/beginner_tic_search_hd209458.html">Search The TESS Input Catalog Centered On HD 209458.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tour_lc_tp/beginner_tour_lc_tp.html">A Tour of the Contents of the TESS 2-minute Cadence Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/beginner_tesscut_astroquery/beginner_tesscut_astroquery.html">Cutout of the TESS FFIs using Astrocut and Astroquery</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/lc.html">Light Curves</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_gi_query/interm_gi_query.html">Intermediate:  Search and Download GI Program Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tasoc_lc/interm_tasoc_lc.html">Intermediate: Finding Flares and Variable Stars in TASOC Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/asteroid_rotation/asteroid_rotation.html">Finding the Rotation Curve of an Asteroid or Comet with TESScut and Lightkurve</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/FFIs.html">TESS FFIs</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_dss_overlay/interm_tesscut_dss_overlay.html">Intermediate: Overlay a Cutout of the TESS FFIs with DSS imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tesscut_requests/interm_tesscut_requests.html">Intermediate: Create TESS FFI Cutout using Python Requests</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TESS/noise.html">Instrumental Noise</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/interm_tess_prf_retrieve/interm_tess_prf_retrieve.html">Intermediate: Retrieve TESS Pixel Response Function Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TESS/removing_scattered_light_using_regression/removing_scattered_light_using_regression.html">Removing Scattered Light from <em>TESS</em> Data Using the Lightkurve <code class="docutils literal notranslate"><span class="pre">RegressionCorrector</span></code></a></li>

</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/spacetelescope/mast_notebooks/main?urlpath=tree/notebooks/HSC/HSCV3_API/hscv3_api.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/mast_notebooks/blob/main/notebooks/HSC/HSCV3_API/hscv3_api.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/mast_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/HSC/HSCV3_API/hscv3_api.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/HSC/HSCV3_API/hscv3_api.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hubble Source Catalog API Notebook</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Hubble Source Catalog API Notebook</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rick-white-trenton-mckinney">2019 - 2022, Rick White, Trenton McKinney</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization <a class="anchor" id="Initialization"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-python-modules">Install Python modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-api-functions">MAST API functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-metadata-on-available-columns">Get metadata on available columns <a name="metadata"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-variable-objects-in-the-dwarf-irregular-galaxy-ic-1613">Find variable objects in the dwarf irregular galaxy IC 1613 <a name="ic1613"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-astropy-name-resolver-to-get-position-of-ic-1613">Use <code class="docutils literal notranslate"><span class="pre">astropy</span></code> name resolver to get position of IC 1613 <a name="resolver"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-objects-with-enough-measurements-to-determine-variability">Select objects with enough measurements to determine variability <a name="summary"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-object-positions-on-the-sky">Plot object positions on the sky</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-mad-variability-index-versus-magnitude-in-f475w">Plot MAD variability index versus magnitude in F475W <a name="variability"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-positions-of-variable-objects-in-a-color-magnitude-diagram">Check positions of variable objects in a color-magnitude diagram <a name="cmd"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-the-api-for-the-light-curve-for-one-of-the-objects">Query the API for the light curve for one of the objects <a name="lightcurve"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-separate-light-curves-for-f475w-and-f814w-from-the-detailed-table">Get separate light curves for F475W and F814W from the detailed table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-light-curves">Plot the light curves</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-hla-cutout-images-for-the-f475w-images">Extract HLA cutout images for the F475W images <a name="cutouts"></a></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="hubble-source-catalog-api-notebook">
<h1>Hubble Source Catalog API Notebook<a class="headerlink" href="#hubble-source-catalog-api-notebook" title="Link to this heading">#</a></h1>
<section id="rick-white-trenton-mckinney">
<h2>2019 - 2022, Rick White, Trenton McKinney<a class="headerlink" href="#rick-white-trenton-mckinney" title="Link to this heading">#</a></h2>
<p>A <a class="reference external" href="https://catalogs.mast.stsci.edu/hsc">new MAST interface</a> supports queries to the current and previous versions of the <a class="reference external" href="https://archive.stsci.edu/hst/hsc">Hubble Source Catalog</a>. It allows searches of the summary table (with multi-filter mean photometry) and the detailed table (with all the multi-epoch measurements).  It also has an associated <a class="reference external" href="https://catalogs.mast.stsci.edu/docs/hsc.html">API</a>, which is used in this notebook.</p>
<p>This is based on <a class="reference external" href="https://archive.stsci.edu/hst/hsc/help/use_case_3_v2.html">HSC Use Case #3</a>.</p>
<ul class="simple">
<li><p>It searches the HSC for variable objects in the vicinity of dwarf galaxy IC 1613,</p></li>
<li><p>shows the positions of those objects in a color-magnitude diagram,</p></li>
<li><p>extracts light curves for an example object, and</p></li>
<li><p>displays cutout images from the Hubble observations that were used for the light curve measurements.</p></li>
</ul>
<p>The whole process takes only 30 seconds to complete.</p>
<p>Another <a class="reference internal" href="../HSCV3_SMC_API/hscv3_smc_api.html"><span class="std std-doc">notebook</span></a> generates a color-magnitude diagram for the Small Magellanic Cloud in only a couple of minutes.  A more complex notebook that shows how to access the proper motion tables using the HSC API is also <a class="reference internal" href="../SWEEPS_HSCV3P1_API/sweeps_hscv3p1_api.html"><span class="std std-doc">available</span></a>.</p>
</section>
</section>
<section id="instructions">
<h1>Instructions:<a class="headerlink" href="#instructions" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Complete the initialization steps <a class="reference internal" href="#Initialization"><span class="xref myst">described below</span></a>.</p></li>
<li><p>Run the notebook.</p></li>
</ul>
<p>Running the notebook from top to bottom takes about 30 seconds.</p>
</section>
<section id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="#Initialization"><span class="xref myst">Initialization</span></a></p></li>
<li><p><a class="reference internal" href="#metadata"><span class="xref myst">Get metadata on available HSC columns</span></a></p></li>
<li><p><a class="reference internal" href="#ic1613"><span class="xref myst">Find variable objects in IC 1613</span></a></p>
<ul>
<li><p><a class="reference internal" href="#resolver"><span class="xref myst">Use MAST name resolver</span></a></p></li>
<li><p><a class="reference internal" href="#summary"><span class="xref myst">Search HSC summary table</span></a></p></li>
<li><p><a class="reference internal" href="#variability"><span class="xref myst">Plot variability index versus magnitude</span></a></p></li>
<li><p><a class="reference internal" href="#cmd"><span class="xref myst">Show variable objects in a color-magnitude diagram</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#lightcurve"><span class="xref myst">Get HSC light curve for a variable</span></a></p></li>
<li><p><a class="reference internal" href="#cutouts"><span class="xref myst">Extract HLA cutout images for the variable</span></a></p></li>
</ul>
</section>
<section id="initialization">
<h1>Initialization <a class="anchor" id="Initialization"></a><a class="headerlink" href="#initialization" title="Link to this heading">#</a></h1>
<section id="install-python-modules">
<h2>Install Python modules<a class="headerlink" href="#install-python-modules" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><em>This notebook requires the use of <strong>Python 3</strong>.</em></p></li>
<li><p>Modules can be installed with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, if using the <a class="reference external" href="https://catalogs.mast.stsci.edu/hsc">Anaconda distribution</a> of python, or with <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<ul class="simple">
<li><p>If you are using <code class="docutils literal notranslate"><span class="pre">conda</span></code>, do not install / update / remove a module with <code class="docutils literal notranslate"><span class="pre">pip</span></code>, that exists in a <code class="docutils literal notranslate"><span class="pre">conda</span></code> <a class="reference external" href="https://archive.stsci.edu/hst/hsc">channel</a>.</p></li>
<li><p>If a module is not available with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, then it’s okay to install it with <code class="docutils literal notranslate"><span class="pre">pip</span></code></p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span><span class="p">,</span> <span class="n">StringIO</span>

<span class="c1"># set width for pprint</span>
<span class="n">astropy</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">max_width</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set universal matplotlib parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mast-api-functions">
<h2>MAST API functions<a class="headerlink" href="#mast-api-functions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Execute HSC searches and resolve names using <a class="reference external" href="https://catalogs.mast.stsci.edu/hsc">MAST query</a>.</p></li>
<li><p>Here we define several interrelated functions for retrieving information from the MAST API.</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvcone(ra,</span> <span class="pre">dec,</span> <span class="pre">radius</span> <span class="pre">[,</span> <span class="pre">keywords])</span></code> function searches the HCV catalog near a position.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvsearch()</span></code> function performs general non-positional queries.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hcvmetadata()</span></code> function gives information about the columns available in a table.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hscapiurl</span> <span class="o">=</span> <span class="s2">&quot;https://catalogs.mast.stsci.edu/api/v0.1/hsc&quot;</span>


<span class="k">def</span> <span class="nf">hsccone</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do a cone search of the HSC catalog</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ra (float): (degrees) J2000 Right Ascension</span>
<span class="sd">    dec (float): (degrees) J2000 Declination</span>
<span class="sd">    radius (float): (degrees) Search radius (&lt;= 0.5 degrees)</span>
<span class="sd">    table (string): summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    format: csv, votable, json, table</span>
<span class="sd">    columns: list of column names to include (None means use defaults)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    verbose: print info about request</span>
<span class="sd">    **kw: other parameters (e.g., &#39;numimages.gte&#39;:2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ra</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span>
    <span class="k">return</span> <span class="n">hscsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="n">release</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="n">magtype</span><span class="p">,</span>
                     <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">hscsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span>
              <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Do a general search of the HSC catalog (possibly without ra/dec/radius)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    format: csv, votable, json, table</span>
<span class="sd">    columns: list of column names to include (None means use defaults)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    verbose: print info about request</span>
<span class="sd">    **kw: other parameters (e.g., &#39;numimages.gte&#39;:2).  Note this is required!</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must specify some parameters for search&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s1">&#39;table&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Bad value for format&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span><span class="p">:</span>
        <span class="n">rformat</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rformat</span> <span class="o">=</span> <span class="nb">format</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cat2url</span><span class="p">(</span><span class="n">table</span><span class="p">,</span><span class="w"> </span><span class="n">release</span><span class="p">,</span><span class="w"> </span><span class="n">magtype</span><span class="p">,</span><span class="w"> </span><span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">rformat</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
        <span class="c1"># check that column values are legal</span>
        <span class="c1"># create a dictionary to speed this up</span>
        <span class="n">dcols</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">hscmetadata</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">)[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
            <span class="n">dcols</span><span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">badcols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dcols</span><span class="p">:</span>
                <span class="n">badcols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">badcols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Some columns not found in table: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">badcols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># two different ways to specify a list of column values in the API</span>
        <span class="c1"># data[&#39;columns&#39;] = columns</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>

    <span class="c1"># either get or post works</span>
    <span class="c1"># r = requests.post(url, data=data)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span><span class="p">:</span>
        <span class="c1"># use pandas to work around bug in Windows for ascii.read</span>
        <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>


<span class="k">def</span> <span class="nf">hscmetadata</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return metadata for the specified catalog and table</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    </span>
<span class="sd">    Returns an astropy table with columns name, type, description</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cat2url</span><span class="p">(</span><span class="n">table</span><span class="p">,</span><span class="w"> </span><span class="n">release</span><span class="p">,</span><span class="w"> </span><span class="n">magtype</span><span class="p">,</span><span class="w"> </span><span class="n">baseurl</span><span class="o">=</span><span class="n">baseurl</span><span class="p">)</span><span class="si">}</span><span class="s2">/metadata&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1"># convert to astropy table</span>
    <span class="n">tab</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span><span class="p">],</span>
                <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tab</span>


<span class="k">def</span> <span class="nf">cat2url</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="n">magtype</span><span class="o">=</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="n">baseurl</span><span class="o">=</span><span class="n">hscapiurl</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return URL for the specified catalog and table</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table (string): summary, detailed, propermotions, or sourcepositions</span>
<span class="sd">    release (string): v3 or v2</span>
<span class="sd">    magtype (string): magaper2 or magauto (only applies to summary table)</span>
<span class="sd">    baseurl: base URL for the request</span>
<span class="sd">    </span>
<span class="sd">    Returns a string with the base URL for this request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">checklegal</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;summary&quot;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">baseurl</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">magtype</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">baseurl</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">url</span>


<span class="k">def</span> <span class="nf">checklegal</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">release</span><span class="p">,</span> <span class="n">magtype</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if this combination of table, release and magtype is acceptable</span>
<span class="sd">    </span>
<span class="sd">    Raises a ValueError exception if there is problem</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">releaselist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;v2&quot;</span><span class="p">,</span> <span class="s2">&quot;v3&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">release</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">releaselist</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for release (must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">releaselist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">release</span> <span class="o">==</span> <span class="s2">&quot;v2&quot;</span><span class="p">:</span>
        <span class="n">tablelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="s2">&quot;detailed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tablelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="s2">&quot;detailed&quot;</span><span class="p">,</span> <span class="s2">&quot;propermotions&quot;</span><span class="p">,</span> <span class="s2">&quot;sourcepositions&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tablelist</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for table (for </span><span class="si">{</span><span class="n">release</span><span class="si">}</span><span class="s2"> must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tablelist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;summary&quot;</span><span class="p">:</span>
        <span class="n">magtypelist</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;magaper2&quot;</span><span class="p">,</span> <span class="s2">&quot;magauto&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">magtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">magtypelist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad value for magtype (must be one of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">magtypelist</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-metadata-on-available-columns">
<h2>Get metadata on available columns <a name="metadata"></a><a class="headerlink" href="#get-metadata-on-available-columns" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">metadata</span></code> query returns information on the columns in the table.  It works for any of the tables in the API (<code class="docutils literal notranslate"><span class="pre">summary</span></code>, <code class="docutils literal notranslate"><span class="pre">detailed</span></code>, <code class="docutils literal notranslate"><span class="pre">propermotions</span></code>, <code class="docutils literal notranslate"><span class="pre">sourcepositions</span></code>).</p>
<p>Note that the summary table has a huge number of columns!  Each of the 133 filter/detector combinations has 3 columns with the magnitude, median absolute deviation (MAD, a robust measure of the scatter among the measurements), and the number of independent measurements in the filter.  The filter name includes a prefix for the detector (<code class="docutils literal notranslate"><span class="pre">A</span></code>=ACS/WFC, <code class="docutils literal notranslate"><span class="pre">W3</span></code>=WFC3/UVIS or WFC3/IR, <code class="docutils literal notranslate"><span class="pre">W2</span></code>=WFPC2) followed by the standard name of the filter.  So for instance all three instruments have an F814W filter, so there are columns for <code class="docutils literal notranslate"><span class="pre">A_F814W</span></code>, <code class="docutils literal notranslate"><span class="pre">W3_F814W</span></code>, and <code class="docutils literal notranslate"><span class="pre">W2_F814W</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span> <span class="o">=</span> <span class="n">hscmetadata</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meta</span><span class="p">),</span> <span class="s2">&quot;columns in summary&quot;</span><span class="p">)</span>
<span class="n">filterlist</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="mi">19</span><span class="p">::</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filterlist</span><span class="p">),</span> <span class="s2">&quot;filters&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">filterlist</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">meta</span><span class="p">[:</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>418 columns in summary
133 filters
[&#39;W3_BLANK&#39;, &#39;W2_F122M&#39;, &#39;W2_F160BN15&#39;, &#39;W2_F160BW&#39;, &#39;W2_F170W&#39;, &#39;W2_F185W&#39;,
 &#39;W3_F200LP&#39;, &#39;W3_F218W&#39;, &#39;W2_F218W&#39;, &#39;W3_F225W&#39;, &#39;W3_FQ232N&#39;, &#39;W3_FQ243N&#39;,
 &#39;W2_F255W&#39;, &#39;W3_F275W&#39;, &#39;W3_F280N&#39;, &#39;W3_G280&#39;, &#39;W2_F300W&#39;, &#39;W3_F300X&#39;,
 &#39;W3_F336W&#39;, &#39;W2_F336W&#39;, &#39;W3_F343N&#39;, &#39;W2_F343N&#39;, &#39;W3_F350LP&#39;, &#39;W3_F373N&#39;,
 &#39;W2_F375N&#39;, &#39;W3_FQ378N&#39;, &#39;W2_F380W&#39;, &#39;W3_FQ387N&#39;, &#39;W3_F390M&#39;, &#39;W2_F390N&#39;,
 &#39;W3_F390W&#39;, &#39;W3_F395N&#39;, &#39;W3_F410M&#39;, &#39;W2_F410M&#39;, &#39;W3_FQ422M&#39;, &#39;A_F435W&#39;,
 &#39;W3_FQ436N&#39;, &#39;W3_FQ437N&#39;, &#39;W2_F437N&#39;, &#39;W3_F438W&#39;, &#39;W2_F439W&#39;, &#39;W2_F450W&#39;,
 &#39;W3_F467M&#39;, &#39;W2_F467M&#39;, &#39;W3_F469N&#39;, &#39;W2_F469N&#39;, &#39;A_F475W&#39;, &#39;W3_F475W&#39;,
 &#39;W3_F475X&#39;, &#39;W3_F487N&#39;, &#39;W2_F487N&#39;, &#39;W3_FQ492N&#39;, &#39;A_F502N&#39;, &#39;W3_F502N&#39;,
 &#39;W2_F502N&#39;, &#39;W3_FQ508N&#39;, &#39;W3_F547M&#39;, &#39;W2_F547M&#39;, &#39;A_F550M&#39;, &#39;A_F555W&#39;,
 &#39;W3_F555W&#39;, &#39;W2_F555W&#39;, &#39;W2_F569W&#39;, &#39;W3_FQ575N&#39;, &#39;W2_F588N&#39;, &#39;W3_F600LP&#39;,
 &#39;A_F606W&#39;, &#39;W3_F606W&#39;, &#39;W2_F606W&#39;, &#39;W3_FQ619N&#39;, &#39;W3_F621M&#39;, &#39;W2_F622W&#39;,
 &#39;A_F625W&#39;, &#39;W3_F625W&#39;, &#39;W3_F631N&#39;, &#39;W2_F631N&#39;, &#39;W3_FQ634N&#39;, &#39;W3_F645N&#39;,
 &#39;W3_F656N&#39;, &#39;W2_F656N&#39;, &#39;W3_F657N&#39;, &#39;A_F658N&#39;, &#39;W3_F658N&#39;, &#39;W2_F658N&#39;,
 &#39;A_F660N&#39;, &#39;W3_F665N&#39;, &#39;W3_F665N_F6&#39;, &#39;W3_FQ672N&#39;, &#39;W3_F673N&#39;, &#39;W2_F673N&#39;,
 &#39;W3_FQ674N&#39;, &#39;W2_F675W&#39;, &#39;W3_F680N&#39;, &#39;W3_F689M&#39;, &#39;W2_F702W&#39;, &#39;W3_FQ727N&#39;,
 &#39;W3_FQ750N&#39;, &#39;W3_F763M&#39;, &#39;A_F775W&#39;, &#39;W3_F775W&#39;, &#39;W2_F785LP&#39;, &#39;W2_F791W&#39;,
 &#39;A_F814W&#39;, &#39;W3_F814W&#39;, &#39;W2_F814W&#39;, &#39;W3_F845M&#39;, &#39;A_F850LP&#39;, &#39;W3_F850LP&#39;,
 &#39;W2_F850LP&#39;, &#39;W3_FQ889N&#39;, &#39;W3_FQ906N&#39;, &#39;W3_FQ924N&#39;, &#39;W3_FQ937N&#39;, &#39;W3_F953N&#39;,
 &#39;W2_F953N&#39;, &#39;W3_F098M&#39;, &#39;W3_G102&#39;, &#39;W2_F1042M&#39;, &#39;W3_F105W&#39;, &#39;W3_F110W&#39;,
 &#39;W3_F125W&#39;, &#39;W3_F126N&#39;, &#39;W3_F127M&#39;, &#39;W3_F128N&#39;, &#39;W3_F130N&#39;, &#39;W3_F132N&#39;,
 &#39;W3_F139M&#39;, &#39;W3_F140W&#39;, &#39;W3_G141&#39;, &#39;W3_F153M&#39;, &#39;W3_F160W&#39;, &#39;W3_F164N&#39;,
 &#39;W3_F167N&#39;]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=19</i>
<table id="table140354300429904" class="table-striped table-bordered table-condensed">
<thead><tr><th>name</th><th>type</th><th>description</th></tr></thead>
<thead><tr><th>str16</th><th>str5</th><th>str163</th></tr></thead>
<tr><td>MatchID</td><td>long</td><td>identifier for the match</td></tr>
<tr><td>MatchRA</td><td>float</td><td>right ascension coordinate of the match position</td></tr>
<tr><td>MatchDec</td><td>float</td><td>declination coordinate of the match position</td></tr>
<tr><td>DSigma</td><td>float</td><td>standard deviation of source positions in match</td></tr>
<tr><td>AbsCorr</td><td>char</td><td>indicator of whether the match contains sources that are aligned to a standard catalog</td></tr>
<tr><td>NumFilters</td><td>int</td><td>number of filters in match with sources detected in the aper2 aperture</td></tr>
<tr><td>NumVisits</td><td>int</td><td>number of visits in match with sources detected in the aper2 aperture</td></tr>
<tr><td>NumImages</td><td>int</td><td>number of Hubble Legacy Archive single filter, visit-combined (level 2) images in match with sources detected in the aper2 aperture</td></tr>
<tr><td>StartTime</td><td>char</td><td>earliest start time of exposures in match with sources detected in the aper2 aperture</td></tr>
<tr><td>StopTime</td><td>char</td><td>latest stop time of exposures in match with sources detected in the aper2 aperture</td></tr>
<tr><td>StartMJD</td><td>float</td><td>modified Julian date (MJD) for earliest start time of exposures in match with sources detected in the aper2 aperture</td></tr>
<tr><td>StopMJD</td><td>float</td><td>modified Julian date (MJD) for latest stop time of exposures in match with sources detected in the aper2 aperture</td></tr>
<tr><td>TargetName</td><td>char</td><td>name of a target for an exposure in match</td></tr>
<tr><td>CI</td><td>float</td><td>average normalized concentration index for sources detected in the aper2 aperture within the match</td></tr>
<tr><td>CI_Sigma</td><td>float</td><td>standard deviation of normalized concentration index values for sources detected in the aper2 aperture within the match</td></tr>
<tr><td>KronRadius</td><td>float</td><td>average Kron radius for sources detected in the aper2 aperture within the match</td></tr>
<tr><td>KronRadius_Sigma</td><td>float</td><td>standard deviation of Kron radius values for sources detected in the aper2 aperture within the match</td></tr>
<tr><td>Extinction</td><td>float</td><td>extinction, obtained from the NASA/IPAC Extragalactic Database (NED), along the line of sight to the match position</td></tr>
<tr><td>SpectrumFlag</td><td>char</td><td>Y/N indicator of whether there is a spectrum in the Hubble Legacy Archive for this match. If the value is Y, then there is an entry in table SpecCat for the match.</td></tr>
</table></div></div></div>
</div>
</section>
<section id="find-variable-objects-in-the-dwarf-irregular-galaxy-ic-1613">
<h2>Find variable objects in the dwarf irregular galaxy IC 1613 <a name="ic1613"></a><a class="headerlink" href="#find-variable-objects-in-the-dwarf-irregular-galaxy-ic-1613" title="Link to this heading">#</a></h2>
<p>This is based on <a class="reference external" href="https://archive.stsci.edu/hst/hsc/help/use_case_3_v2.html">HSC Use Case #3</a>, which shows an example of selecting objects from the HSC in portal.  This is simple to do using the HSC API.</p>
<section id="use-astropy-name-resolver-to-get-position-of-ic-1613">
<h3>Use <code class="docutils literal notranslate"><span class="pre">astropy</span></code> name resolver to get position of IC 1613 <a name="resolver"></a><a class="headerlink" href="#use-astropy-name-resolver-to-get-position-of-ic-1613" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;IC 1613&#39;</span>
<span class="n">coord_ic1613</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

<span class="n">ra_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span>
<span class="n">dec_ic1613</span> <span class="o">=</span> <span class="n">coord_ic1613</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">degree</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ra: </span><span class="si">{</span><span class="n">ra_ic1613</span><span class="si">}</span><span class="se">\n</span><span class="s1">dec: </span><span class="si">{</span><span class="n">dec_ic1613</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ra: 16.2016962
dec: 2.1194959
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-objects-with-enough-measurements-to-determine-variability">
<h3>Select objects with enough measurements to determine variability <a name="summary"></a><a class="headerlink" href="#select-objects-with-enough-measurements-to-determine-variability" title="Link to this heading">#</a></h3>
<p>This searches the summary table for objects within 0.5 degrees of the galaxy center that have at least 10 measurements in both ACS F475W and F814W.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save typing a quoted list of columns</span>
<span class="n">columns</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;MatchID,MatchRA,MatchDec,NumFilters,NumVisits,NumImages,StartMJD,StopMJD,</span>
<span class="s2">    A_F475W, A_F475W_N, A_F475W_MAD,</span>
<span class="s2">    A_F814W, A_F814W_N, A_F814W_MAD&quot;&quot;&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A_F475W_N.gte&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;A_F814W_N.gte&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">hsccone</span><span class="p">(</span><span class="n">ra_ic1613</span><span class="p">,</span> <span class="n">dec_ic1613</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">constraints</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: retrieved data and converted to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">}</span><span class="s2">-row astropy table&quot;</span><span class="p">)</span>

<span class="c1"># clean up the output format</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W_MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F814W&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F814W_MAD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchRA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchDec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.6f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;StartMJD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;StopMJD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span>
<span class="n">tab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>https://catalogs.mast.stsci.edu/api/v0.1/hsc/v3/summary/magaper2.csv?A_F475W_N.gte=10&amp;A_F814W_N.gte=10&amp;ra=16.2016962&amp;dec=2.1194959&amp;radius=0.5&amp;columns=%5BMatchID%2CMatchRA%2CMatchDec%2CNumFilters%2CNumVisits%2CNumImages%2CStartMJD%2CStopMJD%2CA_F475W%2CA_F475W_N%2CA_F475W_MAD%2CA_F814W%2CA_F814W_N%2CA_F814W_MAD%5D
25.1 s: retrieved data and converted to 18666-row astropy table
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=18666</i>
<table id="table140354227919248" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>MatchRA</th><th>MatchDec</th><th>NumFilters</th><th>NumVisits</th><th>NumImages</th><th>StartMJD</th><th>StopMJD</th><th>A_F475W</th><th>A_F475W_N</th><th>A_F475W_MAD</th><th>A_F814W</th><th>A_F814W_N</th><th>A_F814W_MAD</th></tr></thead>
<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th></tr></thead>
<tr><td>18854338</td><td>16.115819</td><td>2.157923</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>24.316</td><td>12</td><td>0.023</td><td>24.928</td><td>12</td><td>0.019</td></tr>
<tr><td>19313637</td><td>16.144422</td><td>2.141051</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>25.926</td><td>12</td><td>0.028</td><td>25.299</td><td>12</td><td>0.040</td></tr>
<tr><td>19319946</td><td>16.121077</td><td>2.135667</td><td>3</td><td>14</td><td>25</td><td>53965.29153</td><td>57009.86262</td><td>25.179</td><td>11</td><td>0.019</td><td>24.330</td><td>12</td><td>0.035</td></tr>
<tr><td>19328505</td><td>16.143311</td><td>2.167600</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>26.628</td><td>12</td><td>0.062</td><td>25.845</td><td>12</td><td>0.041</td></tr>
<tr><td>18135767</td><td>16.135782</td><td>2.138453</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>25.520</td><td>12</td><td>0.020</td><td>24.607</td><td>12</td><td>0.013</td></tr>
<tr><td>18135958</td><td>16.107451</td><td>2.176174</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>25.381</td><td>12</td><td>0.019</td><td>25.878</td><td>12</td><td>0.062</td></tr>
<tr><td>18141410</td><td>16.143524</td><td>2.149912</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>25.575</td><td>12</td><td>0.023</td><td>24.639</td><td>12</td><td>0.032</td></tr>
<tr><td>17842603</td><td>16.129039</td><td>2.185769</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>25.734</td><td>12</td><td>0.044</td><td>25.034</td><td>12</td><td>0.026</td></tr>
<tr><td>17850033</td><td>16.127122</td><td>2.137869</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>25.285</td><td>12</td><td>0.015</td><td>24.536</td><td>12</td><td>0.014</td></tr>
<tr><td>17853148</td><td>16.114348</td><td>2.130695</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>24.095</td><td>12</td><td>0.008</td><td>23.397</td><td>12</td><td>0.009</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>89803335</td><td>16.133838</td><td>2.188276</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>26.076</td><td>12</td><td>0.022</td><td>26.289</td><td>12</td><td>0.038</td></tr>
<tr><td>89810126</td><td>16.110690</td><td>2.171400</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>25.386</td><td>12</td><td>0.022</td><td>24.644</td><td>12</td><td>0.024</td></tr>
<tr><td>94329270</td><td>16.124819</td><td>2.180970</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>25.616</td><td>12</td><td>0.024</td><td>26.202</td><td>12</td><td>0.040</td></tr>
<tr><td>94332529</td><td>16.113486</td><td>2.186934</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>26.598</td><td>12</td><td>0.038</td><td>26.635</td><td>12</td><td>0.088</td></tr>
<tr><td>94496732</td><td>16.135226</td><td>2.174089</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>26.087</td><td>12</td><td>0.056</td><td>25.676</td><td>12</td><td>0.049</td></tr>
<tr><td>94504202</td><td>16.117662</td><td>2.138910</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>25.858</td><td>12</td><td>0.007</td><td>24.988</td><td>12</td><td>0.015</td></tr>
<tr><td>92872785</td><td>16.140646</td><td>2.149664</td><td>2</td><td>12</td><td>23</td><td>53965.29153</td><td>53967.71941</td><td>26.413</td><td>12</td><td>0.035</td><td>26.582</td><td>11</td><td>0.048</td></tr>
<tr><td>93014633</td><td>16.143971</td><td>2.152339</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>24.216</td><td>12</td><td>0.010</td><td>23.384</td><td>12</td><td>0.016</td></tr>
<tr><td>93036252</td><td>16.089931</td><td>2.158471</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>25.323</td><td>12</td><td>0.014</td><td>24.616</td><td>12</td><td>0.020</td></tr>
<tr><td>90241394</td><td>16.140476</td><td>2.170066</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>25.149</td><td>12</td><td>0.026</td><td>24.465</td><td>12</td><td>0.017</td></tr>
</table></div></div></div>
</div>
</section>
<section id="plot-object-positions-on-the-sky">
<h3>Plot object positions on the sky<a class="headerlink" href="#plot-object-positions-on-the-sky" title="Link to this heading">#</a></h3>
<p>We mark the galaxy center as well.  Note that this field is in the outskirts of IC 1613.  The 0.5 search radius (which is the maximum allowed in the API) allows finding these objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;MatchRA&#39;</span><span class="p">,</span> <span class="s1">&#39;MatchDec&#39;</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tab</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ra_ic1613</span><span class="p">,</span> <span class="n">dec_ic1613</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;RA [deg]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dec [deg]&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/7dfd1644164889bfb14c3d8834c2faf88bfbb33214a3f77ed2e68e709c6c32a9.png" src="../../../_images/7dfd1644164889bfb14c3d8834c2faf88bfbb33214a3f77ed2e68e709c6c32a9.png" />
</div>
</div>
</section>
<section id="plot-mad-variability-index-versus-magnitude-in-f475w">
<h3>Plot MAD variability index versus magnitude in F475W <a name="variability"></a><a class="headerlink" href="#plot-mad-variability-index-versus-magnitude-in-f475w" title="Link to this heading">#</a></h3>
<p>The median absolute deviation is measured among the ~12 magnitude measurements in the catalog.  Some scatter is expected from noise (which increases for fainter objects).   Objects with MAD values that are high are likely to be variable.</p>
<p>Select variable objects that are not too faint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wvar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W_MAD&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">21</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">,</span> <span class="s1">&#39;A_F475W_MAD&#39;</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tab</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">,</span> <span class="s1">&#39;A_F475W_MAD&#39;</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tab</span><span class="p">[</span><span class="n">wvar</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wvar</span><span class="p">)</span><span class="si">}</span><span class="s1"> variable candidates&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;A_F475W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;A_F475W_MAD [mag]&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/f4fc8c3b4b8500bf69f540d908a14e85e3c5d91712a0daf0d3cfa835e4dac65c.png" src="../../../_images/f4fc8c3b4b8500bf69f540d908a14e85e3c5d91712a0daf0d3cfa835e4dac65c.png" />
</div>
</div>
</section>
<section id="check-positions-of-variable-objects-in-a-color-magnitude-diagram">
<h3>Check positions of variable objects in a color-magnitude diagram <a name="cmd"></a><a class="headerlink" href="#check-positions-of-variable-objects-in-a-color-magnitude-diagram" title="Link to this heading">#</a></h3>
<p>Note that these objects are generally located in the Cepheid instability strip.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b_minus_i</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F814W&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">b_minus_i</span><span class="p">,</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span><span class="si">}</span><span class="s1"> HSC measurements near </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">b_minus_i</span><span class="p">[</span><span class="n">wvar</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">][</span><span class="n">wvar</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">wvar</span><span class="p">)</span><span class="si">}</span><span class="s1"> variable candidates&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;A_F475W - A_F814W [mag]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;A_F475W [mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/d03b9dcfa3f0236eeec4ffe2345f30909c3f0bf8eda3658730a451d1ec7ccd8b.png" src="../../../_images/d03b9dcfa3f0236eeec4ffe2345f30909c3f0bf8eda3658730a451d1ec7ccd8b.png" />
</div>
</div>
</section>
<section id="query-the-api-for-the-light-curve-for-one-of-the-objects">
<h3>Query the API for the light curve for one of the objects <a name="lightcurve"></a><a class="headerlink" href="#query-the-api-for-the-light-curve-for-one-of-the-objects" title="Link to this heading">#</a></h3>
<p>Select the most variable object as an example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wvar</span> <span class="o">=</span> <span class="n">wvar</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W_MAD&#39;</span><span class="p">][</span><span class="n">wvar</span><span class="p">])]</span>
<span class="n">iselect</span> <span class="o">=</span> <span class="n">wvar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MatchID </span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="n">iselect</span><span class="p">]</span><span class="si">}</span><span class="s2"> B = </span><span class="si">{</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;A_F475W&#39;</span><span class="p">][</span><span class="n">iselect</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> B-I = </span><span class="si">{</span><span class="n">b_minus_i</span><span class="p">[</span><span class="n">iselect</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="n">wvar</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MatchID 80189155 B = 22.451 B-I = 0.450
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=29</i>
<table id="table140354159732880" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>MatchRA</th><th>MatchDec</th><th>NumFilters</th><th>NumVisits</th><th>NumImages</th><th>StartMJD</th><th>StopMJD</th><th>A_F475W</th><th>A_F475W_N</th><th>A_F475W_MAD</th><th>A_F814W</th><th>A_F814W_N</th><th>A_F814W_MAD</th></tr></thead>
<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th></tr></thead>
<tr><td>80189155</td><td>16.140740</td><td>2.155288</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.451</td><td>12</td><td>0.294</td><td>22.001</td><td>12</td><td>0.198</td></tr>
<tr><td>8200488</td><td>16.144772</td><td>2.152338</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.202</td><td>12</td><td>0.260</td><td>21.768</td><td>12</td><td>0.188</td></tr>
<tr><td>66012678</td><td>16.135134</td><td>2.154740</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.559</td><td>12</td><td>0.253</td><td>22.101</td><td>12</td><td>0.192</td></tr>
<tr><td>63078526</td><td>16.105513</td><td>2.155580</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>23.317</td><td>12</td><td>0.227</td><td>22.897</td><td>12</td><td>0.138</td></tr>
<tr><td>89909862</td><td>16.117180</td><td>2.168810</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.733</td><td>12</td><td>0.224</td><td>22.545</td><td>12</td><td>0.099</td></tr>
<tr><td>92119358</td><td>16.136563</td><td>2.182817</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>23.347</td><td>12</td><td>0.213</td><td>23.234</td><td>12</td><td>0.131</td></tr>
<tr><td>66980564</td><td>16.125611</td><td>2.135287</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.732</td><td>12</td><td>0.194</td><td>22.365</td><td>12</td><td>0.138</td></tr>
<tr><td>95722356</td><td>16.133030</td><td>2.175638</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>23.359</td><td>12</td><td>0.180</td><td>22.921</td><td>12</td><td>0.129</td></tr>
<tr><td>68356083</td><td>16.095709</td><td>2.147460</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>23.378</td><td>12</td><td>0.176</td><td>22.981</td><td>12</td><td>0.109</td></tr>
<tr><td>45786610</td><td>16.121375</td><td>2.133853</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.901</td><td>12</td><td>0.174</td><td>22.557</td><td>12</td><td>0.131</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>69790109</td><td>16.141284</td><td>2.152881</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.635</td><td>12</td><td>0.133</td><td>22.138</td><td>12</td><td>0.071</td></tr>
<tr><td>100437228</td><td>16.111310</td><td>2.160908</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>23.382</td><td>12</td><td>0.123</td><td>22.914</td><td>12</td><td>0.070</td></tr>
<tr><td>30855111</td><td>16.105925</td><td>2.157603</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.781</td><td>12</td><td>0.117</td><td>22.698</td><td>12</td><td>0.056</td></tr>
<tr><td>70217468</td><td>16.107142</td><td>2.178161</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>23.804</td><td>12</td><td>0.116</td><td>23.428</td><td>12</td><td>0.116</td></tr>
<tr><td>9510698</td><td>16.137963</td><td>2.141027</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>23.343</td><td>12</td><td>0.114</td><td>23.101</td><td>12</td><td>0.080</td></tr>
<tr><td>13317380</td><td>16.118322</td><td>2.152817</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>23.599</td><td>12</td><td>0.109</td><td>23.169</td><td>12</td><td>0.091</td></tr>
<tr><td>17240899</td><td>16.139667</td><td>2.153597</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>22.761</td><td>12</td><td>0.105</td><td>22.195</td><td>12</td><td>0.073</td></tr>
<tr><td>105545986</td><td>16.144336</td><td>2.156262</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>23.160</td><td>12</td><td>0.104</td><td>22.941</td><td>12</td><td>0.138</td></tr>
<tr><td>66716166</td><td>16.132260</td><td>2.163512</td><td>3</td><td>14</td><td>26</td><td>53965.29153</td><td>57009.86262</td><td>23.075</td><td>12</td><td>0.104</td><td>22.864</td><td>12</td><td>0.075</td></tr>
<tr><td>63755650</td><td>16.095356</td><td>2.137338</td><td>2</td><td>12</td><td>24</td><td>53965.29153</td><td>53967.71941</td><td>22.729</td><td>12</td><td>0.103</td><td>22.442</td><td>12</td><td>0.062</td></tr>
</table></div></div></div>
</div>
<p>Get column metadata for detailed observation table (which has time-dependent magnitudes).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span> <span class="o">=</span> <span class="n">hscmetadata</span><span class="p">(</span><span class="s2">&quot;detailed&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meta</span><span class="p">),</span> <span class="s2">&quot;columns in detailed&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>39 columns in detailed
[&#39;CatID&#39;, &#39;MatchID&#39;, &#39;MemID&#39;, &#39;SourceID&#39;, &#39;ImageID&#39;, &#39;Det&#39;, &#39;MatchRA&#39;,
 &#39;MatchDec&#39;, &#39;SourceRA&#39;, &#39;SourceDec&#39;, &#39;D&#39;, &#39;DSigma&#39;, &#39;AbsCorr&#39;, &#39;XImage&#39;,
 &#39;YImage&#39;, &#39;ImageName&#39;, &#39;Instrument&#39;, &#39;Mode&#39;, &#39;Detector&#39;, &#39;Aperture&#39;,
 &#39;ExposureTime&#39;, &#39;StartTime&#39;, &#39;StopTime&#39;, &#39;StartMJD&#39;, &#39;StopMJD&#39;, &#39;WaveLength&#39;,
 &#39;Filter&#39;, &#39;TargetName&#39;, &#39;FluxAper2&#39;, &#39;MagAper2&#39;, &#39;MagAuto&#39;, &#39;PropID&#39;, &#39;CI&#39;,
 &#39;KronRadius&#39;, &#39;Flags&#39;, &#39;HTMID&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-separate-light-curves-for-f475w-and-f814w-from-the-detailed-table">
<h3>Get separate light curves for F475W and F814W from the detailed table<a class="headerlink" href="#get-separate-light-curves-for-f475w-and-f814w-from-the-detailed-table" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;MatchID,SourceID,StartMJD,Detector,Filter,MagAper2,Flags,ImageName&quot;&quot;&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)]</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MatchID&#39;</span><span class="p">:</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchID&#39;</span><span class="p">][</span><span class="n">iselect</span><span class="p">],</span> <span class="s1">&#39;Detector&#39;</span><span class="p">:</span> <span class="s1">&#39;ACS/WFC&#39;</span><span class="p">}</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">f475</span> <span class="o">=</span> <span class="n">hscsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;detailed&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;F475W&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">constraints</span><span class="p">)</span>
<span class="n">f814</span> <span class="o">=</span> <span class="n">hscsearch</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="s2">&quot;detailed&quot;</span><span class="p">,</span> <span class="n">release</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">Filter</span><span class="o">=</span><span class="s1">&#39;F814W&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">constraints</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s: retrieved data and converted to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">f475</span><span class="p">)</span><span class="si">}</span><span class="s2"> (F475W) and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">f814</span><span class="p">)</span><span class="si">}</span><span class="s2"> (F814W) row astropy tables&quot;</span><span class="p">)</span>

<span class="n">f475</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;StartMJD&#39;</span><span class="p">)</span>
<span class="n">f814</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;StartMJD&#39;</span><span class="p">)</span>
<span class="n">f475</span><span class="p">[</span><span class="s1">&#39;MagAper2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">f475</span><span class="p">[</span><span class="s1">&#39;StartMJD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span>
<span class="n">f814</span><span class="p">[</span><span class="s1">&#39;MagAper2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span>
<span class="n">f814</span><span class="p">[</span><span class="s1">&#39;StartMJD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span>

<span class="n">f475</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9 s: retrieved data and converted to 12 (F475W) and 12 (F814W) row astropy tables
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=12</i>
<table id="table140354227846992" class="table-striped table-bordered table-condensed">
<thead><tr><th>MatchID</th><th>SourceID</th><th>StartMJD</th><th>Detector</th><th>Filter</th><th>MagAper2</th><th>Flags</th><th>ImageName</th></tr></thead>
<thead><tr><th>int64</th><th>int64</th><th>float64</th><th>str7</th><th>str5</th><th>float64</th><th>int64</th><th>str26</th></tr></thead>
<tr><td>80189155</td><td>4000999062305</td><td>53965.29153</td><td>ACS/WFC</td><td>F475W</td><td>22.192</td><td>0</td><td>hst_10505_07_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4000992888001</td><td>53965.42473</td><td>ACS/WFC</td><td>F475W</td><td>22.246</td><td>0</td><td>hst_10505_08_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4001095116962</td><td>53965.55794</td><td>ACS/WFC</td><td>F475W</td><td>22.376</td><td>0</td><td>hst_10505_09_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4000922680735</td><td>53965.69115</td><td>ACS/WFC</td><td>F475W</td><td>22.552</td><td>0</td><td>hst_10505_10_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4001042276145</td><td>53966.29057</td><td>ACS/WFC</td><td>F475W</td><td>22.705</td><td>0</td><td>hst_10505_11_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4001225221390</td><td>53966.42377</td><td>ACS/WFC</td><td>F475W</td><td>22.802</td><td>0</td><td>hst_10505_12_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4000895760719</td><td>53966.55698</td><td>ACS/WFC</td><td>F475W</td><td>22.779</td><td>0</td><td>hst_10505_13_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4000814317863</td><td>53966.69019</td><td>ACS/WFC</td><td>F475W</td><td>22.801</td><td>0</td><td>hst_10505_14_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4000830929643</td><td>53967.22301</td><td>ACS/WFC</td><td>F475W</td><td>22.526</td><td>0</td><td>hst_10505_15_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4000859171115</td><td>53967.35622</td><td>ACS/WFC</td><td>F475W</td><td>21.522</td><td>0</td><td>hst_10505_16_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4001162870082</td><td>53967.48942</td><td>ACS/WFC</td><td>F475W</td><td>21.449</td><td>0</td><td>hst_10505_17_acs_wfc_f475w</td></tr>
<tr><td>80189155</td><td>4000926592856</td><td>53967.62263</td><td>ACS/WFC</td><td>F475W</td><td>21.769</td><td>0</td><td>hst_10505_18_acs_wfc_f475w</td></tr>
</table></div></div></div>
</div>
</section>
<section id="plot-the-light-curves">
<h3>Plot the light curves<a class="headerlink" href="#plot-the-light-curves" title="Link to this heading">#</a></h3>
<p>The light curves appear well-behaved and are closely correlated in the two filters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;StartMJD&#39;</span><span class="p">,</span> <span class="s1">&#39;MagAper2&#39;</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">f475</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS/WFC F475W&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;StartMJD&#39;</span><span class="p">,</span> <span class="s1">&#39;MagAper2&#39;</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">f814</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACS/WFC F814W&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD [days]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;[mag]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fa6bfd84090&gt;
</pre></div>
</div>
<img alt="../../../_images/f68fc0bed732dafc914d32450c981387ddad02308a25a02fd6627f0c6eed35bb.png" src="../../../_images/f68fc0bed732dafc914d32450c981387ddad02308a25a02fd6627f0c6eed35bb.png" />
</div>
</div>
</section>
<section id="extract-hla-cutout-images-for-the-f475w-images">
<h3>Extract HLA cutout images for the F475W images <a name="cutouts"></a><a class="headerlink" href="#extract-hla-cutout-images-for-the-f475w-images" title="Link to this heading">#</a></h3>
<p>Get HLA F475W cutout images for the example variable.  The <code class="docutils literal notranslate"><span class="pre">get_hla_cutout</span></code> function reads a single cutout image (as a JPEG grayscale image) and returns a PIL image object.  See the documentation on the <a class="reference external" href="http://hla.stsci.edu/fitscutcgi_interface.html">fitscut image cutout service</a> for more information on the web service being used.</p>
<p>Examination of the images can be useful to identified cosmic-ray contamination and other possible image artifacts.  In this case, no issues are seen, so the light curve is likely to be reliable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_hla_cutout</span><span class="p">(</span><span class="n">imagename</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="mf">99.5</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get JPEG cutout for an image&quot;&quot;&quot;</span>
    
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://hla.stsci.edu/cgi-bin/fitscut.cgi&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;jpeg&quot;</span><span class="p">,</span>
                                      <span class="n">red</span><span class="o">=</span><span class="n">imagename</span><span class="p">,</span> <span class="n">autoscale</span><span class="o">=</span><span class="n">autoscale</span><span class="p">,</span> <span class="n">asinh</span><span class="o">=</span><span class="n">asinh</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">))</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">im</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sort images by magnitude from faintest to brightest</span>
<span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">f475</span><span class="p">[</span><span class="s1">&#39;MagAper2&#39;</span><span class="p">])</span>

<span class="n">imagename</span> <span class="o">=</span> <span class="n">f475</span><span class="p">[</span><span class="s1">&#39;ImageName&#39;</span><span class="p">][</span><span class="n">isort</span><span class="p">]</span>
<span class="n">mag</span> <span class="o">=</span> <span class="n">f475</span><span class="p">[</span><span class="s1">&#39;MagAper2&#39;</span><span class="p">][</span><span class="n">isort</span><span class="p">]</span>
<span class="n">mjd</span> <span class="o">=</span> <span class="n">f475</span><span class="p">[</span><span class="s1">&#39;StartMJD&#39;</span><span class="p">][</span><span class="n">isort</span><span class="p">]</span>

<span class="n">nim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">imagename</span><span class="p">)</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># images per row</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">nim</span><span class="o">+</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">ncols</span>

<span class="n">imsize</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">mra</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchRA&#39;</span><span class="p">][</span><span class="n">iselect</span><span class="p">]</span>
<span class="n">mdec</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;MatchDec&#39;</span><span class="p">][</span><span class="n">iselect</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download list of images; might take a minute</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_hla_cutout</span><span class="p">(</span><span class="n">imagename</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">mra</span><span class="p">,</span> <span class="n">mdec</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">imsize</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nim</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="mi">15</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">images</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mjd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1"> f475w=</span><span class="si">{</span><span class="n">mag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e0d0251e3baa965d4aeb89ffb3275f053e5da7b3c5def137c18bce5f52c5e849.png" src="../../../_images/e0d0251e3baa965d4aeb89ffb3275f053e5da7b3c5def137c18bce5f52c5e849.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/HSC/HSCV3_API"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../HCV_API/HCV_API_demo.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Hubble Catalog of Variables Notebook (API version)</p>
      </div>
    </a>
    <a class="right-next"
       href="../HSCV3_SMC_API/hscv3_smc_api.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hubble Source Catalog API Notebook: SMC Color-Magnitude Diagram</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Hubble Source Catalog API Notebook</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rick-white-trenton-mckinney">2019 - 2022, Rick White, Trenton McKinney</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#instructions">Instructions:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization <a class="anchor" id="Initialization"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-python-modules">Install Python modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mast-api-functions">MAST API functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-metadata-on-available-columns">Get metadata on available columns <a name="metadata"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-variable-objects-in-the-dwarf-irregular-galaxy-ic-1613">Find variable objects in the dwarf irregular galaxy IC 1613 <a name="ic1613"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-astropy-name-resolver-to-get-position-of-ic-1613">Use <code class="docutils literal notranslate"><span class="pre">astropy</span></code> name resolver to get position of IC 1613 <a name="resolver"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-objects-with-enough-measurements-to-determine-variability">Select objects with enough measurements to determine variability <a name="summary"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-object-positions-on-the-sky">Plot object positions on the sky</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-mad-variability-index-versus-magnitude-in-f475w">Plot MAD variability index versus magnitude in F475W <a name="variability"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-positions-of-variable-objects-in-a-color-magnitude-diagram">Check positions of variable objects in a color-magnitude diagram <a name="cmd"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query-the-api-for-the-light-curve-for-one-of-the-objects">Query the API for the light curve for one of the objects <a name="lightcurve"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-separate-light-curves-for-f475w-and-f814w-from-the-detailed-table">Get separate light curves for F475W and F814W from the detailed table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-light-curves">Plot the light curves</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-hla-cutout-images-for-the-f475w-images">Extract HLA cutout images for the F475W images <a name="cutouts"></a></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>